{"version":3,"sources":["webpack:///./src/views/Home.vue?20bb","webpack:///./src/components/sub/SearchField.vue?aae2","webpack:///./src/components/Muuri.vue?953c","webpack:///./src/components/sub/SmallWidget.vue?ec7b","webpack:///./src/components/sub/Empty.vue?d579","webpack:///./src/components/WidgetSearch.vue?5a73","webpack:///./src/components/sub/WidgetError.vue?dd08","webpack:///./src/views/Home.vue?5833","webpack:///./src/components/Muuri.vue?7a6a","webpack:///./node_modules/muuri/dist/muuri.module.js","webpack:///./src/components/Widget.vue?e20c","webpack:///./src/components/sub/WidgetError.vue?9421","webpack:///src/components/sub/WidgetError.vue","webpack:///./src/components/sub/WidgetError.vue?7917","webpack:///./src/components/sub/WidgetError.vue","webpack:///src/components/Widget.vue","webpack:///./src/components/Widget.vue?4bd1","webpack:///./src/components/Widget.vue","webpack:///./src/components/sub/Empty.vue?2854","webpack:///src/components/sub/Empty.vue","webpack:///./src/components/sub/Empty.vue?62ad","webpack:///./src/components/sub/Empty.vue","webpack:///src/components/Muuri.vue","webpack:///./src/components/Muuri.vue?fe7f","webpack:///./src/components/Muuri.vue","webpack:///./src/components/WidgetSearch.vue?b25e","webpack:///./src/components/sub/TagLeiste.vue?0e08","webpack:///src/components/sub/TagLeiste.vue","webpack:///./src/components/sub/TagLeiste.vue?4d20","webpack:///./src/components/sub/TagLeiste.vue","webpack:///./src/components/sub/SearchField.vue?51ca","webpack:///src/components/sub/SearchField.vue","webpack:///./src/components/sub/SearchField.vue?ccca","webpack:///./src/components/sub/SearchField.vue","webpack:///./src/components/sub/SmallWidget.vue?a0b5","webpack:///src/components/sub/SmallWidget.vue","webpack:///./src/components/sub/SmallWidget.vue?a7d6","webpack:///./src/components/sub/SmallWidget.vue","webpack:///src/components/WidgetSearch.vue","webpack:///./src/components/WidgetSearch.vue?368e","webpack:///./src/components/WidgetSearch.vue","webpack:///src/views/Home.vue","webpack:///./src/views/Home.vue?493c","webpack:///./src/views/Home.vue","webpack:///./src/components/Widget.vue?8d55","webpack:///./src/components/sub/TagLeiste.vue?4bb7"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","_s","board","staticRenderFns","widgets","_l","widget","key","rsc_id","class","show2","on","refreshItems","_e","GRID_INSTANCES","ITEM_ELEMENT_MAP","Map","ACTION_SWAP","ACTION_MOVE","EVENT_SYNCHRONIZE","EVENT_LAYOUT_START","EVENT_LAYOUT_END","EVENT_LAYOUT_ABORT","EVENT_ADD","EVENT_REMOVE","EVENT_SHOW_START","EVENT_SHOW_END","EVENT_HIDE_START","EVENT_HIDE_END","EVENT_FILTER","EVENT_SORT","EVENT_MOVE","EVENT_SEND","EVENT_BEFORE_SEND","EVENT_RECEIVE","EVENT_BEFORE_RECEIVE","EVENT_DRAG_INIT","EVENT_DRAG_START","EVENT_DRAG_MOVE","EVENT_DRAG_SCROLL","EVENT_DRAG_END","EVENT_DRAG_RELEASE_START","EVENT_DRAG_RELEASE_END","EVENT_DESTROY","HAS_TOUCH_EVENTS","window","HAS_POINTER_EVENTS","PointerEvent","HAS_MS_POINTER_EVENTS","navigator","msPointerEnabled","MAX_SAFE_FLOAT32_INTEGER","Emitter","_events","_queue","_counter","_clearOnEmit","prototype","event","listener","listeners","push","off","index","length","indexOf","splice","clear","emit","args","queue","startIndex","argsLength","arguments","apply","shift","i","endIndex","burst","countListeners","destroy","pointerout","waitDuration","EdgeHack","dragger","_dragger","_timeout","_outEvent","_isActive","_addBehaviour","bind","_removeBehaviour","_onTimeout","_resetData","_onStart","_onOut","addEventListener","removeEventListener","clearTimeout","e","pointerType","_getTrackedTouch","setTimeout","isActive","_onCancel","vendorPrefixes","cache","getPrefixedPropName","style","prop","prefixedProp","camelProp","toUpperCase","slice","hasPassiveEvents","isPassiveEventsSupported","passiveOpts","Object","defineProperty","get","ua","userAgent","toLowerCase","isEdge","isIE","isFirefox","isAndroid","listenerOptions","passive","taProp","taPropPrefixed","document","documentElement","taDefaultValue","Dragger","element","cssProps","_element","_emitter","_isDestroyed","_cssProps","_touchAction","_pointerId","_startTime","_startX","_startY","_currentX","_currentY","_onMove","_onEnd","_edgeHack","setCssProps","setTouchAction","_preventDefault","_inputEvents","start","_pointerEvents","move","cancel","end","_msPointerEvents","_touchEvents","_mouseEvents","_emitterEvents","_activeInstances","preventDefault","cancelable","_activateInstance","instance","_bindListeners","_deactivateInstance","_unbindListeners","_getEventPointerId","pointerId","changedTouches","identifier","_getTouchById","id","_reset","_createEvent","type","touch","srcEvent","distance","getDistance","deltaX","getDeltaX","deltaY","getDeltaY","deltaTime","getDeltaTime","isFirst","isFinal","touches","screenX","screenY","clientX","clientY","pageX","pageY","target","_emit","Date","now","value","newProps","currentProps","x","y","Math","sqrt","eventName","dt","raf","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","callback","Ticker","numLanes","_nextStep","_lanes","_stepQueue","_stepCallbacks","_step","TickerLane","indices","callbacks","time","j","laneQueue","laneCallbacks","laneIndices","lanes","stepQueue","stepCallbacks","add","laneIndex","remove","undefined","LAYOUT_READ","LAYOUT_WRITE","VISIBILITY_READ","VISIBILITY_WRITE","DRAG_START_READ","DRAG_START_WRITE","DRAG_MOVE_READ","DRAG_MOVE_WRITE","DRAG_SCROLL_READ","DRAG_SCROLL_WRITE","DRAG_SORT_READ","PLACEHOLDER_LAYOUT_READ","PLACEHOLDER_LAYOUT_WRITE","PLACEHOLDER_RESIZE_WRITE","AUTO_SCROLL_READ","AUTO_SCROLL_WRITE","DEBOUNCE_READ","LANE_READ","LANE_READ_TAIL","LANE_WRITE","ticker","addLayoutTick","itemId","read","write","cancelLayoutTick","addVisibilityTick","cancelVisibilityTick","addDragStartTick","cancelDragStartTick","addDragMoveTick","cancelDragMoveTick","addDragScrollTick","cancelDragScrollTick","addDragSortTick","cancelDragSortTick","addPlaceholderLayoutTick","cancelPlaceholderLayoutTick","addPlaceholderResizeTick","cancelPlaceholderResizeTick","addAutoScrollTick","cancelAutoScrollTick","addDebounceTick","debounceId","cancelDebounceTick","AXIS_X","AXIS_Y","FORWARD","BACKWARD","LEFT","RIGHT","UP","DOWN","functionType","isFunction","val","cacheTimer","isWeakMapSupported","WeakMap","cache$1","cacheInterval","canClearCache","clearCache","clearInterval","getStyle","styles","getComputedStyle","set","setInterval","getPropertyValue","getStyleAsFloat","el","parseFloat","DOC_ELEM","BODY","body","THRESHOLD_DATA","offset","getScrollElement","getScrollLeft","pageXOffset","scrollLeft","getScrollTop","pageYOffset","scrollTop","getScrollLeftMax","scrollWidth","clientWidth","getScrollTopMax","scrollHeight","clientHeight","getContentRect","result","width","height","left","right","top","bottom","bcr","getBoundingClientRect","borderLeft","clientLeft","borderTop","clientTop","getItemAutoScrollSettings","item","_drag","_getGrid","_settings","dragAutoScroll","prepareItemScrollSync","_prepareScroll","applyItemScrollSync","drag","_scrollDiffX","_scrollDiffY","_setTranslate","_left","_top","computeThreshold","threshold","safeZone","itemSize","targetSize","min","max","ScrollRequest","reset","ScrollAction","requestX","requestY","Pool","createItem","releaseItem","pool","isOverlapping","a","b","getIntersectionArea","getIntersectionScore","area","maxArea","onStop","isEnding","direction","maxValue","speed","duration","action","hasReachedEnd","computeCurrentScrollValue","computeNextScrollValue","delta","nextValue","computeSpeed","data","tick","onStart","sort","addRequest","request","removeRequest","computeScrollValues","scroll","scrollTo","pick","pop","release","RECT_1","RECT_2","AutoScroller","_isTicking","_tickTime","_tickDeltaTime","_items","_actions","_requests","_requestOverlapCheck","_dragPositions","_dragDirections","_overlapCheckInterval","_requestPool","_actionPool","_readTick","_writeTick","smoothSpeed","maxSpeed","acceleration","deceleration","targetSpeed","factor","currentSpeed","nextSpeed","pointerHandle","pointerSize","rect","size","w","h","pX","pY","_updateRequests","_updateActions","_applyActions","_startTicking","_stopTicking","_getItemHandleRect","handle","itemDrag","ev","_dragMoveEvent","_dragStartEvent","_clientX","_clientY","_width","_height","_requestItemScroll","axis","reqMap","_id","_cancelItemScroll","_checkItemOverlap","checkX","checkY","settings","targets","dragDirections","dragDirectionX","dragDirectionY","itemRect","testRect","testElement","testAxisX","testAxisY","testScore","testPriority","testThreshold","testDirection","testDistance","testMaxScrollX","testMaxScrollY","xElement","xPriority","Infinity","xThreshold","xScore","xDirection","xDistance","xMaxScroll","yElement","yPriority","yThreshold","yScore","yDirection","yDistance","yMaxScroll","priority","_updateScrollRequest","scrollRequest","targetCount","testIsAxisX","testScroll","testMaxScroll","smoothStop","reqX","reqY","checkTime","needsCheck","items","requestsX","requestsY","_requestAction","actions","isAxisX","requests","_updateDragDirection","dragPositions","x1","y1","x2","y2","addItem","updateItem","removeItem","isItemScrollingX","isItemScrollingY","isItemScrolling","ElProto","Element","matchesFn","matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","elementMatches","selector","call","addClass","className","classList","tempArray","numberType","arrayInsert","array","concat","normalizeArrayIndex","sizeOffset","maxIndex","arrayMove","fromIndex","toIndex","from","to","arraySwap","withIndex","temp","indexA","indexB","transformProp","styleNameRegEx","prefixRegex","msPrefixRegex","getStyleName","property","styleName","replace","transformStyle","transformNone","displayInline","displayNone","displayStyle","isTransformed","transform","display","getContainingBlock","doc","res","parentElement","offsetA","offsetB","offsetDiff","getOffset","offsetData","self","getOffsetDiff","elemA","elemB","compareContainingBlocks","isScrollableOverflow","isScrollable","getScrollableAncestors","getRootNode","DocumentFragment","host","parentNode","translateValue","transformNone$1","rxMat3d","rxMatTx","rxMat3dTx","rxNextItem","getTranslate","isMat3d","test","tX","tY","removeClass","trim","IS_IOS","platform","maxTouchPoints","START_PREDICATE_INACTIVE","START_PREDICATE_PENDING","START_PREDICATE_RESOLVED","SCROLL_LISTENER_OPTIONS","ItemDrag","grid","getGrid","_item","_gridId","_isMigrating","_startPredicate","dragStartPredicate","defaultStartPredicate","_startPredicateState","_startPredicateResult","_isSortNeeded","_sortTimer","_blockedSortIndex","_sortX1","_sortX2","_sortY1","_sortY2","_preStartCheck","_preEndCheck","_onScroll","_prepareStart","_applyStart","_prepareMove","_applyMove","_applyScroll","_handleSort","_handleSortDelayed","_handle","dragHandle","querySelector","dragCssProps","openAnchorHref","tagName","href","getAttribute","open","location","getCurrentStyles","Array","isArray","autoScroller","options","button","isTrusted","defaultPrevented","predicate","_startPredicateData","config","delay","delayTimer","_resolveStartPredicate","_forceResolveStartPredicate","_resetStartPredicate","_finishStartPredicate","defaultSortPredicate","targetRect","returnData","gridsArray","minThreshold","maxThreshold","getTargetGrid","rootGrid","gridScore","grids","container","containerRect","dragSort","bestScore","_updateBoundingRect","innerWidth","_right","innerHeight","_bottom","sortThreshold","sortAction","migrateAction","score","isMigration","gridOffsetLeft","gridOffsetTop","matchScore","matchIndex","hasValidTargets","_gridX","_marginLeft","_gridY","_marginTop","_updateBorders","_borderLeft","_borderTop","stop","_finishMigration","_cancelSort","_isStarted","_unbindScrollListeners","draggingClass","itemDraggingClass","appendChild","force","_container","_containingBlock","_dragPrevMoveEvent","_scrollEvent","_scrollers","_moveDiffX","_moveDiffY","_containerDiffX","_containerDiffY","_bindScrollListeners","gridScrollers","gridContainer","dragContainer","scrollers","isClick","abs","_resetHeuristics","_checkHeuristics","dragSortHeuristics","minDist","minDragDistance","diffX","diffY","canCheckBounceBack","minBounceBackAngle","angle","atan2","prevAngle","deltaAngle","sin","cos","sortDuringScroll","shouldSort","sortInterval","_checkOverlap","_finishSort","isSortEnabled","needsFinalCheck","currentGrid","currentIndex","targetGrid","targetIndex","targetItem","dragSortPredicate","_hasListeners","fromGrid","toGrid","_sortData","send","appendTo","layoutSender","layoutReceiver","layout","translate","_dragRelease","targetGridElement","targetSettings","targetContainer","currentSettings","currentContainer","currentVisClass","itemVisibleClass","itemHiddenClass","nextVisClass","itemClass","_refreshDimensions","dragEnabled","_visibility","setStyles","visibleStyles","hiddenStyles","isResolved","containingBlock","elementRect","hasDragContainer","migrate","_migrate","isPositioning","_layout","isReleasing","dragPlaceholder","enabled","_dragPlaceholder","create","dragAxis","nextEvent","prevEvent","moveDiffX","moveDiffY","moveX","moveY","scrollDiffX","scrollDiffY","unprefixRegEx","cache$2","getUnprefixedPropName","nativeCode","isNative","feat","S","Symbol","toString","HAS_WEB_ANIMATIONS","animate","HAS_NATIVE_WEB_ANIMATIONS","Animator","_animation","_duration","_easing","_callback","_props","_values","_onFinish","createFrame","props","prefix","frame","getTranslateString","ItemDragPlaceholder","_className","_didMigrate","_resetAfterLayout","_transX","_transY","_nextTransX","_nextTransY","_setupAnimation","_startAnimation","_updateDimensions","_onLayoutStart","_onLayoutEnd","_onReleaseEnd","_onMigrate","_onHide","ItemDragRelease","_isPositioningStarted","propsFrom","propsTo","opts","onFinish","propName","propCount","propIndex","animation","currentValues","easing","cancelAnimation","onfinish","isAnimating","isInstant","nextLeft","nextTop","currentLeft","currentTop","nextX","nextY","animEnabled","layoutDuration","getElement","currentX","currentY","currentStyles","targetStyles","layoutEasing","nextGrid","createElement","itemPlaceholderClass","position","onCreate","removeChild","onRemove","updateDimensions","itemReleasingClass","dragRelease","useDragContainer","_placeToGrid","_nextLayoutData","abort","didReparent","isJustReleased","needsReflow","releasingClass","MIN_ANIMATION_DISTANCE","ItemLayout","elementStyle","_isInterrupted","_currentStyles","_targetStyles","_nextLeft","_nextTop","_offsetLeft","_offsetTop","_skipNextAnimation","_animOptions","_finish","ItemMigrate","ItemVisibility","childElement","children","Error","_isHidden","_isHiding","_isShowing","_childElement","_currentStyleProps","_finishShow","_finishHide","instant","gridSettings","animDuration","animEasing","_updateOffsets","processCallbackQueue","itemPositioningClass","_tX","_tY","xDiff","yDiff","containerDiff","translateX","translateY","isVisible","targetElement","targetItems","getItem","gridElement","show","hide","currentStyleProps","_removeCurrentStyles","toVisible","showDuration","hideDuration","showEasing","hideEasing","createUid","Item","has","_marginRight","_marginBottom","createPackerProcessor","isWorker","FILL_GAPS","HORIZONTAL","ALIGN_RIGHT","ALIGN_BOTTOM","ROUNDING","EPS","MIN_SLOT_SIZE","roundNumber","number","PackerProcessor","currentRects","nextRects","rectTarget","rectStore","slotSizes","rectId","slotIndex","slotData","sortRectsLeftTop","sortRectsTopLeft","computeLayout","bump","slotWidth","slotHeight","slot","slots","fillGaps","horizontal","alignRight","alignBottom","rounding","isPreProcessed","computeNextSlot","shards","ignoreCurrentRects","getRect","addRect","splitRect","purgeRects","hole","isRectAWithinRectB","rectA","rectB","rectIds","aId","bId","PACKET_INDEX_WIDTH","PACKET_INDEX_HEIGHT","PACKET_INDEX_OPTIONS","PACKET_HEADER_SLOTS","processor","onmessage","msg","Float32Array","subarray","postMessage","buffer","getWidth","getHeight","getMargin","getPosition","isShowing","isHiding","isDragging","isDestroyed","_refreshSortData","getters","sortData","_addToLayout","_removeFromLayout","_canSkipLayout","_destroy","removeElement","delete","blobUrl","activeWorkers","createWorkerProcessors","amount","workers","URL","createObjectURL","Blob","worker","Worker","destroyWorkerProcessors","onerror","onmessageerror","terminate","revokeObjectURL","isWorkerProcessorsSupported","PACKET_INDEX_ID","Packer","numWorkers","_options","_processor","_layoutQueue","_layouts","_layoutCallbacks","_layoutWorkers","_layoutWorkerData","_workers","_onWorkerMessage","setOptions","_sendToWorker","layoutId","_finalizeLayout","_grid","isHorizontal","isBorderBox","_boxSizing","_borderRight","_borderBottom","createLayout","cancelLayout","queueIndex","debounce","fn","durationMs","timer","lastTime","isCanceled","htmlCollectionType","nodeListType","isNodeList","objectType","objectToStringType","isPlainObject","noop","toArray","NUMBER_TYPE","STRING_TYPE","INSTANT_LAYOUT","Grid","isElementInDom","composed","contains","mergeSettings","defaultOptions","normalizeStyles","_isLayoutFinished","_onLayoutDataReceived","containerClass","bindLayoutOnResize","layoutOnResize","getInitialGridElements","layoutOnInit","defaultSettings","userSettings","mergeObjects","source","isSourceObject","sourceKeys","keys","elements","_resizeHandler","unbindLayoutOnResize","normalized","docElemStyle","createIndexMap","compareIndexMap","indexMap","itemA","itemB","defaultPacker","opacity","touchAction","userSelect","userDrag","tapHighlightColor","touchCallout","contentZooming","getItems","hiddenItemStyles","visibility","refreshSortData","synchronize","fragment","createDocumentFragment","unfinishedLayout","nextLayoutId","layoutItems","gridWidth","gridHeight","layoutSettings","newItems","needsLayout","active","allItems","removeElements","_setItemsVisibility","filter","itemsToShow","itemsToHide","isPredicateString","isPredicateFn","syncWithLayout","tryFinishCounter","tryFinish","sortComparer","isDescending","origItems","defaultComparer","criteriaName","criteriaOrder","valA","valB","customComparer","comparer","descending","split","map","isSwap","fromItem","toItem","layoutStyles","itemsToLayout","numItems","counter","hasLayoutChanged","startEvent","endEvent","method","completedItems","hiddenItems","triggerVisibilityChange","interrupted","error","loading","directives","name","rawName","expression","src","onLoad","icon","title","subtitle","domProps","desc","fixMissingWidget","scopedSlots","_u","ref","_g","_b","onHelpClick","staticStyle","required","components","component","baseWidth","baseHeight","margin","inject","onMessage","methods","iframeEl","$el","contentWindow","payload","$store","dispatch","removeFromBoard","endpoint","params","$router","enter_url","WidgetError","VBoilerplate","functional","boilerplate","elevation","default","showHandle","Boolean","watch","one","values","newValue","join","two","oldValue","$nextTick","$emit","computed","dark","URLSearchParams","$vuetify","theme","themes","light","description_html","Number","Widget","Empty","showGrid","internalWidgets","ti3","setupGrid","ti","ti2","async","oldIndex","dragSortInterval","newSort","dataset","newIndex","sortBoard","model","$$v","dialogOpen","$event","selectedTags","onTagSelection","onUserSearch","$index","onChange","searchWidgets","total","deltaWidgets","selected","innerSelected1","tag","innerSelected2Le","innerSelected2","t","observedTags","console","log","t2","is","tmp2","tmp","defaultTags","tags","_k","keyCode","submit","esc","text","searchActive","$refs","searchRef","focus","disabled","oldAdded","newAdded","onClick","widgetDesc","addedToCurrentBoard","added","isNew","onNewAddedChange","find","description","defParams","search","page","per_page","TagLeiste","SearchField","InfiniteLoading","SmallWidget","assign","il","stateChanger","loaded","complete","ret","api","total_count","$state","err","fetchTags","updateBoard","store","next","vm","clearWidgets","Muuri","WidgetSearch"],"mappings":"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","file":"js/home.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=style&index=0&id=e493482e&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchField.vue?vue&type=style&index=0&id=619e3a78&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Muuri.vue?vue&type=style&index=0&id=5d87b705&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallWidget.vue?vue&type=style&index=0&id=1c5dcfc5&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Empty.vue?vue&type=style&index=0&id=3a49a231&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WidgetSearch.vue?vue&type=style&index=0&id=71cfad90&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WidgetError.vue?vue&type=style&index=0&id=60e42f00&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"pa-0\",attrs:{\"id\":\"board\",\"fluid\":\"\"}},[_c('v-row',{attrs:{\"no-gutters\":\"\",\"align\":\"center\"}},[_c('h1',{staticClass:\"text-h2 mb-4 ml-3\"},[_vm._v(_vm._s(_vm.board))]),_c('v-spacer'),_c('widget-search')],1),_c('v-row',{attrs:{\"no-gutters\":\"\",\"align\":\"center\"}}),_c('Muuri')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"grid\"},[(_vm.widgets === [])?[_c('empty')]:(_vm.show)?_vm._l((_vm.widgets),function(widget){return _c('widget',{key:widget.rsc_id,class:{show2: _vm.show2},attrs:{\"xxxshow-handle\":\"showHandle\",\"data-id\":widget.rsc_id,\"widget\":widget},on:{\"refresh\":_vm.refreshItems}})}):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n* Muuri v0.9.2\n* https://muuri.dev/\n* Copyright (c) 2015-present, Haltu Oy\n* Released under the MIT license\n* https://github.com/haltu/muuri/blob/master/LICENSE.md\n* @license MIT\n*\n* Muuri Packer\n* Copyright (c) 2016-present, Niklas Rm <inramo@gmail.com>\n* @license MIT\n*\n* Muuri Ticker / Muuri Emitter / Muuri Dragger\n* Copyright (c) 2018-present, Niklas Rm <inramo@gmail.com>\n* @license MIT\n*\n* Muuri AutoScroller\n* Copyright (c) 2019-present, Niklas Rm <inramo@gmail.com>\n* @license MIT\n*/\n\nvar GRID_INSTANCES = {};\nvar ITEM_ELEMENT_MAP = typeof Map === 'function' ? new Map() : null;\n\nvar ACTION_SWAP = 'swap';\nvar ACTION_MOVE = 'move';\n\nvar EVENT_SYNCHRONIZE = 'synchronize';\nvar EVENT_LAYOUT_START = 'layoutStart';\nvar EVENT_LAYOUT_END = 'layoutEnd';\nvar EVENT_LAYOUT_ABORT = 'layoutAbort';\nvar EVENT_ADD = 'add';\nvar EVENT_REMOVE = 'remove';\nvar EVENT_SHOW_START = 'showStart';\nvar EVENT_SHOW_END = 'showEnd';\nvar EVENT_HIDE_START = 'hideStart';\nvar EVENT_HIDE_END = 'hideEnd';\nvar EVENT_FILTER = 'filter';\nvar EVENT_SORT = 'sort';\nvar EVENT_MOVE = 'move';\nvar EVENT_SEND = 'send';\nvar EVENT_BEFORE_SEND = 'beforeSend';\nvar EVENT_RECEIVE = 'receive';\nvar EVENT_BEFORE_RECEIVE = 'beforeReceive';\nvar EVENT_DRAG_INIT = 'dragInit';\nvar EVENT_DRAG_START = 'dragStart';\nvar EVENT_DRAG_MOVE = 'dragMove';\nvar EVENT_DRAG_SCROLL = 'dragScroll';\nvar EVENT_DRAG_END = 'dragEnd';\nvar EVENT_DRAG_RELEASE_START = 'dragReleaseStart';\nvar EVENT_DRAG_RELEASE_END = 'dragReleaseEnd';\nvar EVENT_DESTROY = 'destroy';\n\nvar HAS_TOUCH_EVENTS = 'ontouchstart' in window;\nvar HAS_POINTER_EVENTS = !!window.PointerEvent;\nvar HAS_MS_POINTER_EVENTS = !!window.navigator.msPointerEnabled;\n\nvar MAX_SAFE_FLOAT32_INTEGER = 16777216;\n\n/**\n * Event emitter constructor.\n *\n * @class\n */\nfunction Emitter() {\n  this._events = {};\n  this._queue = [];\n  this._counter = 0;\n  this._clearOnEmit = false;\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Bind an event listener.\n *\n * @public\n * @param {String} event\n * @param {Function} listener\n * @returns {Emitter}\n */\nEmitter.prototype.on = function (event, listener) {\n  if (!this._events || !event || !listener) return this;\n\n  // Get listeners queue and create it if it does not exist.\n  var listeners = this._events[event];\n  if (!listeners) listeners = this._events[event] = [];\n\n  // Add the listener to the queue.\n  listeners.push(listener);\n\n  return this;\n};\n\n/**\n * Unbind all event listeners that match the provided listener function.\n *\n * @public\n * @param {String} event\n * @param {Function} listener\n * @returns {Emitter}\n */\nEmitter.prototype.off = function (event, listener) {\n  if (!this._events || !event || !listener) return this;\n\n  // Get listeners and return immediately if none is found.\n  var listeners = this._events[event];\n  if (!listeners || !listeners.length) return this;\n\n  // Remove all matching listeners.\n  var index;\n  while ((index = listeners.indexOf(listener)) !== -1) {\n    listeners.splice(index, 1);\n  }\n\n  return this;\n};\n\n/**\n * Unbind all listeners of the provided event.\n *\n * @public\n * @param {String} event\n * @returns {Emitter}\n */\nEmitter.prototype.clear = function (event) {\n  if (!this._events || !event) return this;\n\n  var listeners = this._events[event];\n  if (listeners) {\n    listeners.length = 0;\n    delete this._events[event];\n  }\n\n  return this;\n};\n\n/**\n * Emit all listeners in a specified event with the provided arguments.\n *\n * @public\n * @param {String} event\n * @param {...*} [args]\n * @returns {Emitter}\n */\nEmitter.prototype.emit = function (event) {\n  if (!this._events || !event) {\n    this._clearOnEmit = false;\n    return this;\n  }\n\n  // Get event listeners and quit early if there's no listeners.\n  var listeners = this._events[event];\n  if (!listeners || !listeners.length) {\n    this._clearOnEmit = false;\n    return this;\n  }\n\n  var queue = this._queue;\n  var startIndex = queue.length;\n  var argsLength = arguments.length - 1;\n  var args;\n\n  // If we have more than 3 arguments let's put the arguments in an array and\n  // apply it to the listeners.\n  if (argsLength > 3) {\n    args = [];\n    args.push.apply(args, arguments);\n    args.shift();\n  }\n\n  // Add the current listeners to the callback queue before we process them.\n  // This is necessary to guarantee that all of the listeners are called in\n  // correct order even if new event listeners are removed/added during\n  // processing and/or events are emitted during processing.\n  queue.push.apply(queue, listeners);\n\n  // Reset the event's listeners if need be.\n  if (this._clearOnEmit) {\n    listeners.length = 0;\n    this._clearOnEmit = false;\n  }\n\n  // Increment queue counter. This is needed for the scenarios where emit is\n  // triggered while the queue is already processing. We need to keep track of\n  // how many \"queue processors\" there are active so that we can safely reset\n  // the queue in the end when the last queue processor is finished.\n  ++this._counter;\n\n  // Process the queue (the specific part of it for this emit).\n  var i = startIndex;\n  var endIndex = queue.length;\n  for (; i < endIndex; i++) {\n    // prettier-ignore\n    argsLength === 0 ? queue[i]() :\n    argsLength === 1 ? queue[i](arguments[1]) :\n    argsLength === 2 ? queue[i](arguments[1], arguments[2]) :\n    argsLength === 3 ? queue[i](arguments[1], arguments[2], arguments[3]) :\n                       queue[i].apply(null, args);\n\n    // Stop processing if the emitter is destroyed.\n    if (!this._events) return this;\n  }\n\n  // Decrement queue process counter.\n  --this._counter;\n\n  // Reset the queue if there are no more queue processes running.\n  if (!this._counter) queue.length = 0;\n\n  return this;\n};\n\n/**\n * Emit all listeners in a specified event with the provided arguments and\n * remove the event's listeners just before calling the them. This method allows\n * the emitter to serve as a queue where all listeners are called only once.\n *\n * @public\n * @param {String} event\n * @param {...*} [args]\n * @returns {Emitter}\n */\nEmitter.prototype.burst = function () {\n  if (!this._events) return this;\n  this._clearOnEmit = true;\n  this.emit.apply(this, arguments);\n  return this;\n};\n\n/**\n * Check how many listeners there are for a specific event.\n *\n * @public\n * @param {String} event\n * @returns {Boolean}\n */\nEmitter.prototype.countListeners = function (event) {\n  if (!this._events) return 0;\n  var listeners = this._events[event];\n  return listeners ? listeners.length : 0;\n};\n\n/**\n * Destroy emitter instance. Basically just removes all bound listeners.\n *\n * @public\n * @returns {Emitter}\n */\nEmitter.prototype.destroy = function () {\n  if (!this._events) return this;\n  this._queue.length = this._counter = 0;\n  this._events = null;\n  return this;\n};\n\nvar pointerout = HAS_POINTER_EVENTS ? 'pointerout' : HAS_MS_POINTER_EVENTS ? 'MSPointerOut' : '';\nvar waitDuration = 100;\n\n/**\n * If you happen to use Edge or IE on a touch capable device there is a\n * a specific case where pointercancel and pointerend events are never emitted,\n * even though one them should always be emitted when you release your finger\n * from the screen. The bug appears specifically when Muuri shifts the dragged\n * element's position in the DOM after pointerdown event, IE and Edge don't like\n * that behaviour and quite often forget to emit the pointerend/pointercancel\n * event. But, they do emit pointerout event so we utilize that here.\n * Specifically, if there has been no pointermove event within 100 milliseconds\n * since the last pointerout event we force cancel the drag operation. This hack\n * works surprisingly well 99% of the time. There is that 1% chance there still\n * that dragged items get stuck but it is what it is.\n *\n * @class\n * @param {Dragger} dragger\n */\nfunction EdgeHack(dragger) {\n  if (!pointerout) return;\n\n  this._dragger = dragger;\n  this._timeout = null;\n  this._outEvent = null;\n  this._isActive = false;\n\n  this._addBehaviour = this._addBehaviour.bind(this);\n  this._removeBehaviour = this._removeBehaviour.bind(this);\n  this._onTimeout = this._onTimeout.bind(this);\n  this._resetData = this._resetData.bind(this);\n  this._onStart = this._onStart.bind(this);\n  this._onOut = this._onOut.bind(this);\n\n  this._dragger.on('start', this._onStart);\n}\n\n/**\n * @private\n */\nEdgeHack.prototype._addBehaviour = function () {\n  if (this._isActive) return;\n  this._isActive = true;\n  this._dragger.on('move', this._resetData);\n  this._dragger.on('cancel', this._removeBehaviour);\n  this._dragger.on('end', this._removeBehaviour);\n  window.addEventListener(pointerout, this._onOut);\n};\n\n/**\n * @private\n */\nEdgeHack.prototype._removeBehaviour = function () {\n  if (!this._isActive) return;\n  this._dragger.off('move', this._resetData);\n  this._dragger.off('cancel', this._removeBehaviour);\n  this._dragger.off('end', this._removeBehaviour);\n  window.removeEventListener(pointerout, this._onOut);\n  this._resetData();\n  this._isActive = false;\n};\n\n/**\n * @private\n */\nEdgeHack.prototype._resetData = function () {\n  window.clearTimeout(this._timeout);\n  this._timeout = null;\n  this._outEvent = null;\n};\n\n/**\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nEdgeHack.prototype._onStart = function (e) {\n  if (e.pointerType === 'mouse') return;\n  this._addBehaviour();\n};\n\n/**\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nEdgeHack.prototype._onOut = function (e) {\n  if (!this._dragger._getTrackedTouch(e)) return;\n  this._resetData();\n  this._outEvent = e;\n  this._timeout = window.setTimeout(this._onTimeout, waitDuration);\n};\n\n/**\n * @private\n */\nEdgeHack.prototype._onTimeout = function () {\n  var e = this._outEvent;\n  this._resetData();\n  if (this._dragger.isActive()) this._dragger._onCancel(e);\n};\n\n/**\n * @public\n */\nEdgeHack.prototype.destroy = function () {\n  if (!pointerout) return;\n  this._dragger.off('start', this._onStart);\n  this._removeBehaviour();\n};\n\n// Playing it safe here, test all potential prefixes capitalized and lowercase.\nvar vendorPrefixes = ['', 'webkit', 'moz', 'ms', 'o', 'Webkit', 'Moz', 'MS', 'O'];\nvar cache = {};\n\n/**\n * Get prefixed CSS property name when given a non-prefixed CSS property name.\n * Returns null if the property is not supported at all.\n *\n * @param {CSSStyleDeclaration} style\n * @param {String} prop\n * @returns {String}\n */\nfunction getPrefixedPropName(style, prop) {\n  var prefixedProp = cache[prop] || '';\n  if (prefixedProp) return prefixedProp;\n\n  var camelProp = prop[0].toUpperCase() + prop.slice(1);\n  var i = 0;\n  while (i < vendorPrefixes.length) {\n    prefixedProp = vendorPrefixes[i] ? vendorPrefixes[i] + camelProp : prop;\n    if (prefixedProp in style) {\n      cache[prop] = prefixedProp;\n      return prefixedProp;\n    }\n    ++i;\n  }\n\n  return '';\n}\n\n/**\n * Check if passive events are supported.\n * https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md#feature-detection\n *\n * @returns {Boolean}\n */\nfunction hasPassiveEvents() {\n  var isPassiveEventsSupported = false;\n\n  try {\n    var passiveOpts = Object.defineProperty({}, 'passive', {\n      get: function () {\n        isPassiveEventsSupported = true;\n      },\n    });\n    window.addEventListener('testPassive', null, passiveOpts);\n    window.removeEventListener('testPassive', null, passiveOpts);\n  } catch (e) {}\n\n  return isPassiveEventsSupported;\n}\n\nvar ua = window.navigator.userAgent.toLowerCase();\nvar isEdge = ua.indexOf('edge') > -1;\nvar isIE = ua.indexOf('trident') > -1;\nvar isFirefox = ua.indexOf('firefox') > -1;\nvar isAndroid = ua.indexOf('android') > -1;\n\nvar listenerOptions = hasPassiveEvents() ? { passive: true } : false;\n\nvar taProp = 'touchAction';\nvar taPropPrefixed = getPrefixedPropName(document.documentElement.style, taProp);\nvar taDefaultValue = 'auto';\n\n/**\n * Creates a new Dragger instance for an element.\n *\n * @public\n * @class\n * @param {HTMLElement} element\n * @param {Object} [cssProps]\n */\nfunction Dragger(element, cssProps) {\n  this._element = element;\n  this._emitter = new Emitter();\n  this._isDestroyed = false;\n  this._cssProps = {};\n  this._touchAction = '';\n  this._isActive = false;\n\n  this._pointerId = null;\n  this._startTime = 0;\n  this._startX = 0;\n  this._startY = 0;\n  this._currentX = 0;\n  this._currentY = 0;\n\n  this._onStart = this._onStart.bind(this);\n  this._onMove = this._onMove.bind(this);\n  this._onCancel = this._onCancel.bind(this);\n  this._onEnd = this._onEnd.bind(this);\n\n  // Can't believe had to build a freaking class for a hack!\n  this._edgeHack = null;\n  if ((isEdge || isIE) && (HAS_POINTER_EVENTS || HAS_MS_POINTER_EVENTS)) {\n    this._edgeHack = new EdgeHack(this);\n  }\n\n  // Apply initial CSS props.\n  this.setCssProps(cssProps);\n\n  // If touch action was not provided with initial CSS props let's assume it's\n  // auto.\n  if (!this._touchAction) {\n    this.setTouchAction(taDefaultValue);\n  }\n\n  // Prevent native link/image dragging for the item and it's children.\n  element.addEventListener('dragstart', Dragger._preventDefault, false);\n\n  // Listen to start event.\n  element.addEventListener(Dragger._inputEvents.start, this._onStart, listenerOptions);\n}\n\n/**\n * Protected properties\n * ********************\n */\n\nDragger._pointerEvents = {\n  start: 'pointerdown',\n  move: 'pointermove',\n  cancel: 'pointercancel',\n  end: 'pointerup',\n};\n\nDragger._msPointerEvents = {\n  start: 'MSPointerDown',\n  move: 'MSPointerMove',\n  cancel: 'MSPointerCancel',\n  end: 'MSPointerUp',\n};\n\nDragger._touchEvents = {\n  start: 'touchstart',\n  move: 'touchmove',\n  cancel: 'touchcancel',\n  end: 'touchend',\n};\n\nDragger._mouseEvents = {\n  start: 'mousedown',\n  move: 'mousemove',\n  cancel: '',\n  end: 'mouseup',\n};\n\nDragger._inputEvents = (function () {\n  if (HAS_TOUCH_EVENTS) return Dragger._touchEvents;\n  if (HAS_POINTER_EVENTS) return Dragger._pointerEvents;\n  if (HAS_MS_POINTER_EVENTS) return Dragger._msPointerEvents;\n  return Dragger._mouseEvents;\n})();\n\nDragger._emitter = new Emitter();\n\nDragger._emitterEvents = {\n  start: 'start',\n  move: 'move',\n  end: 'end',\n  cancel: 'cancel',\n};\n\nDragger._activeInstances = [];\n\n/**\n * Protected static methods\n * ************************\n */\n\nDragger._preventDefault = function (e) {\n  if (e.preventDefault && e.cancelable !== false) e.preventDefault();\n};\n\nDragger._activateInstance = function (instance) {\n  var index = Dragger._activeInstances.indexOf(instance);\n  if (index > -1) return;\n\n  Dragger._activeInstances.push(instance);\n  Dragger._emitter.on(Dragger._emitterEvents.move, instance._onMove);\n  Dragger._emitter.on(Dragger._emitterEvents.cancel, instance._onCancel);\n  Dragger._emitter.on(Dragger._emitterEvents.end, instance._onEnd);\n\n  if (Dragger._activeInstances.length === 1) {\n    Dragger._bindListeners();\n  }\n};\n\nDragger._deactivateInstance = function (instance) {\n  var index = Dragger._activeInstances.indexOf(instance);\n  if (index === -1) return;\n\n  Dragger._activeInstances.splice(index, 1);\n  Dragger._emitter.off(Dragger._emitterEvents.move, instance._onMove);\n  Dragger._emitter.off(Dragger._emitterEvents.cancel, instance._onCancel);\n  Dragger._emitter.off(Dragger._emitterEvents.end, instance._onEnd);\n\n  if (!Dragger._activeInstances.length) {\n    Dragger._unbindListeners();\n  }\n};\n\nDragger._bindListeners = function () {\n  window.addEventListener(Dragger._inputEvents.move, Dragger._onMove, listenerOptions);\n  window.addEventListener(Dragger._inputEvents.end, Dragger._onEnd, listenerOptions);\n  if (Dragger._inputEvents.cancel) {\n    window.addEventListener(Dragger._inputEvents.cancel, Dragger._onCancel, listenerOptions);\n  }\n};\n\nDragger._unbindListeners = function () {\n  window.removeEventListener(Dragger._inputEvents.move, Dragger._onMove, listenerOptions);\n  window.removeEventListener(Dragger._inputEvents.end, Dragger._onEnd, listenerOptions);\n  if (Dragger._inputEvents.cancel) {\n    window.removeEventListener(Dragger._inputEvents.cancel, Dragger._onCancel, listenerOptions);\n  }\n};\n\nDragger._getEventPointerId = function (event) {\n  // If we have pointer id available let's use it.\n  if (typeof event.pointerId === 'number') {\n    return event.pointerId;\n  }\n\n  // For touch events let's get the first changed touch's identifier.\n  if (event.changedTouches) {\n    return event.changedTouches[0] ? event.changedTouches[0].identifier : null;\n  }\n\n  // For mouse/other events let's provide a static id.\n  return 1;\n};\n\nDragger._getTouchById = function (event, id) {\n  // If we have a pointer event return the whole event if there's a match, and\n  // null otherwise.\n  if (typeof event.pointerId === 'number') {\n    return event.pointerId === id ? event : null;\n  }\n\n  // For touch events let's check if there's a changed touch object that matches\n  // the pointerId in which case return the touch object.\n  if (event.changedTouches) {\n    for (var i = 0; i < event.changedTouches.length; i++) {\n      if (event.changedTouches[i].identifier === id) {\n        return event.changedTouches[i];\n      }\n    }\n    return null;\n  }\n\n  // For mouse/other events let's assume there's only one pointer and just\n  // return the event.\n  return event;\n};\n\nDragger._onMove = function (e) {\n  Dragger._emitter.emit(Dragger._emitterEvents.move, e);\n};\n\nDragger._onCancel = function (e) {\n  Dragger._emitter.emit(Dragger._emitterEvents.cancel, e);\n};\n\nDragger._onEnd = function (e) {\n  Dragger._emitter.emit(Dragger._emitterEvents.end, e);\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Reset current drag operation (if any).\n *\n * @private\n */\nDragger.prototype._reset = function () {\n  this._pointerId = null;\n  this._startTime = 0;\n  this._startX = 0;\n  this._startY = 0;\n  this._currentX = 0;\n  this._currentY = 0;\n  this._isActive = false;\n  Dragger._deactivateInstance(this);\n};\n\n/**\n * Create a custom dragger event from a raw event.\n *\n * @private\n * @param {String} type\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n * @returns {Object}\n */\nDragger.prototype._createEvent = function (type, e) {\n  var touch = this._getTrackedTouch(e);\n  return {\n    // Hammer.js compatibility interface.\n    type: type,\n    srcEvent: e,\n    distance: this.getDistance(),\n    deltaX: this.getDeltaX(),\n    deltaY: this.getDeltaY(),\n    deltaTime: type === Dragger._emitterEvents.start ? 0 : this.getDeltaTime(),\n    isFirst: type === Dragger._emitterEvents.start,\n    isFinal: type === Dragger._emitterEvents.end || type === Dragger._emitterEvents.cancel,\n    pointerType: e.pointerType || (e.touches ? 'touch' : 'mouse'),\n    // Partial Touch API interface.\n    identifier: this._pointerId,\n    screenX: touch.screenX,\n    screenY: touch.screenY,\n    clientX: touch.clientX,\n    clientY: touch.clientY,\n    pageX: touch.pageX,\n    pageY: touch.pageY,\n    target: touch.target,\n  };\n};\n\n/**\n * Emit a raw event as dragger event internally.\n *\n * @private\n * @param {String} type\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nDragger.prototype._emit = function (type, e) {\n  this._emitter.emit(type, this._createEvent(type, e));\n};\n\n/**\n * If the provided event is a PointerEvent this method will return it if it has\n * the same pointerId as the instance. If the provided event is a TouchEvent\n * this method will try to look for a Touch instance in the changedTouches that\n * has an identifier matching this instance's pointerId. If the provided event\n * is a MouseEvent (or just any other event than PointerEvent or TouchEvent)\n * it will be returned immediately.\n *\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n * @returns {?(Touch|PointerEvent|MouseEvent)}\n */\nDragger.prototype._getTrackedTouch = function (e) {\n  if (this._pointerId === null) return null;\n  return Dragger._getTouchById(e, this._pointerId);\n};\n\n/**\n * Handler for start event.\n *\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nDragger.prototype._onStart = function (e) {\n  if (this._isDestroyed) return;\n\n  // If pointer id is already assigned let's return early.\n  if (this._pointerId !== null) return;\n\n  // Get (and set) pointer id.\n  this._pointerId = Dragger._getEventPointerId(e);\n  if (this._pointerId === null) return;\n\n  // Setup initial data and emit start event.\n  var touch = this._getTrackedTouch(e);\n  this._startX = this._currentX = touch.clientX;\n  this._startY = this._currentY = touch.clientY;\n  this._startTime = Date.now();\n  this._isActive = true;\n  this._emit(Dragger._emitterEvents.start, e);\n\n  // If the drag procedure was not reset within the start procedure let's\n  // activate the instance (start listening to move/cancel/end events).\n  if (this._isActive) {\n    Dragger._activateInstance(this);\n  }\n};\n\n/**\n * Handler for move event.\n *\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nDragger.prototype._onMove = function (e) {\n  var touch = this._getTrackedTouch(e);\n  if (!touch) return;\n  this._currentX = touch.clientX;\n  this._currentY = touch.clientY;\n  this._emit(Dragger._emitterEvents.move, e);\n};\n\n/**\n * Handler for cancel event.\n *\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nDragger.prototype._onCancel = function (e) {\n  if (!this._getTrackedTouch(e)) return;\n  this._emit(Dragger._emitterEvents.cancel, e);\n  this._reset();\n};\n\n/**\n * Handler for end event.\n *\n * @private\n * @param {(PointerEvent|TouchEvent|MouseEvent)} e\n */\nDragger.prototype._onEnd = function (e) {\n  if (!this._getTrackedTouch(e)) return;\n  this._emit(Dragger._emitterEvents.end, e);\n  this._reset();\n};\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Check if the element is being dragged at the moment.\n *\n * @public\n * @returns {Boolean}\n */\nDragger.prototype.isActive = function () {\n  return this._isActive;\n};\n\n/**\n * Set element's touch-action CSS property.\n *\n * @public\n * @param {String} value\n */\nDragger.prototype.setTouchAction = function (value) {\n  // Store unmodified touch action value (we trust user input here).\n  this._touchAction = value;\n\n  // Set touch-action style.\n  if (taPropPrefixed) {\n    this._cssProps[taPropPrefixed] = '';\n    this._element.style[taPropPrefixed] = value;\n  }\n\n  // If we have an unsupported touch-action value let's add a special listener\n  // that prevents default action on touch start event. A dirty hack, but best\n  // we can do for now. The other options would be to somehow polyfill the\n  // unsupported touch action behavior with custom heuristics which sounds like\n  // a can of worms. We do a special exception here for Firefox Android which's\n  // touch-action does not work properly if the dragged element is moved in the\n  // the DOM tree on touchstart.\n  if (HAS_TOUCH_EVENTS) {\n    this._element.removeEventListener(Dragger._touchEvents.start, Dragger._preventDefault, true);\n    if (this._element.style[taPropPrefixed] !== value || (isFirefox && isAndroid)) {\n      this._element.addEventListener(Dragger._touchEvents.start, Dragger._preventDefault, true);\n    }\n  }\n};\n\n/**\n * Update element's CSS properties. Accepts an object with camel cased style\n * props with value pairs as it's first argument.\n *\n * @public\n * @param {Object} [newProps]\n */\nDragger.prototype.setCssProps = function (newProps) {\n  if (!newProps) return;\n\n  var currentProps = this._cssProps;\n  var element = this._element;\n  var prop;\n  var prefixedProp;\n\n  // Reset current props.\n  for (prop in currentProps) {\n    element.style[prop] = currentProps[prop];\n    delete currentProps[prop];\n  }\n\n  // Set new props.\n  for (prop in newProps) {\n    // Make sure we have a value for the prop.\n    if (!newProps[prop]) continue;\n\n    // Special handling for touch-action.\n    if (prop === taProp) {\n      this.setTouchAction(newProps[prop]);\n      continue;\n    }\n\n    // Get prefixed prop and skip if it does not exist.\n    prefixedProp = getPrefixedPropName(element.style, prop);\n    if (!prefixedProp) continue;\n\n    // Store the prop and add the style.\n    currentProps[prefixedProp] = '';\n    element.style[prefixedProp] = newProps[prop];\n  }\n};\n\n/**\n * How much the pointer has moved on x-axis from start position, in pixels.\n * Positive value indicates movement from left to right.\n *\n * @public\n * @returns {Number}\n */\nDragger.prototype.getDeltaX = function () {\n  return this._currentX - this._startX;\n};\n\n/**\n * How much the pointer has moved on y-axis from start position, in pixels.\n * Positive value indicates movement from top to bottom.\n *\n * @public\n * @returns {Number}\n */\nDragger.prototype.getDeltaY = function () {\n  return this._currentY - this._startY;\n};\n\n/**\n * How far (in pixels) has pointer moved from start position.\n *\n * @public\n * @returns {Number}\n */\nDragger.prototype.getDistance = function () {\n  var x = this.getDeltaX();\n  var y = this.getDeltaY();\n  return Math.sqrt(x * x + y * y);\n};\n\n/**\n * How long has pointer been dragged.\n *\n * @public\n * @returns {Number}\n */\nDragger.prototype.getDeltaTime = function () {\n  return this._startTime ? Date.now() - this._startTime : 0;\n};\n\n/**\n * Bind drag event listeners.\n *\n * @public\n * @param {String} eventName\n *   - 'start', 'move', 'cancel' or 'end'.\n * @param {Function} listener\n */\nDragger.prototype.on = function (eventName, listener) {\n  this._emitter.on(eventName, listener);\n};\n\n/**\n * Unbind drag event listeners.\n *\n * @public\n * @param {String} eventName\n *   - 'start', 'move', 'cancel' or 'end'.\n * @param {Function} listener\n */\nDragger.prototype.off = function (eventName, listener) {\n  this._emitter.off(eventName, listener);\n};\n\n/**\n * Destroy the instance and unbind all drag event listeners.\n *\n * @public\n */\nDragger.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n\n  var element = this._element;\n\n  if (this._edgeHack) this._edgeHack.destroy();\n\n  // Reset data and deactivate the instance.\n  this._reset();\n\n  // Destroy emitter.\n  this._emitter.destroy();\n\n  // Unbind event handlers.\n  element.removeEventListener(Dragger._inputEvents.start, this._onStart, listenerOptions);\n  element.removeEventListener('dragstart', Dragger._preventDefault, false);\n  element.removeEventListener(Dragger._touchEvents.start, Dragger._preventDefault, true);\n\n  // Reset styles.\n  for (var prop in this._cssProps) {\n    element.style[prop] = this._cssProps[prop];\n    delete this._cssProps[prop];\n  }\n\n  // Reset data.\n  this._element = null;\n\n  // Mark as destroyed.\n  this._isDestroyed = true;\n};\n\nvar dt = 1000 / 60;\n\nvar raf = (\n  window.requestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.msRequestAnimationFrame ||\n  function (callback) {\n    return this.setTimeout(function () {\n      callback(Date.now());\n    }, dt);\n  }\n).bind(window);\n\n/**\n * A ticker system for handling DOM reads and writes in an efficient way.\n *\n * @class\n */\nfunction Ticker(numLanes) {\n  this._nextStep = null;\n  this._lanes = [];\n  this._stepQueue = [];\n  this._stepCallbacks = {};\n  this._step = this._step.bind(this);\n  for (var i = 0; i < numLanes; i++) {\n    this._lanes.push(new TickerLane());\n  }\n}\n\nTicker.prototype._step = function (time) {\n  var lanes = this._lanes;\n  var stepQueue = this._stepQueue;\n  var stepCallbacks = this._stepCallbacks;\n  var i, j, id, laneQueue, laneCallbacks, laneIndices;\n\n  this._nextStep = null;\n\n  for (i = 0; i < lanes.length; i++) {\n    laneQueue = lanes[i].queue;\n    laneCallbacks = lanes[i].callbacks;\n    laneIndices = lanes[i].indices;\n    for (j = 0; j < laneQueue.length; j++) {\n      id = laneQueue[j];\n      if (!id) continue;\n      stepQueue.push(id);\n      stepCallbacks[id] = laneCallbacks[id];\n      delete laneCallbacks[id];\n      delete laneIndices[id];\n    }\n    laneQueue.length = 0;\n  }\n\n  for (i = 0; i < stepQueue.length; i++) {\n    id = stepQueue[i];\n    if (stepCallbacks[id]) stepCallbacks[id](time);\n    delete stepCallbacks[id];\n  }\n\n  stepQueue.length = 0;\n};\n\nTicker.prototype.add = function (laneIndex, id, callback) {\n  this._lanes[laneIndex].add(id, callback);\n  if (!this._nextStep) this._nextStep = raf(this._step);\n};\n\nTicker.prototype.remove = function (laneIndex, id) {\n  this._lanes[laneIndex].remove(id);\n};\n\n/**\n * A lane for ticker.\n *\n * @class\n */\nfunction TickerLane() {\n  this.queue = [];\n  this.indices = {};\n  this.callbacks = {};\n}\n\nTickerLane.prototype.add = function (id, callback) {\n  var index = this.indices[id];\n  if (index !== undefined) this.queue[index] = undefined;\n  this.queue.push(id);\n  this.callbacks[id] = callback;\n  this.indices[id] = this.queue.length - 1;\n};\n\nTickerLane.prototype.remove = function (id) {\n  var index = this.indices[id];\n  if (index === undefined) return;\n  this.queue[index] = undefined;\n  delete this.callbacks[id];\n  delete this.indices[id];\n};\n\nvar LAYOUT_READ = 'layoutRead';\nvar LAYOUT_WRITE = 'layoutWrite';\nvar VISIBILITY_READ = 'visibilityRead';\nvar VISIBILITY_WRITE = 'visibilityWrite';\nvar DRAG_START_READ = 'dragStartRead';\nvar DRAG_START_WRITE = 'dragStartWrite';\nvar DRAG_MOVE_READ = 'dragMoveRead';\nvar DRAG_MOVE_WRITE = 'dragMoveWrite';\nvar DRAG_SCROLL_READ = 'dragScrollRead';\nvar DRAG_SCROLL_WRITE = 'dragScrollWrite';\nvar DRAG_SORT_READ = 'dragSortRead';\nvar PLACEHOLDER_LAYOUT_READ = 'placeholderLayoutRead';\nvar PLACEHOLDER_LAYOUT_WRITE = 'placeholderLayoutWrite';\nvar PLACEHOLDER_RESIZE_WRITE = 'placeholderResizeWrite';\nvar AUTO_SCROLL_READ = 'autoScrollRead';\nvar AUTO_SCROLL_WRITE = 'autoScrollWrite';\nvar DEBOUNCE_READ = 'debounceRead';\n\nvar LANE_READ = 0;\nvar LANE_READ_TAIL = 1;\nvar LANE_WRITE = 2;\n\nvar ticker = new Ticker(3);\n\nfunction addLayoutTick(itemId, read, write) {\n  ticker.add(LANE_READ, LAYOUT_READ + itemId, read);\n  ticker.add(LANE_WRITE, LAYOUT_WRITE + itemId, write);\n}\n\nfunction cancelLayoutTick(itemId) {\n  ticker.remove(LANE_READ, LAYOUT_READ + itemId);\n  ticker.remove(LANE_WRITE, LAYOUT_WRITE + itemId);\n}\n\nfunction addVisibilityTick(itemId, read, write) {\n  ticker.add(LANE_READ, VISIBILITY_READ + itemId, read);\n  ticker.add(LANE_WRITE, VISIBILITY_WRITE + itemId, write);\n}\n\nfunction cancelVisibilityTick(itemId) {\n  ticker.remove(LANE_READ, VISIBILITY_READ + itemId);\n  ticker.remove(LANE_WRITE, VISIBILITY_WRITE + itemId);\n}\n\nfunction addDragStartTick(itemId, read, write) {\n  ticker.add(LANE_READ, DRAG_START_READ + itemId, read);\n  ticker.add(LANE_WRITE, DRAG_START_WRITE + itemId, write);\n}\n\nfunction cancelDragStartTick(itemId) {\n  ticker.remove(LANE_READ, DRAG_START_READ + itemId);\n  ticker.remove(LANE_WRITE, DRAG_START_WRITE + itemId);\n}\n\nfunction addDragMoveTick(itemId, read, write) {\n  ticker.add(LANE_READ, DRAG_MOVE_READ + itemId, read);\n  ticker.add(LANE_WRITE, DRAG_MOVE_WRITE + itemId, write);\n}\n\nfunction cancelDragMoveTick(itemId) {\n  ticker.remove(LANE_READ, DRAG_MOVE_READ + itemId);\n  ticker.remove(LANE_WRITE, DRAG_MOVE_WRITE + itemId);\n}\n\nfunction addDragScrollTick(itemId, read, write) {\n  ticker.add(LANE_READ, DRAG_SCROLL_READ + itemId, read);\n  ticker.add(LANE_WRITE, DRAG_SCROLL_WRITE + itemId, write);\n}\n\nfunction cancelDragScrollTick(itemId) {\n  ticker.remove(LANE_READ, DRAG_SCROLL_READ + itemId);\n  ticker.remove(LANE_WRITE, DRAG_SCROLL_WRITE + itemId);\n}\n\nfunction addDragSortTick(itemId, read) {\n  ticker.add(LANE_READ_TAIL, DRAG_SORT_READ + itemId, read);\n}\n\nfunction cancelDragSortTick(itemId) {\n  ticker.remove(LANE_READ_TAIL, DRAG_SORT_READ + itemId);\n}\n\nfunction addPlaceholderLayoutTick(itemId, read, write) {\n  ticker.add(LANE_READ, PLACEHOLDER_LAYOUT_READ + itemId, read);\n  ticker.add(LANE_WRITE, PLACEHOLDER_LAYOUT_WRITE + itemId, write);\n}\n\nfunction cancelPlaceholderLayoutTick(itemId) {\n  ticker.remove(LANE_READ, PLACEHOLDER_LAYOUT_READ + itemId);\n  ticker.remove(LANE_WRITE, PLACEHOLDER_LAYOUT_WRITE + itemId);\n}\n\nfunction addPlaceholderResizeTick(itemId, write) {\n  ticker.add(LANE_WRITE, PLACEHOLDER_RESIZE_WRITE + itemId, write);\n}\n\nfunction cancelPlaceholderResizeTick(itemId) {\n  ticker.remove(LANE_WRITE, PLACEHOLDER_RESIZE_WRITE + itemId);\n}\n\nfunction addAutoScrollTick(read, write) {\n  ticker.add(LANE_READ, AUTO_SCROLL_READ, read);\n  ticker.add(LANE_WRITE, AUTO_SCROLL_WRITE, write);\n}\n\nfunction cancelAutoScrollTick() {\n  ticker.remove(LANE_READ, AUTO_SCROLL_READ);\n  ticker.remove(LANE_WRITE, AUTO_SCROLL_WRITE);\n}\n\nfunction addDebounceTick(debounceId, read) {\n  ticker.add(LANE_READ, DEBOUNCE_READ + debounceId, read);\n}\n\nfunction cancelDebounceTick(debounceId) {\n  ticker.remove(LANE_READ, DEBOUNCE_READ + debounceId);\n}\n\nvar AXIS_X = 1;\nvar AXIS_Y = 2;\nvar FORWARD = 4;\nvar BACKWARD = 8;\nvar LEFT = AXIS_X | BACKWARD;\nvar RIGHT = AXIS_X | FORWARD;\nvar UP = AXIS_Y | BACKWARD;\nvar DOWN = AXIS_Y | FORWARD;\n\nvar functionType = 'function';\n\n/**\n * Check if a value is a function.\n *\n * @param {*} val\n * @returns {Boolean}\n */\nfunction isFunction(val) {\n  return typeof val === functionType;\n}\n\nvar isWeakMapSupported = typeof WeakMap === 'function';\nvar cache$1 = isWeakMapSupported ? new WeakMap() : null;\nvar cacheInterval = 3000;\nvar cacheTimer;\nvar canClearCache = true;\nvar clearCache = function () {\n  if (canClearCache) {\n    cacheTimer = window.clearInterval(cacheTimer);\n    cache$1 = isWeakMapSupported ? new WeakMap() : null;\n  } else {\n    canClearCache = true;\n  }\n};\n\n/**\n * Returns the computed value of an element's style property as a string.\n *\n * @param {HTMLElement} element\n * @param {String} style\n * @returns {String}\n */\nfunction getStyle(element, style) {\n  var styles = cache$1 && cache$1.get(element);\n\n  if (!styles) {\n    styles = window.getComputedStyle(element, null);\n    if (cache$1) cache$1.set(element, styles);\n  }\n\n  if (cache$1) {\n    if (!cacheTimer) {\n      cacheTimer = window.setInterval(clearCache, cacheInterval);\n    } else {\n      canClearCache = false;\n    }\n  }\n\n  return styles.getPropertyValue(style);\n}\n\n/**\n * Returns the computed value of an element's style property transformed into\n * a float value.\n *\n * @param {HTMLElement} el\n * @param {String} style\n * @returns {Number}\n */\nfunction getStyleAsFloat(el, style) {\n  return parseFloat(getStyle(el, style)) || 0;\n}\n\nvar DOC_ELEM = document.documentElement;\nvar BODY = document.body;\nvar THRESHOLD_DATA = { value: 0, offset: 0 };\n\n/**\n * @param {HTMLElement|Window} element\n * @returns {HTMLElement|Window}\n */\nfunction getScrollElement(element) {\n  if (element === window || element === DOC_ELEM || element === BODY) {\n    return window;\n  } else {\n    return element;\n  }\n}\n\n/**\n * @param {HTMLElement|Window} element\n * @returns {Number}\n */\nfunction getScrollLeft(element) {\n  return element === window ? element.pageXOffset : element.scrollLeft;\n}\n\n/**\n * @param {HTMLElement|Window} element\n * @returns {Number}\n */\nfunction getScrollTop(element) {\n  return element === window ? element.pageYOffset : element.scrollTop;\n}\n\n/**\n * @param {HTMLElement|Window} element\n * @returns {Number}\n */\nfunction getScrollLeftMax(element) {\n  if (element === window) {\n    return DOC_ELEM.scrollWidth - DOC_ELEM.clientWidth;\n  } else {\n    return element.scrollWidth - element.clientWidth;\n  }\n}\n\n/**\n * @param {HTMLElement|Window} element\n * @returns {Number}\n */\nfunction getScrollTopMax(element) {\n  if (element === window) {\n    return DOC_ELEM.scrollHeight - DOC_ELEM.clientHeight;\n  } else {\n    return element.scrollHeight - element.clientHeight;\n  }\n}\n\n/**\n * Get window's or element's client rectangle data relative to the element's\n * content dimensions (includes inner size + padding, excludes scrollbars,\n * borders and margins).\n *\n * @param {HTMLElement|Window} element\n * @returns {Rectangle}\n */\nfunction getContentRect(element, result) {\n  result = result || {};\n\n  if (element === window) {\n    result.width = DOC_ELEM.clientWidth;\n    result.height = DOC_ELEM.clientHeight;\n    result.left = 0;\n    result.right = result.width;\n    result.top = 0;\n    result.bottom = result.height;\n  } else {\n    var bcr = element.getBoundingClientRect();\n    var borderLeft = element.clientLeft || getStyleAsFloat(element, 'border-left-width');\n    var borderTop = element.clientTop || getStyleAsFloat(element, 'border-top-width');\n    result.width = element.clientWidth;\n    result.height = element.clientHeight;\n    result.left = bcr.left + borderLeft;\n    result.right = result.left + result.width;\n    result.top = bcr.top + borderTop;\n    result.bottom = result.top + result.height;\n  }\n\n  return result;\n}\n\n/**\n * @param {Item} item\n * @returns {Object}\n */\nfunction getItemAutoScrollSettings(item) {\n  return item._drag._getGrid()._settings.dragAutoScroll;\n}\n\n/**\n * @param {Item} item\n */\nfunction prepareItemScrollSync(item) {\n  if (!item._drag) return;\n  item._drag._prepareScroll();\n}\n\n/**\n * @param {Item} item\n */\nfunction applyItemScrollSync(item) {\n  if (!item._drag || !item._isActive) return;\n  var drag = item._drag;\n  drag._scrollDiffX = drag._scrollDiffY = 0;\n  item._setTranslate(drag._left, drag._top);\n}\n\n/**\n * Compute threshold value and edge offset.\n *\n * @param {Number} threshold\n * @param {Number} safeZone\n * @param {Number} itemSize\n * @param {Number} targetSize\n * @returns {Object}\n */\nfunction computeThreshold(threshold, safeZone, itemSize, targetSize) {\n  THRESHOLD_DATA.value = Math.min(targetSize / 2, threshold);\n  THRESHOLD_DATA.offset =\n    Math.max(0, itemSize + THRESHOLD_DATA.value * 2 + targetSize * safeZone - targetSize) / 2;\n  return THRESHOLD_DATA;\n}\n\nfunction ScrollRequest() {\n  this.reset();\n}\n\nScrollRequest.prototype.reset = function () {\n  if (this.isActive) this.onStop();\n  this.item = null;\n  this.element = null;\n  this.isActive = false;\n  this.isEnding = false;\n  this.direction = null;\n  this.value = null;\n  this.maxValue = 0;\n  this.threshold = 0;\n  this.distance = 0;\n  this.speed = 0;\n  this.duration = 0;\n  this.action = null;\n};\n\nScrollRequest.prototype.hasReachedEnd = function () {\n  return FORWARD & this.direction ? this.value >= this.maxValue : this.value <= 0;\n};\n\nScrollRequest.prototype.computeCurrentScrollValue = function () {\n  if (this.value === null) {\n    return AXIS_X & this.direction ? getScrollLeft(this.element) : getScrollTop(this.element);\n  }\n  return Math.max(0, Math.min(this.value, this.maxValue));\n};\n\nScrollRequest.prototype.computeNextScrollValue = function (deltaTime) {\n  var delta = this.speed * (deltaTime / 1000);\n  var nextValue = FORWARD & this.direction ? this.value + delta : this.value - delta;\n  return Math.max(0, Math.min(nextValue, this.maxValue));\n};\n\nScrollRequest.prototype.computeSpeed = (function () {\n  var data = {\n    direction: null,\n    threshold: 0,\n    distance: 0,\n    value: 0,\n    maxValue: 0,\n    deltaTime: 0,\n    duration: 0,\n    isEnding: false,\n  };\n\n  return function (deltaTime) {\n    var item = this.item;\n    var speed = getItemAutoScrollSettings(item).speed;\n\n    if (isFunction(speed)) {\n      data.direction = this.direction;\n      data.threshold = this.threshold;\n      data.distance = this.distance;\n      data.value = this.value;\n      data.maxValue = this.maxValue;\n      data.duration = this.duration;\n      data.speed = this.speed;\n      data.deltaTime = deltaTime;\n      data.isEnding = this.isEnding;\n      return speed(item, this.element, data);\n    } else {\n      return speed;\n    }\n  };\n})();\n\nScrollRequest.prototype.tick = function (deltaTime) {\n  if (!this.isActive) {\n    this.isActive = true;\n    this.onStart();\n  }\n  this.value = this.computeCurrentScrollValue();\n  this.speed = this.computeSpeed(deltaTime);\n  this.value = this.computeNextScrollValue(deltaTime);\n  this.duration += deltaTime;\n  return this.value;\n};\n\nScrollRequest.prototype.onStart = function () {\n  var item = this.item;\n  var onStart = getItemAutoScrollSettings(item).onStart;\n  if (isFunction(onStart)) onStart(item, this.element, this.direction);\n};\n\nScrollRequest.prototype.onStop = function () {\n  var item = this.item;\n  var onStop = getItemAutoScrollSettings(item).onStop;\n  if (isFunction(onStop)) onStop(item, this.element, this.direction);\n  // Manually nudge sort to happen. There's a good chance that the item is still\n  // after the scroll stops which means that the next sort will be triggered\n  // only after the item is moved or it's parent scrolled.\n  if (item._drag) item._drag.sort();\n};\n\nfunction ScrollAction() {\n  this.element = null;\n  this.requestX = null;\n  this.requestY = null;\n  this.scrollLeft = 0;\n  this.scrollTop = 0;\n}\n\nScrollAction.prototype.reset = function () {\n  if (this.requestX) this.requestX.action = null;\n  if (this.requestY) this.requestY.action = null;\n  this.element = null;\n  this.requestX = null;\n  this.requestY = null;\n  this.scrollLeft = 0;\n  this.scrollTop = 0;\n};\n\nScrollAction.prototype.addRequest = function (request) {\n  if (AXIS_X & request.direction) {\n    this.removeRequest(this.requestX);\n    this.requestX = request;\n  } else {\n    this.removeRequest(this.requestY);\n    this.requestY = request;\n  }\n  request.action = this;\n};\n\nScrollAction.prototype.removeRequest = function (request) {\n  if (!request) return;\n  if (this.requestX === request) {\n    this.requestX = null;\n    request.action = null;\n  } else if (this.requestY === request) {\n    this.requestY = null;\n    request.action = null;\n  }\n};\n\nScrollAction.prototype.computeScrollValues = function () {\n  this.scrollLeft = this.requestX ? this.requestX.value : getScrollLeft(this.element);\n  this.scrollTop = this.requestY ? this.requestY.value : getScrollTop(this.element);\n};\n\nScrollAction.prototype.scroll = function () {\n  var element = this.element;\n  if (!element) return;\n\n  if (element.scrollTo) {\n    element.scrollTo(this.scrollLeft, this.scrollTop);\n  } else {\n    element.scrollLeft = this.scrollLeft;\n    element.scrollTop = this.scrollTop;\n  }\n};\n\nfunction Pool(createItem, releaseItem) {\n  this.pool = [];\n  this.createItem = createItem;\n  this.releaseItem = releaseItem;\n}\n\nPool.prototype.pick = function () {\n  return this.pool.pop() || this.createItem();\n};\n\nPool.prototype.release = function (item) {\n  this.releaseItem(item);\n  if (this.pool.indexOf(item) !== -1) return;\n  this.pool.push(item);\n};\n\nPool.prototype.reset = function () {\n  this.pool.length = 0;\n};\n\n/**\n * Check if two rectangles are overlapping.\n *\n * @param {Object} a\n * @param {Object} b\n * @returns {Number}\n */\nfunction isOverlapping(a, b) {\n  return !(\n    a.left + a.width <= b.left ||\n    b.left + b.width <= a.left ||\n    a.top + a.height <= b.top ||\n    b.top + b.height <= a.top\n  );\n}\n\n/**\n * Calculate intersection area between two rectangle.\n *\n * @param {Object} a\n * @param {Object} b\n * @returns {Number}\n */\nfunction getIntersectionArea(a, b) {\n  if (!isOverlapping(a, b)) return 0;\n  var width = Math.min(a.left + a.width, b.left + b.width) - Math.max(a.left, b.left);\n  var height = Math.min(a.top + a.height, b.top + b.height) - Math.max(a.top, b.top);\n  return width * height;\n}\n\n/**\n * Calculate how many percent the intersection area of two rectangles is from\n * the maximum potential intersection area between the rectangles.\n *\n * @param {Object} a\n * @param {Object} b\n * @returns {Number}\n */\nfunction getIntersectionScore(a, b) {\n  var area = getIntersectionArea(a, b);\n  if (!area) return 0;\n  var maxArea = Math.min(a.width, b.width) * Math.min(a.height, b.height);\n  return (area / maxArea) * 100;\n}\n\nvar RECT_1 = {\n  width: 0,\n  height: 0,\n  left: 0,\n  right: 0,\n  top: 0,\n  bottom: 0,\n};\n\nvar RECT_2 = {\n  width: 0,\n  height: 0,\n  left: 0,\n  right: 0,\n  top: 0,\n  bottom: 0,\n};\n\nfunction AutoScroller() {\n  this._isDestroyed = false;\n  this._isTicking = false;\n  this._tickTime = 0;\n  this._tickDeltaTime = 0;\n  this._items = [];\n  this._actions = [];\n  this._requests = {};\n  this._requests[AXIS_X] = {};\n  this._requests[AXIS_Y] = {};\n  this._requestOverlapCheck = {};\n  this._dragPositions = {};\n  this._dragDirections = {};\n  this._overlapCheckInterval = 150;\n\n  this._requestPool = new Pool(\n    function () {\n      return new ScrollRequest();\n    },\n    function (request) {\n      request.reset();\n    }\n  );\n\n  this._actionPool = new Pool(\n    function () {\n      return new ScrollAction();\n    },\n    function (action) {\n      action.reset();\n    }\n  );\n\n  this._readTick = this._readTick.bind(this);\n  this._writeTick = this._writeTick.bind(this);\n}\n\nAutoScroller.AXIS_X = AXIS_X;\nAutoScroller.AXIS_Y = AXIS_Y;\nAutoScroller.FORWARD = FORWARD;\nAutoScroller.BACKWARD = BACKWARD;\nAutoScroller.LEFT = LEFT;\nAutoScroller.RIGHT = RIGHT;\nAutoScroller.UP = UP;\nAutoScroller.DOWN = DOWN;\n\nAutoScroller.smoothSpeed = function (maxSpeed, acceleration, deceleration) {\n  return function (item, element, data) {\n    var targetSpeed = 0;\n    if (!data.isEnding) {\n      if (data.threshold > 0) {\n        var factor = data.threshold - Math.max(0, data.distance);\n        targetSpeed = (maxSpeed / data.threshold) * factor;\n      } else {\n        targetSpeed = maxSpeed;\n      }\n    }\n\n    var currentSpeed = data.speed;\n    var nextSpeed = targetSpeed;\n\n    if (currentSpeed === targetSpeed) {\n      return nextSpeed;\n    }\n\n    if (currentSpeed < targetSpeed) {\n      nextSpeed = currentSpeed + acceleration * (data.deltaTime / 1000);\n      return Math.min(targetSpeed, nextSpeed);\n    } else {\n      nextSpeed = currentSpeed - deceleration * (data.deltaTime / 1000);\n      return Math.max(targetSpeed, nextSpeed);\n    }\n  };\n};\n\nAutoScroller.pointerHandle = function (pointerSize) {\n  var rect = { left: 0, top: 0, width: 0, height: 0 };\n  var size = pointerSize || 1;\n  return function (item, x, y, w, h, pX, pY) {\n    rect.left = pX - size * 0.5;\n    rect.top = pY - size * 0.5;\n    rect.width = size;\n    rect.height = size;\n    return rect;\n  };\n};\n\nAutoScroller.prototype._readTick = function (time) {\n  if (this._isDestroyed) return;\n  if (time && this._tickTime) {\n    this._tickDeltaTime = time - this._tickTime;\n    this._tickTime = time;\n    this._updateRequests();\n    this._updateActions();\n  } else {\n    this._tickTime = time;\n    this._tickDeltaTime = 0;\n  }\n};\n\nAutoScroller.prototype._writeTick = function () {\n  if (this._isDestroyed) return;\n  this._applyActions();\n  addAutoScrollTick(this._readTick, this._writeTick);\n};\n\nAutoScroller.prototype._startTicking = function () {\n  this._isTicking = true;\n  addAutoScrollTick(this._readTick, this._writeTick);\n};\n\nAutoScroller.prototype._stopTicking = function () {\n  this._isTicking = false;\n  this._tickTime = 0;\n  this._tickDeltaTime = 0;\n  cancelAutoScrollTick();\n};\n\nAutoScroller.prototype._getItemHandleRect = function (item, handle, rect) {\n  var itemDrag = item._drag;\n\n  if (handle) {\n    var ev = itemDrag._dragMoveEvent || itemDrag._dragStartEvent;\n    var data = handle(\n      item,\n      itemDrag._clientX,\n      itemDrag._clientY,\n      item._width,\n      item._height,\n      ev.clientX,\n      ev.clientY\n    );\n    rect.left = data.left;\n    rect.top = data.top;\n    rect.width = data.width;\n    rect.height = data.height;\n  } else {\n    rect.left = itemDrag._clientX;\n    rect.top = itemDrag._clientY;\n    rect.width = item._width;\n    rect.height = item._height;\n  }\n\n  rect.right = rect.left + rect.width;\n  rect.bottom = rect.top + rect.height;\n\n  return rect;\n};\n\nAutoScroller.prototype._requestItemScroll = function (\n  item,\n  axis,\n  element,\n  direction,\n  threshold,\n  distance,\n  maxValue\n) {\n  var reqMap = this._requests[axis];\n  var request = reqMap[item._id];\n\n  if (request) {\n    if (request.element !== element || request.direction !== direction) {\n      request.reset();\n    }\n  } else {\n    request = this._requestPool.pick();\n  }\n\n  request.item = item;\n  request.element = element;\n  request.direction = direction;\n  request.threshold = threshold;\n  request.distance = distance;\n  request.maxValue = maxValue;\n  reqMap[item._id] = request;\n};\n\nAutoScroller.prototype._cancelItemScroll = function (item, axis) {\n  var reqMap = this._requests[axis];\n  var request = reqMap[item._id];\n  if (!request) return;\n  if (request.action) request.action.removeRequest(request);\n  this._requestPool.release(request);\n  delete reqMap[item._id];\n};\n\nAutoScroller.prototype._checkItemOverlap = function (item, checkX, checkY) {\n  var settings = getItemAutoScrollSettings(item);\n  var targets = isFunction(settings.targets) ? settings.targets(item) : settings.targets;\n  var threshold = settings.threshold;\n  var safeZone = settings.safeZone;\n\n  if (!targets || !targets.length) {\n    checkX && this._cancelItemScroll(item, AXIS_X);\n    checkY && this._cancelItemScroll(item, AXIS_Y);\n    return;\n  }\n\n  var dragDirections = this._dragDirections[item._id];\n  var dragDirectionX = dragDirections[0];\n  var dragDirectionY = dragDirections[1];\n\n  if (!dragDirectionX && !dragDirectionY) {\n    checkX && this._cancelItemScroll(item, AXIS_X);\n    checkY && this._cancelItemScroll(item, AXIS_Y);\n    return;\n  }\n\n  var itemRect = this._getItemHandleRect(item, settings.handle, RECT_1);\n  var testRect = RECT_2;\n\n  var target = null;\n  var testElement = null;\n  var testAxisX = true;\n  var testAxisY = true;\n  var testScore = 0;\n  var testPriority = 0;\n  var testThreshold = null;\n  var testDirection = null;\n  var testDistance = 0;\n  var testMaxScrollX = 0;\n  var testMaxScrollY = 0;\n\n  var xElement = null;\n  var xPriority = -Infinity;\n  var xThreshold = 0;\n  var xScore = 0;\n  var xDirection = null;\n  var xDistance = 0;\n  var xMaxScroll = 0;\n\n  var yElement = null;\n  var yPriority = -Infinity;\n  var yThreshold = 0;\n  var yScore = 0;\n  var yDirection = null;\n  var yDistance = 0;\n  var yMaxScroll = 0;\n\n  for (var i = 0; i < targets.length; i++) {\n    target = targets[i];\n    testAxisX = checkX && dragDirectionX && target.axis !== AXIS_Y;\n    testAxisY = checkY && dragDirectionY && target.axis !== AXIS_X;\n    testPriority = target.priority || 0;\n\n    // Ignore this item if it's x-axis and y-axis priority is lower than\n    // the currently matching item's.\n    if ((!testAxisX || testPriority < xPriority) && (!testAxisY || testPriority < yPriority)) {\n      continue;\n    }\n\n    testElement = getScrollElement(target.element || target);\n    testMaxScrollX = testAxisX ? getScrollLeftMax(testElement) : -1;\n    testMaxScrollY = testAxisY ? getScrollTopMax(testElement) : -1;\n\n    // Ignore this item if there is no possibility to scroll.\n    if (!testMaxScrollX && !testMaxScrollY) continue;\n\n    testRect = getContentRect(testElement, testRect);\n    testScore = getIntersectionScore(itemRect, testRect);\n\n    // Ignore this item if it's not overlapping at all with the dragged item.\n    if (testScore <= 0) continue;\n\n    // Test x-axis.\n    if (\n      testAxisX &&\n      testPriority >= xPriority &&\n      testMaxScrollX > 0 &&\n      (testPriority > xPriority || testScore > xScore)\n    ) {\n      testDirection = null;\n      testThreshold = computeThreshold(\n        typeof target.threshold === 'number' ? target.threshold : threshold,\n        safeZone,\n        itemRect.width,\n        testRect.width\n      );\n      if (dragDirectionX === RIGHT) {\n        testDistance = testRect.right + testThreshold.offset - itemRect.right;\n        if (testDistance <= testThreshold.value && getScrollLeft(testElement) < testMaxScrollX) {\n          testDirection = RIGHT;\n        }\n      } else if (dragDirectionX === LEFT) {\n        testDistance = itemRect.left - (testRect.left - testThreshold.offset);\n        if (testDistance <= testThreshold.value && getScrollLeft(testElement) > 0) {\n          testDirection = LEFT;\n        }\n      }\n\n      if (testDirection !== null) {\n        xElement = testElement;\n        xPriority = testPriority;\n        xThreshold = testThreshold.value;\n        xScore = testScore;\n        xDirection = testDirection;\n        xDistance = testDistance;\n        xMaxScroll = testMaxScrollX;\n      }\n    }\n\n    // Test y-axis.\n    if (\n      testAxisY &&\n      testPriority >= yPriority &&\n      testMaxScrollY > 0 &&\n      (testPriority > yPriority || testScore > yScore)\n    ) {\n      testDirection = null;\n      testThreshold = computeThreshold(\n        typeof target.threshold === 'number' ? target.threshold : threshold,\n        safeZone,\n        itemRect.height,\n        testRect.height\n      );\n      if (dragDirectionY === DOWN) {\n        testDistance = testRect.bottom + testThreshold.offset - itemRect.bottom;\n        if (testDistance <= testThreshold.value && getScrollTop(testElement) < testMaxScrollY) {\n          testDirection = DOWN;\n        }\n      } else if (dragDirectionY === UP) {\n        testDistance = itemRect.top - (testRect.top - testThreshold.offset);\n        if (testDistance <= testThreshold.value && getScrollTop(testElement) > 0) {\n          testDirection = UP;\n        }\n      }\n\n      if (testDirection !== null) {\n        yElement = testElement;\n        yPriority = testPriority;\n        yThreshold = testThreshold.value;\n        yScore = testScore;\n        yDirection = testDirection;\n        yDistance = testDistance;\n        yMaxScroll = testMaxScrollY;\n      }\n    }\n  }\n\n  // Request or cancel x-axis scroll.\n  if (checkX) {\n    if (xElement) {\n      this._requestItemScroll(\n        item,\n        AXIS_X,\n        xElement,\n        xDirection,\n        xThreshold,\n        xDistance,\n        xMaxScroll\n      );\n    } else {\n      this._cancelItemScroll(item, AXIS_X);\n    }\n  }\n\n  // Request or cancel y-axis scroll.\n  if (checkY) {\n    if (yElement) {\n      this._requestItemScroll(\n        item,\n        AXIS_Y,\n        yElement,\n        yDirection,\n        yThreshold,\n        yDistance,\n        yMaxScroll\n      );\n    } else {\n      this._cancelItemScroll(item, AXIS_Y);\n    }\n  }\n};\n\nAutoScroller.prototype._updateScrollRequest = function (scrollRequest) {\n  var item = scrollRequest.item;\n  var settings = getItemAutoScrollSettings(item);\n  var targets = isFunction(settings.targets) ? settings.targets(item) : settings.targets;\n  var targetCount = (targets && targets.length) || 0;\n  var threshold = settings.threshold;\n  var safeZone = settings.safeZone;\n  var itemRect = this._getItemHandleRect(item, settings.handle, RECT_1);\n  var testRect = RECT_2;\n  var target = null;\n  var testElement = null;\n  var testIsAxisX = false;\n  var testScore = null;\n  var testThreshold = null;\n  var testDistance = null;\n  var testScroll = null;\n  var testMaxScroll = null;\n  var hasReachedEnd = null;\n\n  for (var i = 0; i < targetCount; i++) {\n    target = targets[i];\n\n    // Make sure we have a matching element.\n    testElement = getScrollElement(target.element || target);\n    if (testElement !== scrollRequest.element) continue;\n\n    // Make sure we have a matching axis.\n    testIsAxisX = !!(AXIS_X & scrollRequest.direction);\n    if (testIsAxisX) {\n      if (target.axis === AXIS_Y) continue;\n    } else {\n      if (target.axis === AXIS_X) continue;\n    }\n\n    // Stop scrolling if there is no room to scroll anymore.\n    testMaxScroll = testIsAxisX ? getScrollLeftMax(testElement) : getScrollTopMax(testElement);\n    if (testMaxScroll <= 0) {\n      break;\n    }\n\n    testRect = getContentRect(testElement, testRect);\n    testScore = getIntersectionScore(itemRect, testRect);\n\n    // Stop scrolling if dragged item is not overlapping with the scroll\n    // element anymore.\n    if (testScore <= 0) {\n      break;\n    }\n\n    // Compute threshold and edge offset.\n    testThreshold = computeThreshold(\n      typeof target.threshold === 'number' ? target.threshold : threshold,\n      safeZone,\n      testIsAxisX ? itemRect.width : itemRect.height,\n      testIsAxisX ? testRect.width : testRect.height\n    );\n\n    // Compute distance (based on current direction).\n    if (scrollRequest.direction === LEFT) {\n      testDistance = itemRect.left - (testRect.left - testThreshold.offset);\n    } else if (scrollRequest.direction === RIGHT) {\n      testDistance = testRect.right + testThreshold.offset - itemRect.right;\n    } else if (scrollRequest.direction === UP) {\n      testDistance = itemRect.top - (testRect.top - testThreshold.offset);\n    } else {\n      testDistance = testRect.bottom + testThreshold.offset - itemRect.bottom;\n    }\n\n    // Stop scrolling if threshold is not exceeded.\n    if (testDistance > testThreshold.value) {\n      break;\n    }\n\n    // Stop scrolling if we have reached the end of the scroll value.\n    testScroll = testIsAxisX ? getScrollLeft(testElement) : getScrollTop(testElement);\n    hasReachedEnd =\n      FORWARD & scrollRequest.direction ? testScroll >= testMaxScroll : testScroll <= 0;\n    if (hasReachedEnd) {\n      break;\n    }\n\n    // Scrolling can continue, let's update the values.\n    scrollRequest.maxValue = testMaxScroll;\n    scrollRequest.threshold = testThreshold.value;\n    scrollRequest.distance = testDistance;\n    scrollRequest.isEnding = false;\n    return true;\n  }\n\n  // Before we end the request, let's see if we need to stop the scrolling\n  // smoothly or immediately.\n  if (settings.smoothStop === true && scrollRequest.speed > 0) {\n    if (hasReachedEnd === null) hasReachedEnd = scrollRequest.hasReachedEnd();\n    scrollRequest.isEnding = hasReachedEnd ? false : true;\n  } else {\n    scrollRequest.isEnding = false;\n  }\n\n  return scrollRequest.isEnding;\n};\n\nAutoScroller.prototype._updateRequests = function () {\n  var items = this._items;\n  var requestsX = this._requests[AXIS_X];\n  var requestsY = this._requests[AXIS_Y];\n  var item, reqX, reqY, checkTime, needsCheck, checkX, checkY;\n\n  for (var i = 0; i < items.length; i++) {\n    item = items[i];\n    checkTime = this._requestOverlapCheck[item._id];\n    needsCheck = checkTime > 0 && this._tickTime - checkTime > this._overlapCheckInterval;\n\n    checkX = true;\n    reqX = requestsX[item._id];\n    if (reqX && reqX.isActive) {\n      checkX = !this._updateScrollRequest(reqX);\n      if (checkX) {\n        needsCheck = true;\n        this._cancelItemScroll(item, AXIS_X);\n      }\n    }\n\n    checkY = true;\n    reqY = requestsY[item._id];\n    if (reqY && reqY.isActive) {\n      checkY = !this._updateScrollRequest(reqY);\n      if (checkY) {\n        needsCheck = true;\n        this._cancelItemScroll(item, AXIS_Y);\n      }\n    }\n\n    if (needsCheck) {\n      this._requestOverlapCheck[item._id] = 0;\n      this._checkItemOverlap(item, checkX, checkY);\n    }\n  }\n};\n\nAutoScroller.prototype._requestAction = function (request, axis) {\n  var actions = this._actions;\n  var isAxisX = axis === AXIS_X;\n  var action = null;\n\n  for (var i = 0; i < actions.length; i++) {\n    action = actions[i];\n\n    // If the action's request does not match the request's -> skip.\n    if (request.element !== action.element) {\n      action = null;\n      continue;\n    }\n\n    // If the request and action share the same element, but the request slot\n    // for the requested axis is already reserved let's ignore and cancel this\n    // request.\n    if (isAxisX ? action.requestX : action.requestY) {\n      this._cancelItemScroll(request.item, axis);\n      return;\n    }\n\n    // Seems like we have found our action, let's break the loop.\n    break;\n  }\n\n  if (!action) action = this._actionPool.pick();\n  action.element = request.element;\n  action.addRequest(request);\n\n  request.tick(this._tickDeltaTime);\n  actions.push(action);\n};\n\nAutoScroller.prototype._updateActions = function () {\n  var items = this._items;\n  var requests = this._requests;\n  var actions = this._actions;\n  var itemId;\n  var reqX;\n  var reqY;\n  var i;\n\n  // Generate actions.\n  for (i = 0; i < items.length; i++) {\n    itemId = items[i]._id;\n    reqX = requests[AXIS_X][itemId];\n    reqY = requests[AXIS_Y][itemId];\n    if (reqX) this._requestAction(reqX, AXIS_X);\n    if (reqY) this._requestAction(reqY, AXIS_Y);\n  }\n\n  // Compute actions' scroll values.\n  for (i = 0; i < actions.length; i++) {\n    actions[i].computeScrollValues();\n  }\n};\n\nAutoScroller.prototype._applyActions = function () {\n  var actions = this._actions;\n  var items = this._items;\n  var i;\n\n  // No actions -> no scrolling.\n  if (!actions.length) return;\n\n  // Scroll all the required elements.\n  for (i = 0; i < actions.length; i++) {\n    actions[i].scroll();\n    this._actionPool.release(actions[i]);\n  }\n\n  // Reset actions.\n  actions.length = 0;\n\n  // Sync the item position immediately after all the auto-scrolling business is\n  // finished. Without this procedure the items will jitter during auto-scroll\n  // (in some cases at least) since the drag scroll handler is async (bound to\n  // raf tick). Note that this procedure should not emit any dragScroll events,\n  // because otherwise they would be emitted twice for the same event.\n  for (i = 0; i < items.length; i++) prepareItemScrollSync(items[i]);\n  for (i = 0; i < items.length; i++) applyItemScrollSync(items[i]);\n};\n\nAutoScroller.prototype._updateDragDirection = function (item) {\n  var dragPositions = this._dragPositions[item._id];\n  var dragDirections = this._dragDirections[item._id];\n  var x1 = item._drag._left;\n  var y1 = item._drag._top;\n  if (dragPositions.length) {\n    var x2 = dragPositions[0];\n    var y2 = dragPositions[1];\n    dragDirections[0] = x1 > x2 ? RIGHT : x1 < x2 ? LEFT : dragDirections[0] || 0;\n    dragDirections[1] = y1 > y2 ? DOWN : y1 < y2 ? UP : dragDirections[1] || 0;\n  }\n  dragPositions[0] = x1;\n  dragPositions[1] = y1;\n};\n\nAutoScroller.prototype.addItem = function (item) {\n  if (this._isDestroyed) return;\n  var index = this._items.indexOf(item);\n  if (index === -1) {\n    this._items.push(item);\n    this._requestOverlapCheck[item._id] = this._tickTime;\n    this._dragDirections[item._id] = [0, 0];\n    this._dragPositions[item._id] = [];\n    if (!this._isTicking) this._startTicking();\n  }\n};\n\nAutoScroller.prototype.updateItem = function (item) {\n  if (this._isDestroyed) return;\n\n  // Make sure the item still exists in the auto-scroller.\n  if (!this._dragDirections[item._id]) return;\n\n  this._updateDragDirection(item);\n  if (!this._requestOverlapCheck[item._id]) {\n    this._requestOverlapCheck[item._id] = this._tickTime;\n  }\n};\n\nAutoScroller.prototype.removeItem = function (item) {\n  if (this._isDestroyed) return;\n\n  var index = this._items.indexOf(item);\n  if (index === -1) return;\n\n  var itemId = item._id;\n\n  var reqX = this._requests[AXIS_X][itemId];\n  if (reqX) {\n    this._cancelItemScroll(item, AXIS_X);\n    delete this._requests[AXIS_X][itemId];\n  }\n\n  var reqY = this._requests[AXIS_Y][itemId];\n  if (reqY) {\n    this._cancelItemScroll(item, AXIS_Y);\n    delete this._requests[AXIS_Y][itemId];\n  }\n\n  delete this._requestOverlapCheck[itemId];\n  delete this._dragPositions[itemId];\n  delete this._dragDirections[itemId];\n  this._items.splice(index, 1);\n\n  if (this._isTicking && !this._items.length) {\n    this._stopTicking();\n  }\n};\n\nAutoScroller.prototype.isItemScrollingX = function (item) {\n  var reqX = this._requests[AXIS_X][item._id];\n  return !!(reqX && reqX.isActive);\n};\n\nAutoScroller.prototype.isItemScrollingY = function (item) {\n  var reqY = this._requests[AXIS_Y][item._id];\n  return !!(reqY && reqY.isActive);\n};\n\nAutoScroller.prototype.isItemScrolling = function (item) {\n  return this.isItemScrollingX(item) || this.isItemScrollingY(item);\n};\n\nAutoScroller.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n\n  var items = this._items.slice(0);\n  for (var i = 0; i < items.length; i++) {\n    this.removeItem(items[i]);\n  }\n\n  this._actions.length = 0;\n  this._requestPool.reset();\n  this._actionPool.reset();\n\n  this._isDestroyed = true;\n};\n\nvar ElProto = window.Element.prototype;\nvar matchesFn =\n  ElProto.matches ||\n  ElProto.matchesSelector ||\n  ElProto.webkitMatchesSelector ||\n  ElProto.mozMatchesSelector ||\n  ElProto.msMatchesSelector ||\n  ElProto.oMatchesSelector ||\n  function () {\n    return false;\n  };\n\n/**\n * Check if element matches a CSS selector.\n *\n * @param {Element} el\n * @param {String} selector\n * @returns {Boolean}\n */\nfunction elementMatches(el, selector) {\n  return matchesFn.call(el, selector);\n}\n\n/**\n * Add class to an element.\n *\n * @param {HTMLElement} element\n * @param {String} className\n */\nfunction addClass(element, className) {\n  if (!className) return;\n\n  if (element.classList) {\n    element.classList.add(className);\n  } else {\n    if (!elementMatches(element, '.' + className)) {\n      element.className += ' ' + className;\n    }\n  }\n}\n\nvar tempArray = [];\nvar numberType = 'number';\n\n/**\n * Insert an item or an array of items to array to a specified index. Mutates\n * the array. The index can be negative in which case the items will be added\n * to the end of the array.\n *\n * @param {Array} array\n * @param {*} items\n * @param {Number} [index=-1]\n */\nfunction arrayInsert(array, items, index) {\n  var startIndex = typeof index === numberType ? index : -1;\n  if (startIndex < 0) startIndex = array.length - startIndex + 1;\n\n  array.splice.apply(array, tempArray.concat(startIndex, 0, items));\n  tempArray.length = 0;\n}\n\n/**\n * Normalize array index. Basically this function makes sure that the provided\n * array index is within the bounds of the provided array and also transforms\n * negative index to the matching positive index. The third (optional) argument\n * allows you to define offset for array's length in case you are adding items\n * to the array or removing items from the array.\n *\n * @param {Array} array\n * @param {Number} index\n * @param {Number} [sizeOffset]\n */\nfunction normalizeArrayIndex(array, index, sizeOffset) {\n  var maxIndex = Math.max(0, array.length - 1 + (sizeOffset || 0));\n  return index > maxIndex ? maxIndex : index < 0 ? Math.max(maxIndex + index + 1, 0) : index;\n}\n\n/**\n * Move array item to another index.\n *\n * @param {Array} array\n * @param {Number} fromIndex\n *   - Index (positive or negative) of the item that will be moved.\n * @param {Number} toIndex\n *   - Index (positive or negative) where the item should be moved to.\n */\nfunction arrayMove(array, fromIndex, toIndex) {\n  // Make sure the array has two or more items.\n  if (array.length < 2) return;\n\n  // Normalize the indices.\n  var from = normalizeArrayIndex(array, fromIndex);\n  var to = normalizeArrayIndex(array, toIndex);\n\n  // Add target item to the new position.\n  if (from !== to) {\n    array.splice(to, 0, array.splice(from, 1)[0]);\n  }\n}\n\n/**\n * Swap array items.\n *\n * @param {Array} array\n * @param {Number} index\n *   - Index (positive or negative) of the item that will be swapped.\n * @param {Number} withIndex\n *   - Index (positive or negative) of the other item that will be swapped.\n */\nfunction arraySwap(array, index, withIndex) {\n  // Make sure the array has two or more items.\n  if (array.length < 2) return;\n\n  // Normalize the indices.\n  var indexA = normalizeArrayIndex(array, index);\n  var indexB = normalizeArrayIndex(array, withIndex);\n  var temp;\n\n  // Swap the items.\n  if (indexA !== indexB) {\n    temp = array[indexA];\n    array[indexA] = array[indexB];\n    array[indexB] = temp;\n  }\n}\n\nvar transformProp = getPrefixedPropName(document.documentElement.style, 'transform') || 'transform';\n\nvar styleNameRegEx = /([A-Z])/g;\nvar prefixRegex = /^(webkit-|moz-|ms-|o-)/;\nvar msPrefixRegex = /^(-m-s-)/;\n\n/**\n * Transforms a camel case style property to kebab case style property. Handles\n * vendor prefixed properties elegantly as well, e.g. \"WebkitTransform\" and\n * \"webkitTransform\" are both transformed into \"-webkit-transform\".\n *\n * @param {String} property\n * @returns {String}\n */\nfunction getStyleName(property) {\n  // Initial slicing, turns \"fooBarProp\" into \"foo-bar-prop\".\n  var styleName = property.replace(styleNameRegEx, '-$1').toLowerCase();\n\n  // Handle properties that start with \"webkit\", \"moz\", \"ms\" or \"o\" prefix (we\n  // need to add an extra '-' to the beginnig).\n  styleName = styleName.replace(prefixRegex, '-$1');\n\n  // Handle properties that start with \"MS\" prefix (we need to transform the\n  // \"-m-s-\" into \"-ms-\").\n  styleName = styleName.replace(msPrefixRegex, '-ms-');\n\n  return styleName;\n}\n\nvar transformStyle = getStyleName(transformProp);\n\nvar transformNone = 'none';\nvar displayInline = 'inline';\nvar displayNone = 'none';\nvar displayStyle = 'display';\n\n/**\n * Returns true if element is transformed, false if not. In practice the\n * element's display value must be anything else than \"none\" or \"inline\" as\n * well as have a valid transform value applied in order to be counted as a\n * transformed element.\n *\n * Borrowed from Mezr (v0.6.1):\n * https://github.com/niklasramo/mezr/blob/0.6.1/mezr.js#L661\n *\n * @param {HTMLElement} element\n * @returns {Boolean}\n */\nfunction isTransformed(element) {\n  var transform = getStyle(element, transformStyle);\n  if (!transform || transform === transformNone) return false;\n\n  var display = getStyle(element, displayStyle);\n  if (display === displayInline || display === displayNone) return false;\n\n  return true;\n}\n\n/**\n * Returns an absolute positioned element's containing block, which is\n * considered to be the closest ancestor element that the target element's\n * positioning is relative to. Disclaimer: this only works as intended for\n * absolute positioned elements.\n *\n * @param {HTMLElement} element\n * @returns {(Document|Element)}\n */\nfunction getContainingBlock(element) {\n  // As long as the containing block is an element, static and not\n  // transformed, try to get the element's parent element and fallback to\n  // document. https://github.com/niklasramo/mezr/blob/0.6.1/mezr.js#L339\n  var doc = document;\n  var res = element || doc;\n  while (res && res !== doc && getStyle(res, 'position') === 'static' && !isTransformed(res)) {\n    res = res.parentElement || doc;\n  }\n  return res;\n}\n\nvar offsetA = {};\nvar offsetB = {};\nvar offsetDiff = {};\n\n/**\n * Returns the element's document offset, which in practice means the vertical\n * and horizontal distance between the element's northwest corner and the\n * document's northwest corner. Note that this function always returns the same\n * object so be sure to read the data from it instead using it as a reference.\n *\n * @param {(Document|Element|Window)} element\n * @param {Object} [offsetData]\n *   - Optional data object where the offset data will be inserted to. If not\n *     provided a new object will be created for the return data.\n * @returns {Object}\n */\nfunction getOffset(element, offsetData) {\n  var offset = offsetData || {};\n  var rect;\n\n  // Set up return data.\n  offset.left = 0;\n  offset.top = 0;\n\n  // Document's offsets are always 0.\n  if (element === document) return offset;\n\n  // Add viewport scroll left/top to the respective offsets.\n  offset.left = window.pageXOffset || 0;\n  offset.top = window.pageYOffset || 0;\n\n  // Window's offsets are the viewport scroll left/top values.\n  if (element.self === window.self) return offset;\n\n  // Add element's client rects to the offsets.\n  rect = element.getBoundingClientRect();\n  offset.left += rect.left;\n  offset.top += rect.top;\n\n  // Exclude element's borders from the offset.\n  offset.left += getStyleAsFloat(element, 'border-left-width');\n  offset.top += getStyleAsFloat(element, 'border-top-width');\n\n  return offset;\n}\n\n/**\n * Calculate the offset difference two elements.\n *\n * @param {HTMLElement} elemA\n * @param {HTMLElement} elemB\n * @param {Boolean} [compareContainingBlocks=false]\n *   - When this is set to true the containing blocks of the provided elements\n *     will be used for calculating the difference. Otherwise the provided\n *     elements will be compared directly.\n * @returns {Object}\n */\nfunction getOffsetDiff(elemA, elemB, compareContainingBlocks) {\n  offsetDiff.left = 0;\n  offsetDiff.top = 0;\n\n  // If elements are same let's return early.\n  if (elemA === elemB) return offsetDiff;\n\n  // Compare containing blocks if necessary.\n  if (compareContainingBlocks) {\n    elemA = getContainingBlock(elemA);\n    elemB = getContainingBlock(elemB);\n\n    // If containing blocks are identical, let's return early.\n    if (elemA === elemB) return offsetDiff;\n  }\n\n  // Finally, let's calculate the offset diff.\n  getOffset(elemA, offsetA);\n  getOffset(elemB, offsetB);\n  offsetDiff.left = offsetB.left - offsetA.left;\n  offsetDiff.top = offsetB.top - offsetA.top;\n\n  return offsetDiff;\n}\n\n/**\n * Check if overflow style value is scrollable.\n *\n * @param {String} value\n * @returns {Boolean}\n */\nfunction isScrollableOverflow(value) {\n  return value === 'auto' || value === 'scroll' || value === 'overlay';\n}\n\n/**\n * Check if an element is scrollable.\n *\n * @param {HTMLElement} element\n * @returns {Boolean}\n */\nfunction isScrollable(element) {\n  return (\n    isScrollableOverflow(getStyle(element, 'overflow')) ||\n    isScrollableOverflow(getStyle(element, 'overflow-x')) ||\n    isScrollableOverflow(getStyle(element, 'overflow-y'))\n  );\n}\n\n/**\n * Collect element's ancestors that are potentially scrollable elements. The\n * provided element is also also included in the check, meaning that if it is\n * scrollable it is added to the result array.\n *\n * @param {HTMLElement} element\n * @param {Array} [result]\n * @returns {Array}\n */\nfunction getScrollableAncestors(element, result) {\n  result = result || [];\n\n  // Find scroll parents.\n  while (element && element !== document) {\n    // If element is inside ShadowDOM let's get it's host node from the real\n    // DOM and continue looping.\n    if (element.getRootNode && element instanceof DocumentFragment) {\n      element = element.getRootNode().host;\n      continue;\n    }\n\n    // If element is scrollable let's add it to the scrollable list.\n    if (isScrollable(element)) {\n      result.push(element);\n    }\n\n    element = element.parentNode;\n  }\n\n  // Always add window to the results.\n  result.push(window);\n\n  return result;\n}\n\nvar translateValue = {};\nvar transformNone$1 = 'none';\nvar rxMat3d = /^matrix3d/;\nvar rxMatTx = /([^,]*,){4}/;\nvar rxMat3dTx = /([^,]*,){12}/;\nvar rxNextItem = /[^,]*,/;\n\n/**\n * Returns the element's computed translateX and translateY values as a floats.\n * The returned object is always the same object and updated every time this\n * function is called.\n *\n * @param {HTMLElement} element\n * @returns {Object}\n */\nfunction getTranslate(element) {\n  translateValue.x = 0;\n  translateValue.y = 0;\n\n  var transform = getStyle(element, transformStyle);\n  if (!transform || transform === transformNone$1) {\n    return translateValue;\n  }\n\n  // Transform style can be in either matrix3d(...) or matrix(...).\n  var isMat3d = rxMat3d.test(transform);\n  var tX = transform.replace(isMat3d ? rxMat3dTx : rxMatTx, '');\n  var tY = tX.replace(rxNextItem, '');\n\n  translateValue.x = parseFloat(tX) || 0;\n  translateValue.y = parseFloat(tY) || 0;\n\n  return translateValue;\n}\n\n/**\n * Remove class from an element.\n *\n * @param {HTMLElement} element\n * @param {String} className\n */\nfunction removeClass(element, className) {\n  if (!className) return;\n\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    if (elementMatches(element, '.' + className)) {\n      element.className = (' ' + element.className + ' ')\n        .replace(' ' + className + ' ', ' ')\n        .trim();\n    }\n  }\n}\n\nvar IS_IOS =\n  /^(iPad|iPhone|iPod)/.test(window.navigator.platform) ||\n  (/^Mac/.test(window.navigator.platform) && window.navigator.maxTouchPoints > 1);\nvar START_PREDICATE_INACTIVE = 0;\nvar START_PREDICATE_PENDING = 1;\nvar START_PREDICATE_RESOLVED = 2;\nvar SCROLL_LISTENER_OPTIONS = hasPassiveEvents() ? { passive: true } : false;\n\n/**\n * Bind touch interaction to an item.\n *\n * @class\n * @param {Item} item\n */\nfunction ItemDrag(item) {\n  var element = item._element;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n\n  this._item = item;\n  this._gridId = grid._id;\n  this._isDestroyed = false;\n  this._isMigrating = false;\n\n  // Start predicate data.\n  this._startPredicate = isFunction(settings.dragStartPredicate)\n    ? settings.dragStartPredicate\n    : ItemDrag.defaultStartPredicate;\n  this._startPredicateState = START_PREDICATE_INACTIVE;\n  this._startPredicateResult = undefined;\n\n  // Data for drag sort predicate heuristics.\n  this._isSortNeeded = false;\n  this._sortTimer = undefined;\n  this._blockedSortIndex = null;\n  this._sortX1 = 0;\n  this._sortX2 = 0;\n  this._sortY1 = 0;\n  this._sortY2 = 0;\n\n  // Setup item's initial drag data.\n  this._reset();\n\n  // Bind the methods that needs binding.\n  this._preStartCheck = this._preStartCheck.bind(this);\n  this._preEndCheck = this._preEndCheck.bind(this);\n  this._onScroll = this._onScroll.bind(this);\n  this._prepareStart = this._prepareStart.bind(this);\n  this._applyStart = this._applyStart.bind(this);\n  this._prepareMove = this._prepareMove.bind(this);\n  this._applyMove = this._applyMove.bind(this);\n  this._prepareScroll = this._prepareScroll.bind(this);\n  this._applyScroll = this._applyScroll.bind(this);\n  this._handleSort = this._handleSort.bind(this);\n  this._handleSortDelayed = this._handleSortDelayed.bind(this);\n\n  // Get drag handle element.\n  this._handle = (settings.dragHandle && element.querySelector(settings.dragHandle)) || element;\n\n  // Init dragger.\n  this._dragger = new Dragger(this._handle, settings.dragCssProps);\n  this._dragger.on('start', this._preStartCheck);\n  this._dragger.on('move', this._preStartCheck);\n  this._dragger.on('cancel', this._preEndCheck);\n  this._dragger.on('end', this._preEndCheck);\n}\n\n/**\n * Public properties\n * *****************\n */\n\n/**\n * @public\n * @static\n * @type {AutoScroller}\n */\nItemDrag.autoScroller = new AutoScroller();\n\n/**\n * Public static methods\n * *********************\n */\n\n/**\n * Default drag start predicate handler that handles anchor elements\n * gracefully. The return value of this function defines if the drag is\n * started, rejected or pending. When true is returned the dragging is started\n * and when false is returned the dragging is rejected. If nothing is returned\n * the predicate will be called again on the next drag movement.\n *\n * @public\n * @static\n * @param {Item} item\n * @param {Object} event\n * @param {Object} [options]\n *   - An optional options object which can be used to pass the predicate\n *     it's options manually. By default the predicate retrieves the options\n *     from the grid's settings.\n * @returns {(Boolean|undefined)}\n */\nItemDrag.defaultStartPredicate = function (item, event, options) {\n  var drag = item._drag;\n\n  // Make sure left button is pressed on mouse.\n  if (event.isFirst && event.srcEvent.button) {\n    return false;\n  }\n\n  // If the start event is trusted, non-cancelable and it's default action has\n  // not been prevented it is in most cases a sign that the gesture would be\n  // cancelled anyways right after it has started (e.g. starting drag while\n  // the page is scrolling).\n  if (\n    !IS_IOS &&\n    event.isFirst &&\n    event.srcEvent.isTrusted === true &&\n    event.srcEvent.defaultPrevented === false &&\n    event.srcEvent.cancelable === false\n  ) {\n    return false;\n  }\n\n  // Final event logic. At this stage return value does not matter anymore,\n  // the predicate is either resolved or it's not and there's nothing to do\n  // about it. Here we just reset data and if the item element is a link\n  // we follow it (if there has only been slight movement).\n  if (event.isFinal) {\n    drag._finishStartPredicate(event);\n    return;\n  }\n\n  // Setup predicate data from options if not already set.\n  var predicate = drag._startPredicateData;\n  if (!predicate) {\n    var config = options || drag._getGrid()._settings.dragStartPredicate || {};\n    drag._startPredicateData = predicate = {\n      distance: Math.max(config.distance, 0) || 0,\n      delay: Math.max(config.delay, 0) || 0,\n    };\n  }\n\n  // If delay is defined let's keep track of the latest event and initiate\n  // delay if it has not been done yet.\n  if (predicate.delay) {\n    predicate.event = event;\n    if (!predicate.delayTimer) {\n      predicate.delayTimer = window.setTimeout(function () {\n        predicate.delay = 0;\n        if (drag._resolveStartPredicate(predicate.event)) {\n          drag._forceResolveStartPredicate(predicate.event);\n          drag._resetStartPredicate();\n        }\n      }, predicate.delay);\n    }\n  }\n\n  return drag._resolveStartPredicate(event);\n};\n\n/**\n * Default drag sort predicate.\n *\n * @public\n * @static\n * @param {Item} item\n * @param {Object} [options]\n * @param {Number} [options.threshold=50]\n * @param {String} [options.action='move']\n * @returns {?Object}\n *   - Returns `null` if no valid index was found. Otherwise returns drag sort\n *     command.\n */\nItemDrag.defaultSortPredicate = (function () {\n  var itemRect = {};\n  var targetRect = {};\n  var returnData = {};\n  var gridsArray = [];\n  var minThreshold = 1;\n  var maxThreshold = 100;\n\n  function getTargetGrid(item, rootGrid, threshold) {\n    var target = null;\n    var dragSort = rootGrid._settings.dragSort;\n    var bestScore = -1;\n    var gridScore;\n    var grids;\n    var grid;\n    var container;\n    var containerRect;\n    var left;\n    var top;\n    var right;\n    var bottom;\n    var i;\n\n    // Get potential target grids.\n    if (dragSort === true) {\n      gridsArray[0] = rootGrid;\n      grids = gridsArray;\n    } else if (isFunction(dragSort)) {\n      grids = dragSort.call(rootGrid, item);\n    }\n\n    // Return immediately if there are no grids.\n    if (!grids || !Array.isArray(grids) || !grids.length) {\n      return target;\n    }\n\n    // Loop through the grids and get the best match.\n    for (i = 0; i < grids.length; i++) {\n      grid = grids[i];\n\n      // Filter out all destroyed grids.\n      if (grid._isDestroyed) continue;\n\n      // Compute the grid's client rect an clamp the initial boundaries to\n      // viewport dimensions.\n      grid._updateBoundingRect();\n      left = Math.max(0, grid._left);\n      top = Math.max(0, grid._top);\n      right = Math.min(window.innerWidth, grid._right);\n      bottom = Math.min(window.innerHeight, grid._bottom);\n\n      // The grid might be inside one or more elements that clip it's visibility\n      // (e.g overflow scroll/hidden) so we want to find out the visible portion\n      // of the grid in the viewport and use that in our calculations.\n      container = grid._element.parentNode;\n      while (\n        container &&\n        container !== document &&\n        container !== document.documentElement &&\n        container !== document.body\n      ) {\n        if (container.getRootNode && container instanceof DocumentFragment) {\n          container = container.getRootNode().host;\n          continue;\n        }\n\n        if (getStyle(container, 'overflow') !== 'visible') {\n          containerRect = container.getBoundingClientRect();\n          left = Math.max(left, containerRect.left);\n          top = Math.max(top, containerRect.top);\n          right = Math.min(right, containerRect.right);\n          bottom = Math.min(bottom, containerRect.bottom);\n        }\n\n        if (getStyle(container, 'position') === 'fixed') {\n          break;\n        }\n\n        container = container.parentNode;\n      }\n\n      // No need to go further if target rect does not have visible area.\n      if (left >= right || top >= bottom) continue;\n\n      // Check how much dragged element overlaps the container element.\n      targetRect.left = left;\n      targetRect.top = top;\n      targetRect.width = right - left;\n      targetRect.height = bottom - top;\n      gridScore = getIntersectionScore(itemRect, targetRect);\n\n      // Check if this grid is the best match so far.\n      if (gridScore > threshold && gridScore > bestScore) {\n        bestScore = gridScore;\n        target = grid;\n      }\n    }\n\n    // Always reset grids array.\n    gridsArray.length = 0;\n\n    return target;\n  }\n\n  return function (item, options) {\n    var drag = item._drag;\n    var rootGrid = drag._getGrid();\n\n    // Get drag sort predicate settings.\n    var sortThreshold = options && typeof options.threshold === 'number' ? options.threshold : 50;\n    var sortAction = options && options.action === ACTION_SWAP ? ACTION_SWAP : ACTION_MOVE;\n    var migrateAction =\n      options && options.migrateAction === ACTION_SWAP ? ACTION_SWAP : ACTION_MOVE;\n\n    // Sort threshold must be a positive number capped to a max value of 100. If\n    // that's not the case this function will not work correctly. So let's clamp\n    // the threshold just in case.\n    sortThreshold = Math.min(Math.max(sortThreshold, minThreshold), maxThreshold);\n\n    // Populate item rect data.\n    itemRect.width = item._width;\n    itemRect.height = item._height;\n    itemRect.left = drag._clientX;\n    itemRect.top = drag._clientY;\n\n    // Calculate the target grid.\n    var grid = getTargetGrid(item, rootGrid, sortThreshold);\n\n    // Return early if we found no grid container element that overlaps the\n    // dragged item enough.\n    if (!grid) return null;\n\n    var isMigration = item.getGrid() !== grid;\n    var gridOffsetLeft = 0;\n    var gridOffsetTop = 0;\n    var matchScore = 0;\n    var matchIndex = -1;\n    var hasValidTargets = false;\n    var target;\n    var score;\n    var i;\n\n    // If item is moved within it's originating grid adjust item's left and\n    // top props. Otherwise if item is moved to/within another grid get the\n    // container element's offset (from the element's content edge).\n    if (grid === rootGrid) {\n      itemRect.left = drag._gridX + item._marginLeft;\n      itemRect.top = drag._gridY + item._marginTop;\n    } else {\n      grid._updateBorders(1, 0, 1, 0);\n      gridOffsetLeft = grid._left + grid._borderLeft;\n      gridOffsetTop = grid._top + grid._borderTop;\n    }\n\n    // Loop through the target grid items and try to find the best match.\n    for (i = 0; i < grid._items.length; i++) {\n      target = grid._items[i];\n\n      // If the target item is not active or the target item is the dragged\n      // item let's skip to the next item.\n      if (!target._isActive || target === item) {\n        continue;\n      }\n\n      // Mark the grid as having valid target items.\n      hasValidTargets = true;\n\n      // Calculate the target's overlap score with the dragged item.\n      targetRect.width = target._width;\n      targetRect.height = target._height;\n      targetRect.left = target._left + target._marginLeft + gridOffsetLeft;\n      targetRect.top = target._top + target._marginTop + gridOffsetTop;\n      score = getIntersectionScore(itemRect, targetRect);\n\n      // Update best match index and score if the target's overlap score with\n      // the dragged item is higher than the current best match score.\n      if (score > matchScore) {\n        matchIndex = i;\n        matchScore = score;\n      }\n    }\n\n    // If there is no valid match and the dragged item is being moved into\n    // another grid we need to do some guess work here. If there simply are no\n    // valid targets (which means that the dragged item will be the only active\n    // item in the new grid) we can just add it as the first item. If we have\n    // valid items in the new grid and the dragged item is overlapping one or\n    // more of the items in the new grid let's make an exception with the\n    // threshold and just pick the item which the dragged item is overlapping\n    // most. However, if the dragged item is not overlapping any of the valid\n    // items in the new grid let's position it as the last item in the grid.\n    if (isMigration && matchScore < sortThreshold) {\n      matchIndex = hasValidTargets ? matchIndex : 0;\n      matchScore = sortThreshold;\n    }\n\n    // Check if the best match overlaps enough to justify a placement switch.\n    if (matchScore >= sortThreshold) {\n      returnData.grid = grid;\n      returnData.index = matchIndex;\n      returnData.action = isMigration ? migrateAction : sortAction;\n      return returnData;\n    }\n\n    return null;\n  };\n})();\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Abort dragging and reset drag data.\n *\n * @public\n */\nItemDrag.prototype.stop = function () {\n  if (!this._isActive) return;\n\n  // If the item is being dropped into another grid, finish it up and return\n  // immediately.\n  if (this._isMigrating) {\n    this._finishMigration();\n    return;\n  }\n\n  // Stop auto-scroll.\n  ItemDrag.autoScroller.removeItem(this._item);\n\n  // Cancel queued ticks.\n  var itemId = this._item._id;\n  cancelDragStartTick(itemId);\n  cancelDragMoveTick(itemId);\n  cancelDragScrollTick(itemId);\n\n  // Cancel sort procedure.\n  this._cancelSort();\n\n  if (this._isStarted) {\n    // Remove scroll listeners.\n    this._unbindScrollListeners();\n\n    var element = item._element;\n    var grid = this._getGrid();\n    var draggingClass = grid._settings.itemDraggingClass;\n\n    // Append item element to the container if it's not it's child. Also make\n    // sure the translate values are adjusted to account for the DOM shift.\n    if (element.parentNode !== grid._element) {\n      grid._element.appendChild(element);\n      item._setTranslate(this._gridX, this._gridY);\n\n      // We need to do forced reflow to make sure the dragging class is removed\n      // gracefully.\n      // eslint-disable-next-line\n      if (draggingClass) element.clientWidth;\n    }\n\n    // Remove dragging class.\n    removeClass(element, draggingClass);\n  }\n\n  // Reset drag data.\n  this._reset();\n};\n\n/**\n * Manually trigger drag sort. This is only needed for special edge cases where\n * e.g. you have disabled sort and want to trigger a sort right after enabling\n * it (and don't want to wait for the next move/scroll event).\n *\n * @private\n * @param {Boolean} [force=false]\n */\nItemDrag.prototype.sort = function (force) {\n  var item = this._item;\n  if (this._isActive && item._isActive && this._dragMoveEvent) {\n    if (force === true) {\n      this._handleSort();\n    } else {\n      addDragSortTick(item._id, this._handleSort);\n    }\n  }\n};\n\n/**\n * Destroy instance.\n *\n * @public\n */\nItemDrag.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n  this.stop();\n  this._dragger.destroy();\n  ItemDrag.autoScroller.removeItem(this._item);\n  this._isDestroyed = true;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Get Grid instance.\n *\n * @private\n * @returns {?Grid}\n */\nItemDrag.prototype._getGrid = function () {\n  return GRID_INSTANCES[this._gridId] || null;\n};\n\n/**\n * Setup/reset drag data.\n *\n * @private\n */\nItemDrag.prototype._reset = function () {\n  this._isActive = false;\n  this._isStarted = false;\n\n  // The dragged item's container element.\n  this._container = null;\n\n  // The dragged item's containing block.\n  this._containingBlock = null;\n\n  // Drag/scroll event data.\n  this._dragStartEvent = null;\n  this._dragMoveEvent = null;\n  this._dragPrevMoveEvent = null;\n  this._scrollEvent = null;\n\n  // All the elements which need to be listened for scroll events during\n  // dragging.\n  this._scrollers = [];\n\n  // The current translateX/translateY position.\n  this._left = 0;\n  this._top = 0;\n\n  // Dragged element's current position within the grid.\n  this._gridX = 0;\n  this._gridY = 0;\n\n  // Dragged element's current offset from window's northwest corner. Does\n  // not account for element's margins.\n  this._clientX = 0;\n  this._clientY = 0;\n\n  // Keep track of the clientX/Y diff for scrolling.\n  this._scrollDiffX = 0;\n  this._scrollDiffY = 0;\n\n  // Keep track of the clientX/Y diff for moving.\n  this._moveDiffX = 0;\n  this._moveDiffY = 0;\n\n  // Offset difference between the dragged element's temporary drag\n  // container and it's original container.\n  this._containerDiffX = 0;\n  this._containerDiffY = 0;\n};\n\n/**\n * Bind drag scroll handlers to all scrollable ancestor elements of the\n * dragged element and the drag container element.\n *\n * @private\n */\nItemDrag.prototype._bindScrollListeners = function () {\n  var gridContainer = this._getGrid()._element;\n  var dragContainer = this._container;\n  var scrollers = this._scrollers;\n  var gridScrollers;\n  var i;\n\n  // Get dragged element's scrolling parents.\n  scrollers.length = 0;\n  getScrollableAncestors(this._item._element.parentNode, scrollers);\n\n  // If drag container is defined and it's not the same element as grid\n  // container then we need to add the grid container and it's scroll parents\n  // to the elements which are going to be listener for scroll events.\n  if (dragContainer !== gridContainer) {\n    gridScrollers = [];\n    getScrollableAncestors(gridContainer, gridScrollers);\n    for (i = 0; i < gridScrollers.length; i++) {\n      if (scrollers.indexOf(gridScrollers[i]) < 0) {\n        scrollers.push(gridScrollers[i]);\n      }\n    }\n  }\n\n  // Bind scroll listeners.\n  for (i = 0; i < scrollers.length; i++) {\n    scrollers[i].addEventListener('scroll', this._onScroll, SCROLL_LISTENER_OPTIONS);\n  }\n};\n\n/**\n * Unbind currently bound drag scroll handlers from all scrollable ancestor\n * elements of the dragged element and the drag container element.\n *\n * @private\n */\nItemDrag.prototype._unbindScrollListeners = function () {\n  var scrollers = this._scrollers;\n  var i;\n\n  for (i = 0; i < scrollers.length; i++) {\n    scrollers[i].removeEventListener('scroll', this._onScroll, SCROLL_LISTENER_OPTIONS);\n  }\n\n  scrollers.length = 0;\n};\n\n/**\n * Unbind currently bound drag scroll handlers from all scrollable ancestor\n * elements of the dragged element and the drag container element.\n *\n * @private\n * @param {Object} event\n * @returns {Boolean}\n */\nItemDrag.prototype._resolveStartPredicate = function (event) {\n  var predicate = this._startPredicateData;\n  if (event.distance < predicate.distance || predicate.delay) return;\n  this._resetStartPredicate();\n  return true;\n};\n\n/**\n * Forcefully resolve drag start predicate.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._forceResolveStartPredicate = function (event) {\n  if (!this._isDestroyed && this._startPredicateState === START_PREDICATE_PENDING) {\n    this._startPredicateState = START_PREDICATE_RESOLVED;\n    this._onStart(event);\n  }\n};\n\n/**\n * Finalize start predicate.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._finishStartPredicate = function (event) {\n  var element = this._item._element;\n\n  // Check if this is a click (very subjective heuristics).\n  var isClick = Math.abs(event.deltaX) < 2 && Math.abs(event.deltaY) < 2 && event.deltaTime < 200;\n\n  // Reset predicate.\n  this._resetStartPredicate();\n\n  // If the gesture can be interpreted as click let's try to open the element's\n  // href url (if it is an anchor element).\n  if (isClick) openAnchorHref(element);\n};\n\n/**\n * Reset drag sort heuristics.\n *\n * @private\n * @param {Number} x\n * @param {Number} y\n */\nItemDrag.prototype._resetHeuristics = function (x, y) {\n  this._blockedSortIndex = null;\n  this._sortX1 = this._sortX2 = x;\n  this._sortY1 = this._sortY2 = y;\n};\n\n/**\n * Run heuristics and return true if overlap check can be performed, and false\n * if it can not.\n *\n * @private\n * @param {Number} x\n * @param {Number} y\n * @returns {Boolean}\n */\nItemDrag.prototype._checkHeuristics = function (x, y) {\n  var settings = this._getGrid()._settings.dragSortHeuristics;\n  var minDist = settings.minDragDistance;\n\n  // Skip heuristics if not needed.\n  if (minDist <= 0) {\n    this._blockedSortIndex = null;\n    return true;\n  }\n\n  var diffX = x - this._sortX2;\n  var diffY = y - this._sortY2;\n\n  // If we can't do proper bounce back check make sure that the blocked index\n  // is not set.\n  var canCheckBounceBack = minDist > 3 && settings.minBounceBackAngle > 0;\n  if (!canCheckBounceBack) {\n    this._blockedSortIndex = null;\n  }\n\n  if (Math.abs(diffX) > minDist || Math.abs(diffY) > minDist) {\n    // Reset blocked index if angle changed enough. This check requires a\n    // minimum value of 3 for minDragDistance to function properly.\n    if (canCheckBounceBack) {\n      var angle = Math.atan2(diffX, diffY);\n      var prevAngle = Math.atan2(this._sortX2 - this._sortX1, this._sortY2 - this._sortY1);\n      var deltaAngle = Math.atan2(Math.sin(angle - prevAngle), Math.cos(angle - prevAngle));\n      if (Math.abs(deltaAngle) > settings.minBounceBackAngle) {\n        this._blockedSortIndex = null;\n      }\n    }\n\n    // Update points.\n    this._sortX1 = this._sortX2;\n    this._sortY1 = this._sortY2;\n    this._sortX2 = x;\n    this._sortY2 = y;\n\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * Reset for default drag start predicate function.\n *\n * @private\n */\nItemDrag.prototype._resetStartPredicate = function () {\n  var predicate = this._startPredicateData;\n  if (predicate) {\n    if (predicate.delayTimer) {\n      predicate.delayTimer = window.clearTimeout(predicate.delayTimer);\n    }\n    this._startPredicateData = null;\n  }\n};\n\n/**\n * Handle the sorting procedure. Manage drag sort heuristics/interval and\n * check overlap when necessary.\n *\n * @private\n */\nItemDrag.prototype._handleSort = function () {\n  if (!this._isActive) return;\n\n  var settings = this._getGrid()._settings;\n\n  // No sorting when drag sort is disabled. Also, account for the scenario where\n  // dragSort is temporarily disabled during drag procedure so we need to reset\n  // sort timer heuristics state too.\n  if (\n    !settings.dragSort ||\n    (!settings.dragAutoScroll.sortDuringScroll && ItemDrag.autoScroller.isItemScrolling(this._item))\n  ) {\n    this._sortX1 = this._sortX2 = this._gridX;\n    this._sortY1 = this._sortY2 = this._gridY;\n    // We set this to true intentionally so that overlap check would be\n    // triggered as soon as possible after sort becomes enabled again.\n    this._isSortNeeded = true;\n    if (this._sortTimer !== undefined) {\n      this._sortTimer = window.clearTimeout(this._sortTimer);\n    }\n    return;\n  }\n\n  // If sorting is enabled we always need to run the heuristics check to keep\n  // the tracked coordinates updated. We also allow an exception when the sort\n  // timer is finished because the heuristics are intended to prevent overlap\n  // checks based on the dragged element's immediate movement and a delayed\n  // overlap check is valid if it comes through, because it was valid when it\n  // was invoked.\n  var shouldSort = this._checkHeuristics(this._gridX, this._gridY);\n  if (!this._isSortNeeded && !shouldSort) return;\n\n  var sortInterval = settings.dragSortHeuristics.sortInterval;\n  if (sortInterval <= 0 || this._isSortNeeded) {\n    this._isSortNeeded = false;\n    if (this._sortTimer !== undefined) {\n      this._sortTimer = window.clearTimeout(this._sortTimer);\n    }\n    this._checkOverlap();\n  } else if (this._sortTimer === undefined) {\n    this._sortTimer = window.setTimeout(this._handleSortDelayed, sortInterval);\n  }\n};\n\n/**\n * Delayed sort handler.\n *\n * @private\n */\nItemDrag.prototype._handleSortDelayed = function () {\n  this._isSortNeeded = true;\n  this._sortTimer = undefined;\n  addDragSortTick(this._item._id, this._handleSort);\n};\n\n/**\n * Cancel and reset sort procedure.\n *\n * @private\n */\nItemDrag.prototype._cancelSort = function () {\n  this._isSortNeeded = false;\n  if (this._sortTimer !== undefined) {\n    this._sortTimer = window.clearTimeout(this._sortTimer);\n  }\n  cancelDragSortTick(this._item._id);\n};\n\n/**\n * Handle the ending of the drag procedure for sorting.\n *\n * @private\n */\nItemDrag.prototype._finishSort = function () {\n  var isSortEnabled = this._getGrid()._settings.dragSort;\n  var needsFinalCheck = isSortEnabled && (this._isSortNeeded || this._sortTimer !== undefined);\n  this._cancelSort();\n  if (needsFinalCheck) this._checkOverlap();\n};\n\n/**\n * Check (during drag) if an item is overlapping other items and based on\n * the configuration layout the items.\n *\n * @private\n */\nItemDrag.prototype._checkOverlap = function () {\n  if (!this._isActive) return;\n\n  var item = this._item;\n  var settings = this._getGrid()._settings;\n  var result;\n  var currentGrid;\n  var currentIndex;\n  var targetGrid;\n  var targetIndex;\n  var targetItem;\n  var sortAction;\n  var isMigration;\n\n  // Get overlap check result.\n  if (isFunction(settings.dragSortPredicate)) {\n    result = settings.dragSortPredicate(item, this._dragMoveEvent);\n  } else {\n    result = ItemDrag.defaultSortPredicate(item, settings.dragSortPredicate);\n  }\n\n  // Let's make sure the result object has a valid index before going further.\n  if (!result || typeof result.index !== 'number') return;\n\n  sortAction = result.action === ACTION_SWAP ? ACTION_SWAP : ACTION_MOVE;\n  currentGrid = item.getGrid();\n  targetGrid = result.grid || currentGrid;\n  isMigration = currentGrid !== targetGrid;\n  currentIndex = currentGrid._items.indexOf(item);\n  targetIndex = normalizeArrayIndex(\n    targetGrid._items,\n    result.index,\n    isMigration && sortAction === ACTION_MOVE ? 1 : 0\n  );\n\n  // Prevent position bounce.\n  if (!isMigration && targetIndex === this._blockedSortIndex) {\n    return;\n  }\n\n  // If the item was moved within it's current grid.\n  if (!isMigration) {\n    // Make sure the target index is not the current index.\n    if (currentIndex !== targetIndex) {\n      this._blockedSortIndex = currentIndex;\n\n      // Do the sort.\n      (sortAction === ACTION_SWAP ? arraySwap : arrayMove)(\n        currentGrid._items,\n        currentIndex,\n        targetIndex\n      );\n\n      // Emit move event.\n      if (currentGrid._hasListeners(EVENT_MOVE)) {\n        currentGrid._emit(EVENT_MOVE, {\n          item: item,\n          fromIndex: currentIndex,\n          toIndex: targetIndex,\n          action: sortAction,\n        });\n      }\n\n      // Layout the grid.\n      currentGrid.layout();\n    }\n  }\n\n  // If the item was moved to another grid.\n  else {\n    this._blockedSortIndex = null;\n\n    // Let's fetch the target item when it's still in it's original index.\n    targetItem = targetGrid._items[targetIndex];\n\n    // Emit beforeSend event.\n    if (currentGrid._hasListeners(EVENT_BEFORE_SEND)) {\n      currentGrid._emit(EVENT_BEFORE_SEND, {\n        item: item,\n        fromGrid: currentGrid,\n        fromIndex: currentIndex,\n        toGrid: targetGrid,\n        toIndex: targetIndex,\n      });\n    }\n\n    // Emit beforeReceive event.\n    if (targetGrid._hasListeners(EVENT_BEFORE_RECEIVE)) {\n      targetGrid._emit(EVENT_BEFORE_RECEIVE, {\n        item: item,\n        fromGrid: currentGrid,\n        fromIndex: currentIndex,\n        toGrid: targetGrid,\n        toIndex: targetIndex,\n      });\n    }\n\n    // Update item's grid id reference.\n    item._gridId = targetGrid._id;\n\n    // Update drag instance's migrating indicator.\n    this._isMigrating = item._gridId !== this._gridId;\n\n    // Move item instance from current grid to target grid.\n    currentGrid._items.splice(currentIndex, 1);\n    arrayInsert(targetGrid._items, item, targetIndex);\n\n    // Reset sort data.\n    item._sortData = null;\n\n    // Emit send event.\n    if (currentGrid._hasListeners(EVENT_SEND)) {\n      currentGrid._emit(EVENT_SEND, {\n        item: item,\n        fromGrid: currentGrid,\n        fromIndex: currentIndex,\n        toGrid: targetGrid,\n        toIndex: targetIndex,\n      });\n    }\n\n    // Emit receive event.\n    if (targetGrid._hasListeners(EVENT_RECEIVE)) {\n      targetGrid._emit(EVENT_RECEIVE, {\n        item: item,\n        fromGrid: currentGrid,\n        fromIndex: currentIndex,\n        toGrid: targetGrid,\n        toIndex: targetIndex,\n      });\n    }\n\n    // If the sort action is \"swap\" let's respect it and send the target item\n    // (if it exists) from the target grid to the originating grid. This process\n    // is done on purpose after the dragged item placed within the target grid\n    // so that we can keep this implementation as simple as possible utilizing\n    // the existing API.\n    if (sortAction === ACTION_SWAP && targetItem && targetItem.isActive()) {\n      // Sanity check to make sure that the target item is still part of the\n      // target grid. It could have been manipulated in the event handlers.\n      if (targetGrid._items.indexOf(targetItem) > -1) {\n        targetGrid.send(targetItem, currentGrid, currentIndex, {\n          appendTo: this._container || document.body,\n          layoutSender: false,\n          layoutReceiver: false,\n        });\n      }\n    }\n\n    // Layout both grids.\n    currentGrid.layout();\n    targetGrid.layout();\n  }\n};\n\n/**\n * If item is dragged into another grid, finish the migration process\n * gracefully.\n *\n * @private\n */\nItemDrag.prototype._finishMigration = function () {\n  var item = this._item;\n  var release = item._dragRelease;\n  var element = item._element;\n  var isActive = item._isActive;\n  var targetGrid = item.getGrid();\n  var targetGridElement = targetGrid._element;\n  var targetSettings = targetGrid._settings;\n  var targetContainer = targetSettings.dragContainer || targetGridElement;\n  var currentSettings = this._getGrid()._settings;\n  var currentContainer = element.parentNode;\n  var currentVisClass = isActive\n    ? currentSettings.itemVisibleClass\n    : currentSettings.itemHiddenClass;\n  var nextVisClass = isActive ? targetSettings.itemVisibleClass : targetSettings.itemHiddenClass;\n  var translate;\n  var offsetDiff;\n\n  // Destroy current drag. Note that we need to set the migrating flag to\n  // false first, because otherwise we create an infinite loop between this\n  // and the drag.stop() method.\n  this._isMigrating = false;\n  this.destroy();\n\n  // Update item class.\n  if (currentSettings.itemClass !== targetSettings.itemClass) {\n    removeClass(element, currentSettings.itemClass);\n    addClass(element, targetSettings.itemClass);\n  }\n\n  // Update visibility class.\n  if (currentVisClass !== nextVisClass) {\n    removeClass(element, currentVisClass);\n    addClass(element, nextVisClass);\n  }\n\n  // Move the item inside the target container if it's different than the\n  // current container.\n  if (targetContainer !== currentContainer) {\n    targetContainer.appendChild(element);\n    offsetDiff = getOffsetDiff(currentContainer, targetContainer, true);\n    translate = getTranslate(element);\n    translate.x -= offsetDiff.left;\n    translate.y -= offsetDiff.top;\n  }\n\n  // Update item's cached dimensions.\n  item._refreshDimensions();\n\n  // Calculate the offset difference between target's drag container (if any)\n  // and actual grid container element. We save it later for the release\n  // process.\n  offsetDiff = getOffsetDiff(targetContainer, targetGridElement, true);\n  release._containerDiffX = offsetDiff.left;\n  release._containerDiffY = offsetDiff.top;\n\n  // Recreate item's drag handler.\n  item._drag = targetSettings.dragEnabled ? new ItemDrag(item) : null;\n\n  // Adjust the position of the item element if it was moved from a container\n  // to another.\n  if (targetContainer !== currentContainer) {\n    item._setTranslate(translate.x, translate.y);\n  }\n\n  // Update child element's styles to reflect the current visibility state.\n  item._visibility.setStyles(isActive ? targetSettings.visibleStyles : targetSettings.hiddenStyles);\n\n  // Start the release.\n  release.start();\n};\n\n/**\n * Drag pre-start handler.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._preStartCheck = function (event) {\n  // Let's activate drag start predicate state.\n  if (this._startPredicateState === START_PREDICATE_INACTIVE) {\n    this._startPredicateState = START_PREDICATE_PENDING;\n  }\n\n  // If predicate is pending try to resolve it.\n  if (this._startPredicateState === START_PREDICATE_PENDING) {\n    this._startPredicateResult = this._startPredicate(this._item, event);\n    if (this._startPredicateResult === true) {\n      this._startPredicateState = START_PREDICATE_RESOLVED;\n      this._onStart(event);\n    } else if (this._startPredicateResult === false) {\n      this._resetStartPredicate(event);\n      this._dragger._reset();\n      this._startPredicateState = START_PREDICATE_INACTIVE;\n    }\n  }\n\n  // Otherwise if predicate is resolved and drag is active, move the item.\n  else if (this._startPredicateState === START_PREDICATE_RESOLVED && this._isActive) {\n    this._onMove(event);\n  }\n};\n\n/**\n * Drag pre-end handler.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._preEndCheck = function (event) {\n  var isResolved = this._startPredicateState === START_PREDICATE_RESOLVED;\n\n  // Do final predicate check to allow user to unbind stuff for the current\n  // drag procedure within the predicate callback. The return value of this\n  // check will have no effect to the state of the predicate.\n  this._startPredicate(this._item, event);\n\n  this._startPredicateState = START_PREDICATE_INACTIVE;\n\n  if (!isResolved || !this._isActive) return;\n\n  if (this._isStarted) {\n    this._onEnd(event);\n  } else {\n    this.stop();\n  }\n};\n\n/**\n * Drag start handler.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._onStart = function (event) {\n  var item = this._item;\n  if (!item._isActive) return;\n\n  this._isActive = true;\n  this._dragStartEvent = event;\n  ItemDrag.autoScroller.addItem(item);\n\n  addDragStartTick(item._id, this._prepareStart, this._applyStart);\n};\n\n/**\n * Prepare item to be dragged.\n *\n * @private\n *  ItemDrag.prototype\n */\nItemDrag.prototype._prepareStart = function () {\n  if (!this._isActive) return;\n\n  var item = this._item;\n  if (!item._isActive) return;\n\n  var element = item._element;\n  var grid = this._getGrid();\n  var settings = grid._settings;\n  var gridContainer = grid._element;\n  var dragContainer = settings.dragContainer || gridContainer;\n  var containingBlock = getContainingBlock(dragContainer);\n  var translate = getTranslate(element);\n  var elementRect = element.getBoundingClientRect();\n  var hasDragContainer = dragContainer !== gridContainer;\n\n  this._container = dragContainer;\n  this._containingBlock = containingBlock;\n  this._clientX = elementRect.left;\n  this._clientY = elementRect.top;\n  this._left = this._gridX = translate.x;\n  this._top = this._gridY = translate.y;\n  this._scrollDiffX = this._scrollDiffY = 0;\n  this._moveDiffX = this._moveDiffY = 0;\n\n  this._resetHeuristics(this._gridX, this._gridY);\n\n  // If a specific drag container is set and it is different from the\n  // grid's container element we store the offset between containers.\n  if (hasDragContainer) {\n    var offsetDiff = getOffsetDiff(containingBlock, gridContainer);\n    this._containerDiffX = offsetDiff.left;\n    this._containerDiffY = offsetDiff.top;\n  }\n};\n\n/**\n * Start drag for the item.\n *\n * @private\n */\nItemDrag.prototype._applyStart = function () {\n  if (!this._isActive) return;\n\n  var item = this._item;\n  if (!item._isActive) return;\n\n  var grid = this._getGrid();\n  var element = item._element;\n  var release = item._dragRelease;\n  var migrate = item._migrate;\n  var hasDragContainer = this._container !== grid._element;\n\n  if (item.isPositioning()) {\n    item._layout.stop(true, this._left, this._top);\n  }\n\n  if (migrate._isActive) {\n    this._left -= migrate._containerDiffX;\n    this._top -= migrate._containerDiffY;\n    this._gridX -= migrate._containerDiffX;\n    this._gridY -= migrate._containerDiffY;\n    migrate.stop(true, this._left, this._top);\n  }\n\n  if (item.isReleasing()) {\n    release._reset();\n  }\n\n  if (grid._settings.dragPlaceholder.enabled) {\n    item._dragPlaceholder.create();\n  }\n\n  this._isStarted = true;\n\n  grid._emit(EVENT_DRAG_INIT, item, this._dragStartEvent);\n\n  if (hasDragContainer) {\n    // If the dragged element is a child of the drag container all we need to\n    // do is setup the relative drag position data.\n    if (element.parentNode === this._container) {\n      this._gridX -= this._containerDiffX;\n      this._gridY -= this._containerDiffY;\n    }\n    // Otherwise we need to append the element inside the correct container,\n    // setup the actual drag position data and adjust the element's translate\n    // values to account for the DOM position shift.\n    else {\n      this._left += this._containerDiffX;\n      this._top += this._containerDiffY;\n      this._container.appendChild(element);\n      item._setTranslate(this._left, this._top);\n    }\n  }\n\n  addClass(element, grid._settings.itemDraggingClass);\n  this._bindScrollListeners();\n  grid._emit(EVENT_DRAG_START, item, this._dragStartEvent);\n};\n\n/**\n * Drag move handler.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._onMove = function (event) {\n  var item = this._item;\n\n  if (!item._isActive) {\n    this.stop();\n    return;\n  }\n\n  this._dragMoveEvent = event;\n  addDragMoveTick(item._id, this._prepareMove, this._applyMove);\n  addDragSortTick(item._id, this._handleSort);\n};\n\n/**\n * Prepare dragged item for moving.\n *\n * @private\n */\nItemDrag.prototype._prepareMove = function () {\n  if (!this._isActive) return;\n\n  var item = this._item;\n  if (!item._isActive) return;\n\n  var settings = this._getGrid()._settings;\n  var axis = settings.dragAxis;\n  var nextEvent = this._dragMoveEvent;\n  var prevEvent = this._dragPrevMoveEvent || this._dragStartEvent || nextEvent;\n\n  // Update horizontal position data.\n  if (axis !== 'y') {\n    var moveDiffX = nextEvent.clientX - prevEvent.clientX;\n    this._left = this._left - this._moveDiffX + moveDiffX;\n    this._gridX = this._gridX - this._moveDiffX + moveDiffX;\n    this._clientX = this._clientX - this._moveDiffX + moveDiffX;\n    this._moveDiffX = moveDiffX;\n  }\n\n  // Update vertical position data.\n  if (axis !== 'x') {\n    var moveDiffY = nextEvent.clientY - prevEvent.clientY;\n    this._top = this._top - this._moveDiffY + moveDiffY;\n    this._gridY = this._gridY - this._moveDiffY + moveDiffY;\n    this._clientY = this._clientY - this._moveDiffY + moveDiffY;\n    this._moveDiffY = moveDiffY;\n  }\n\n  this._dragPrevMoveEvent = nextEvent;\n};\n\n/**\n * Apply movement to dragged item.\n *\n * @private\n */\nItemDrag.prototype._applyMove = function () {\n  if (!this._isActive) return;\n\n  var item = this._item;\n  if (!item._isActive) return;\n\n  this._moveDiffX = this._moveDiffY = 0;\n  item._setTranslate(this._left, this._top);\n  this._getGrid()._emit(EVENT_DRAG_MOVE, item, this._dragMoveEvent);\n  ItemDrag.autoScroller.updateItem(item);\n};\n\n/**\n * Drag scroll handler.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._onScroll = function (event) {\n  var item = this._item;\n\n  if (!item._isActive) {\n    this.stop();\n    return;\n  }\n\n  this._scrollEvent = event;\n  addDragScrollTick(item._id, this._prepareScroll, this._applyScroll);\n  addDragSortTick(item._id, this._handleSort);\n};\n\n/**\n * Prepare dragged item for scrolling.\n *\n * @private\n */\nItemDrag.prototype._prepareScroll = function () {\n  if (!this._isActive) return;\n\n  // If item is not active do nothing.\n  var item = this._item;\n  if (!item._isActive) return;\n\n  var element = item._element;\n  var grid = this._getGrid();\n  var gridContainer = grid._element;\n  var axis = grid._settings.dragAxis;\n  var moveX = axis !== 'y';\n  var moveY = axis !== 'x';\n  var rect = element.getBoundingClientRect();\n\n  // Update container diff.\n  if (this._container !== gridContainer) {\n    var offsetDiff = getOffsetDiff(this._containingBlock, gridContainer);\n    this._containerDiffX = offsetDiff.left;\n    this._containerDiffY = offsetDiff.top;\n  }\n\n  // Update horizontal position data.\n  if (moveX) {\n    var scrollDiffX = this._clientX - this._moveDiffX - this._scrollDiffX - rect.left;\n    this._left = this._left - this._scrollDiffX + scrollDiffX;\n    this._scrollDiffX = scrollDiffX;\n  }\n\n  // Update vertical position data.\n  if (moveY) {\n    var scrollDiffY = this._clientY - this._moveDiffY - this._scrollDiffY - rect.top;\n    this._top = this._top - this._scrollDiffY + scrollDiffY;\n    this._scrollDiffY = scrollDiffY;\n  }\n\n  // Update grid position.\n  this._gridX = this._left - this._containerDiffX;\n  this._gridY = this._top - this._containerDiffY;\n};\n\n/**\n * Apply scroll to dragged item.\n *\n * @private\n */\nItemDrag.prototype._applyScroll = function () {\n  if (!this._isActive) return;\n\n  var item = this._item;\n  if (!item._isActive) return;\n\n  this._scrollDiffX = this._scrollDiffY = 0;\n  item._setTranslate(this._left, this._top);\n  this._getGrid()._emit(EVENT_DRAG_SCROLL, item, this._scrollEvent);\n};\n\n/**\n * Drag end handler.\n *\n * @private\n * @param {Object} event\n */\nItemDrag.prototype._onEnd = function (event) {\n  var item = this._item;\n  var element = item._element;\n  var grid = this._getGrid();\n  var settings = grid._settings;\n  var release = item._dragRelease;\n\n  // If item is not active, reset drag.\n  if (!item._isActive) {\n    this.stop();\n    return;\n  }\n\n  // Cancel queued ticks.\n  cancelDragStartTick(item._id);\n  cancelDragMoveTick(item._id);\n  cancelDragScrollTick(item._id);\n\n  // Finish sort procedure (does final overlap check if needed).\n  this._finishSort();\n\n  // Remove scroll listeners.\n  this._unbindScrollListeners();\n\n  // Setup release data.\n  release._containerDiffX = this._containerDiffX;\n  release._containerDiffY = this._containerDiffY;\n\n  // Reset drag data.\n  this._reset();\n\n  // Remove drag class name from element.\n  removeClass(element, settings.itemDraggingClass);\n\n  // Stop auto-scroll.\n  ItemDrag.autoScroller.removeItem(item);\n\n  // Emit dragEnd event.\n  grid._emit(EVENT_DRAG_END, item, event);\n\n  // Finish up the migration process or start the release process.\n  this._isMigrating ? this._finishMigration() : release.start();\n};\n\n/**\n * Private helpers\n * ***************\n */\n\n/**\n * Check if an element is an anchor element and open the href url if possible.\n *\n * @param {HTMLElement} element\n */\nfunction openAnchorHref(element) {\n  // Make sure the element is anchor element.\n  if (element.tagName.toLowerCase() !== 'a') return;\n\n  // Get href and make sure it exists.\n  var href = element.getAttribute('href');\n  if (!href) return;\n\n  // Finally let's navigate to the link href.\n  var target = element.getAttribute('target');\n  if (target && target !== '_self') {\n    window.open(href, target);\n  } else {\n    window.location.href = href;\n  }\n}\n\n/**\n * Get current values of the provided styles definition object or array.\n *\n * @param {HTMLElement} element\n * @param {(Object|Array} styles\n * @return {Object}\n */\nfunction getCurrentStyles(element, styles) {\n  var result = {};\n  var prop, i;\n\n  if (Array.isArray(styles)) {\n    for (i = 0; i < styles.length; i++) {\n      prop = styles[i];\n      result[prop] = getStyle(element, getStyleName(prop));\n    }\n  } else {\n    for (prop in styles) {\n      result[prop] = getStyle(element, getStyleName(prop));\n    }\n  }\n\n  return result;\n}\n\nvar unprefixRegEx = /^(webkit|moz|ms|o|Webkit|Moz|MS|O)(?=[A-Z])/;\nvar cache$2 = {};\n\n/**\n * Remove any potential vendor prefixes from a property name.\n *\n * @param {String} prop\n * @returns {String}\n */\nfunction getUnprefixedPropName(prop) {\n  var result = cache$2[prop];\n  if (result) return result;\n\n  result = prop.replace(unprefixRegEx, '');\n\n  if (result !== prop) {\n    result = result[0].toLowerCase() + result.slice(1);\n  }\n\n  cache$2[prop] = result;\n\n  return result;\n}\n\nvar nativeCode = '[native code]';\n\n/**\n * Check if a value (e.g. a method or constructor) is native code. Good for\n * detecting when a polyfill is used and when not.\n *\n * @param {*} feat\n * @returns {Boolean}\n */\nfunction isNative(feat) {\n  var S = window.Symbol;\n  return !!(\n    feat &&\n    isFunction(S) &&\n    isFunction(S.toString) &&\n    S(feat).toString().indexOf(nativeCode) > -1\n  );\n}\n\n/**\n * Set inline styles to an element.\n *\n * @param {HTMLElement} element\n * @param {Object} styles\n */\nfunction setStyles(element, styles) {\n  for (var prop in styles) {\n    element.style[prop] = styles[prop];\n  }\n}\n\nvar HAS_WEB_ANIMATIONS = !!(Element && isFunction(Element.prototype.animate));\nvar HAS_NATIVE_WEB_ANIMATIONS = !!(Element && isNative(Element.prototype.animate));\n\n/**\n * Item animation handler powered by Web Animations API.\n *\n * @class\n * @param {HTMLElement} element\n */\nfunction Animator(element) {\n  this._element = element;\n  this._animation = null;\n  this._duration = 0;\n  this._easing = '';\n  this._callback = null;\n  this._props = [];\n  this._values = [];\n  this._isDestroyed = false;\n  this._onFinish = this._onFinish.bind(this);\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Start instance's animation. Automatically stops current animation if it is\n * running.\n *\n * @public\n * @param {Object} propsFrom\n * @param {Object} propsTo\n * @param {Object} [options]\n * @param {Number} [options.duration=300]\n * @param {String} [options.easing='ease']\n * @param {Function} [options.onFinish]\n */\nAnimator.prototype.start = function (propsFrom, propsTo, options) {\n  if (this._isDestroyed) return;\n\n  var element = this._element;\n  var opts = options || {};\n\n  // If we don't have web animations available let's not animate.\n  if (!HAS_WEB_ANIMATIONS) {\n    setStyles(element, propsTo);\n    this._callback = isFunction(opts.onFinish) ? opts.onFinish : null;\n    this._onFinish();\n    return;\n  }\n\n  var animation = this._animation;\n  var currentProps = this._props;\n  var currentValues = this._values;\n  var duration = opts.duration || 300;\n  var easing = opts.easing || 'ease';\n  var cancelAnimation = false;\n  var propName, propCount, propIndex;\n\n  // If we have an existing animation running, let's check if it needs to be\n  // cancelled or if it can continue running.\n  if (animation) {\n    propCount = 0;\n\n    // Cancel animation if duration or easing has changed.\n    if (duration !== this._duration || easing !== this._easing) {\n      cancelAnimation = true;\n    }\n\n    // Check if the requested animation target props and values match with the\n    // current props and values.\n    if (!cancelAnimation) {\n      for (propName in propsTo) {\n        ++propCount;\n        propIndex = currentProps.indexOf(propName);\n        if (propIndex === -1 || propsTo[propName] !== currentValues[propIndex]) {\n          cancelAnimation = true;\n          break;\n        }\n      }\n\n      // Check if the target props count matches current props count. This is\n      // needed for the edge case scenario where target props contain the same\n      // styles as current props, but the current props have some additional\n      // props.\n      if (propCount !== currentProps.length) {\n        cancelAnimation = true;\n      }\n    }\n  }\n\n  // Cancel animation (if required).\n  if (cancelAnimation) animation.cancel();\n\n  // Store animation callback.\n  this._callback = isFunction(opts.onFinish) ? opts.onFinish : null;\n\n  // If we have a running animation that does not need to be cancelled, let's\n  // call it a day here and let it run.\n  if (animation && !cancelAnimation) return;\n\n  // Store target props and values to instance.\n  currentProps.length = currentValues.length = 0;\n  for (propName in propsTo) {\n    currentProps.push(propName);\n    currentValues.push(propsTo[propName]);\n  }\n\n  // Start the animation. We need to provide unprefixed property names to the\n  // Web Animations polyfill if it is being used. If we have native Web\n  // Animations available we need to provide prefixed properties instead.\n  this._duration = duration;\n  this._easing = easing;\n  this._animation = element.animate(\n    [\n      createFrame(propsFrom, HAS_NATIVE_WEB_ANIMATIONS),\n      createFrame(propsTo, HAS_NATIVE_WEB_ANIMATIONS),\n    ],\n    {\n      duration: duration,\n      easing: easing,\n    }\n  );\n  this._animation.onfinish = this._onFinish;\n\n  // Set the end styles. This makes sure that the element stays at the end\n  // values after animation is finished.\n  setStyles(element, propsTo);\n};\n\n/**\n * Stop instance's current animation if running.\n *\n * @public\n */\nAnimator.prototype.stop = function () {\n  if (this._isDestroyed || !this._animation) return;\n  this._animation.cancel();\n  this._animation = this._callback = null;\n  this._props.length = this._values.length = 0;\n};\n\n/**\n * Read the current values of the element's animated styles from the DOM.\n *\n * @public\n * @return {Object}\n */\nAnimator.prototype.getCurrentStyles = function () {\n  return getCurrentStyles(element, currentProps);\n};\n\n/**\n * Check if the item is being animated currently.\n *\n * @public\n * @return {Boolean}\n */\nAnimator.prototype.isAnimating = function () {\n  return !!this._animation;\n};\n\n/**\n * Destroy the instance and stop current animation if it is running.\n *\n * @public\n */\nAnimator.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n  this.stop();\n  this._element = null;\n  this._isDestroyed = true;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Animation end handler.\n *\n * @private\n */\nAnimator.prototype._onFinish = function () {\n  var callback = this._callback;\n  this._animation = this._callback = null;\n  this._props.length = this._values.length = 0;\n  callback && callback();\n};\n\n/**\n * Private helpers\n * ***************\n */\n\nfunction createFrame(props, prefix) {\n  var frame = {};\n  for (var prop in props) {\n    frame[prefix ? prop : getUnprefixedPropName(prop)] = props[prop];\n  }\n  return frame;\n}\n\n/**\n * Transform translateX and translateY value into CSS transform style\n * property's value.\n *\n * @param {Number} x\n * @param {Number} y\n * @returns {String}\n */\nfunction getTranslateString(x, y) {\n  return 'translateX(' + x + 'px) translateY(' + y + 'px)';\n}\n\n/**\n * Drag placeholder.\n *\n * @class\n * @param {Item} item\n */\nfunction ItemDragPlaceholder(item) {\n  this._item = item;\n  this._animation = new Animator();\n  this._element = null;\n  this._className = '';\n  this._didMigrate = false;\n  this._resetAfterLayout = false;\n  this._left = 0;\n  this._top = 0;\n  this._transX = 0;\n  this._transY = 0;\n  this._nextTransX = 0;\n  this._nextTransY = 0;\n\n  // Bind animation handlers.\n  this._setupAnimation = this._setupAnimation.bind(this);\n  this._startAnimation = this._startAnimation.bind(this);\n  this._updateDimensions = this._updateDimensions.bind(this);\n\n  // Bind event handlers.\n  this._onLayoutStart = this._onLayoutStart.bind(this);\n  this._onLayoutEnd = this._onLayoutEnd.bind(this);\n  this._onReleaseEnd = this._onReleaseEnd.bind(this);\n  this._onMigrate = this._onMigrate.bind(this);\n  this._onHide = this._onHide.bind(this);\n}\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Update placeholder's dimensions to match the item's dimensions.\n *\n * @private\n */\nItemDragPlaceholder.prototype._updateDimensions = function () {\n  if (!this.isActive()) return;\n  setStyles(this._element, {\n    width: this._item._width + 'px',\n    height: this._item._height + 'px',\n  });\n};\n\n/**\n * Move placeholder to a new position.\n *\n * @private\n * @param {Item[]} items\n * @param {Boolean} isInstant\n */\nItemDragPlaceholder.prototype._onLayoutStart = function (items, isInstant) {\n  var item = this._item;\n\n  // If the item is not part of the layout anymore reset placeholder.\n  if (items.indexOf(item) === -1) {\n    this.reset();\n    return;\n  }\n\n  var nextLeft = item._left;\n  var nextTop = item._top;\n  var currentLeft = this._left;\n  var currentTop = this._top;\n\n  // Keep track of item layout position.\n  this._left = nextLeft;\n  this._top = nextTop;\n\n  // If item's position did not change, and the item did not migrate and the\n  // layout is not instant and we can safely skip layout.\n  if (!isInstant && !this._didMigrate && currentLeft === nextLeft && currentTop === nextTop) {\n    return;\n  }\n\n  // Slots data is calculated with item margins added to them so we need to add\n  // item's left and top margin to the slot data to get the placeholder's\n  // next position.\n  var nextX = nextLeft + item._marginLeft;\n  var nextY = nextTop + item._marginTop;\n\n  // Just snap to new position without any animations if no animation is\n  // required or if placeholder moves between grids.\n  var grid = item.getGrid();\n  var animEnabled = !isInstant && grid._settings.layoutDuration > 0;\n  if (!animEnabled || this._didMigrate) {\n    // Cancel potential (queued) layout tick.\n    cancelPlaceholderLayoutTick(item._id);\n\n    // Snap placeholder to correct position.\n    this._element.style[transformProp] = getTranslateString(nextX, nextY);\n    this._animation.stop();\n\n    // Move placeholder inside correct container after migration.\n    if (this._didMigrate) {\n      grid.getElement().appendChild(this._element);\n      this._didMigrate = false;\n    }\n\n    return;\n  }\n\n  // Start the placeholder's layout animation in the next tick. We do this to\n  // avoid layout thrashing.\n  this._nextTransX = nextX;\n  this._nextTransY = nextY;\n  addPlaceholderLayoutTick(item._id, this._setupAnimation, this._startAnimation);\n};\n\n/**\n * Prepare placeholder for layout animation.\n *\n * @private\n */\nItemDragPlaceholder.prototype._setupAnimation = function () {\n  if (!this.isActive()) return;\n\n  var translate = getTranslate(this._element);\n  this._transX = translate.x;\n  this._transY = translate.y;\n};\n\n/**\n * Start layout animation.\n *\n * @private\n */\nItemDragPlaceholder.prototype._startAnimation = function () {\n  if (!this.isActive()) return;\n\n  var animation = this._animation;\n  var currentX = this._transX;\n  var currentY = this._transY;\n  var nextX = this._nextTransX;\n  var nextY = this._nextTransY;\n\n  // If placeholder is already in correct position let's just stop animation\n  // and be done with it.\n  if (currentX === nextX && currentY === nextY) {\n    if (animation.isAnimating()) {\n      this._element.style[transformProp] = getTranslateString(nextX, nextY);\n      animation.stop();\n    }\n    return;\n  }\n\n  // Otherwise let's start the animation.\n  var settings = this._item.getGrid()._settings;\n  var currentStyles = {};\n  var targetStyles = {};\n  currentStyles[transformProp] = getTranslateString(currentX, currentY);\n  targetStyles[transformProp] = getTranslateString(nextX, nextY);\n  animation.start(currentStyles, targetStyles, {\n    duration: settings.layoutDuration,\n    easing: settings.layoutEasing,\n    onFinish: this._onLayoutEnd,\n  });\n};\n\n/**\n * Layout end handler.\n *\n * @private\n */\nItemDragPlaceholder.prototype._onLayoutEnd = function () {\n  if (this._resetAfterLayout) {\n    this.reset();\n  }\n};\n\n/**\n * Drag end handler. This handler is called when dragReleaseEnd event is\n * emitted and receives the event data as it's argument.\n *\n * @private\n * @param {Item} item\n */\nItemDragPlaceholder.prototype._onReleaseEnd = function (item) {\n  if (item._id === this._item._id) {\n    // If the placeholder is not animating anymore we can safely reset it.\n    if (!this._animation.isAnimating()) {\n      this.reset();\n      return;\n    }\n\n    // If the placeholder item is still animating here, let's wait for it to\n    // finish it's animation.\n    this._resetAfterLayout = true;\n  }\n};\n\n/**\n * Migration start handler. This handler is called when beforeSend event is\n * emitted and receives the event data as it's argument.\n *\n * @private\n * @param {Object} data\n * @param {Item} data.item\n * @param {Grid} data.fromGrid\n * @param {Number} data.fromIndex\n * @param {Grid} data.toGrid\n * @param {Number} data.toIndex\n */\nItemDragPlaceholder.prototype._onMigrate = function (data) {\n  // Make sure we have a matching item.\n  if (data.item !== this._item) return;\n\n  var grid = this._item.getGrid();\n  var nextGrid = data.toGrid;\n\n  // Unbind listeners from current grid.\n  grid.off(EVENT_DRAG_RELEASE_END, this._onReleaseEnd);\n  grid.off(EVENT_LAYOUT_START, this._onLayoutStart);\n  grid.off(EVENT_BEFORE_SEND, this._onMigrate);\n  grid.off(EVENT_HIDE_START, this._onHide);\n\n  // Bind listeners to the next grid.\n  nextGrid.on(EVENT_DRAG_RELEASE_END, this._onReleaseEnd);\n  nextGrid.on(EVENT_LAYOUT_START, this._onLayoutStart);\n  nextGrid.on(EVENT_BEFORE_SEND, this._onMigrate);\n  nextGrid.on(EVENT_HIDE_START, this._onHide);\n\n  // Mark the item as migrated.\n  this._didMigrate = true;\n};\n\n/**\n * Reset placeholder if the associated item is hidden.\n *\n * @private\n * @param {Item[]} items\n */\nItemDragPlaceholder.prototype._onHide = function (items) {\n  if (items.indexOf(this._item) > -1) this.reset();\n};\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Create placeholder. Note that this method only writes to DOM and does not\n * read anything from DOM so it should not cause any additional layout\n * thrashing when it's called at the end of the drag start procedure.\n *\n * @public\n */\nItemDragPlaceholder.prototype.create = function () {\n  // If we already have placeholder set up we can skip the initiation logic.\n  if (this.isActive()) {\n    this._resetAfterLayout = false;\n    return;\n  }\n\n  var item = this._item;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n  var animation = this._animation;\n\n  // Keep track of layout position.\n  this._left = item._left;\n  this._top = item._top;\n\n  // Create placeholder element.\n  var element;\n  if (isFunction(settings.dragPlaceholder.createElement)) {\n    element = settings.dragPlaceholder.createElement(item);\n  } else {\n    element = document.createElement('div');\n  }\n  this._element = element;\n\n  // Update element to animation instance.\n  animation._element = element;\n\n  // Add placeholder class to the placeholder element.\n  this._className = settings.itemPlaceholderClass || '';\n  if (this._className) {\n    addClass(element, this._className);\n  }\n\n  // Set initial styles.\n  setStyles(element, {\n    position: 'absolute',\n    left: '0px',\n    top: '0px',\n    width: item._width + 'px',\n    height: item._height + 'px',\n  });\n\n  // Set initial position.\n  element.style[transformProp] = getTranslateString(\n    item._left + item._marginLeft,\n    item._top + item._marginTop\n  );\n\n  // Bind event listeners.\n  grid.on(EVENT_LAYOUT_START, this._onLayoutStart);\n  grid.on(EVENT_DRAG_RELEASE_END, this._onReleaseEnd);\n  grid.on(EVENT_BEFORE_SEND, this._onMigrate);\n  grid.on(EVENT_HIDE_START, this._onHide);\n\n  // onCreate hook.\n  if (isFunction(settings.dragPlaceholder.onCreate)) {\n    settings.dragPlaceholder.onCreate(item, element);\n  }\n\n  // Insert the placeholder element to the grid.\n  grid.getElement().appendChild(element);\n};\n\n/**\n * Reset placeholder data.\n *\n * @public\n */\nItemDragPlaceholder.prototype.reset = function () {\n  if (!this.isActive()) return;\n\n  var element = this._element;\n  var item = this._item;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n  var animation = this._animation;\n\n  // Reset flag.\n  this._resetAfterLayout = false;\n\n  // Cancel potential (queued) layout tick.\n  cancelPlaceholderLayoutTick(item._id);\n  cancelPlaceholderResizeTick(item._id);\n\n  // Reset animation instance.\n  animation.stop();\n  animation._element = null;\n\n  // Unbind event listeners.\n  grid.off(EVENT_DRAG_RELEASE_END, this._onReleaseEnd);\n  grid.off(EVENT_LAYOUT_START, this._onLayoutStart);\n  grid.off(EVENT_BEFORE_SEND, this._onMigrate);\n  grid.off(EVENT_HIDE_START, this._onHide);\n\n  // Remove placeholder class from the placeholder element.\n  if (this._className) {\n    removeClass(element, this._className);\n    this._className = '';\n  }\n\n  // Remove element.\n  element.parentNode.removeChild(element);\n  this._element = null;\n\n  // onRemove hook. Note that here we use the current grid's onRemove callback\n  // so if the item has migrated during drag the onRemove method will not be\n  // the originating grid's method.\n  if (isFunction(settings.dragPlaceholder.onRemove)) {\n    settings.dragPlaceholder.onRemove(item, element);\n  }\n};\n\n/**\n * Check if placeholder is currently active (visible).\n *\n * @public\n * @returns {Boolean}\n */\nItemDragPlaceholder.prototype.isActive = function () {\n  return !!this._element;\n};\n\n/**\n * Get placeholder element.\n *\n * @public\n * @returns {?HTMLElement}\n */\nItemDragPlaceholder.prototype.getElement = function () {\n  return this._element;\n};\n\n/**\n * Update placeholder's dimensions to match the item's dimensions. Note that\n * the updating is done asynchronously in the next tick to avoid layout\n * thrashing.\n *\n * @public\n */\nItemDragPlaceholder.prototype.updateDimensions = function () {\n  if (!this.isActive()) return;\n  addPlaceholderResizeTick(this._item._id, this._updateDimensions);\n};\n\n/**\n * Destroy placeholder instance.\n *\n * @public\n */\nItemDragPlaceholder.prototype.destroy = function () {\n  this.reset();\n  this._animation.destroy();\n  this._item = this._animation = null;\n};\n\n/**\n * The release process handler constructor. Although this might seem as proper\n * fit for the drag process this needs to be separated into it's own logic\n * because there might be a scenario where drag is disabled, but the release\n * process still needs to be implemented (dragging from a grid to another).\n *\n * @class\n * @param {Item} item\n */\nfunction ItemDragRelease(item) {\n  this._item = item;\n  this._isActive = false;\n  this._isDestroyed = false;\n  this._isPositioningStarted = false;\n  this._containerDiffX = 0;\n  this._containerDiffY = 0;\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Start the release process of an item.\n *\n * @public\n */\nItemDragRelease.prototype.start = function () {\n  if (this._isDestroyed || this._isActive) return;\n\n  var item = this._item;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n\n  this._isActive = true;\n  addClass(item._element, settings.itemReleasingClass);\n  if (!settings.dragRelease.useDragContainer) {\n    this._placeToGrid();\n  }\n  grid._emit(EVENT_DRAG_RELEASE_START, item);\n\n  // Let's start layout manually _only_ if there is no unfinished layout in\n  // about to finish.\n  if (!grid._nextLayoutData) item._layout.start(false);\n};\n\n/**\n * End the release process of an item. This method can be used to abort an\n * ongoing release process (animation) or finish the release process.\n *\n * @public\n * @param {Boolean} [abort=false]\n *  - Should the release be aborted? When true, the release end event won't be\n *    emitted. Set to true only when you need to abort the release process\n *    while the item is animating to it's position.\n * @param {Number} [left]\n *  - The element's current translateX value (optional).\n * @param {Number} [top]\n *  - The element's current translateY value (optional).\n */\nItemDragRelease.prototype.stop = function (abort, left, top) {\n  if (this._isDestroyed || !this._isActive) return;\n\n  var item = this._item;\n  var grid = item.getGrid();\n\n  if (!abort && (left === undefined || top === undefined)) {\n    left = item._left;\n    top = item._top;\n  }\n\n  var didReparent = this._placeToGrid(left, top);\n  this._reset(didReparent);\n\n  if (!abort) grid._emit(EVENT_DRAG_RELEASE_END, item);\n};\n\nItemDragRelease.prototype.isJustReleased = function () {\n  return this._isActive && this._isPositioningStarted === false;\n};\n\n/**\n * Destroy instance.\n *\n * @public\n */\nItemDragRelease.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n  this.stop(true);\n  this._item = null;\n  this._isDestroyed = true;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Move the element back to the grid container element if it does not exist\n * there already.\n *\n * @private\n * @param {Number} [left]\n *  - The element's current translateX value (optional).\n * @param {Number} [top]\n *  - The element's current translateY value (optional).\n * @returns {Boolean}\n *   - Returns `true` if the element was reparented.\n */\nItemDragRelease.prototype._placeToGrid = function (left, top) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var element = item._element;\n  var container = item.getGrid()._element;\n  var didReparent = false;\n\n  if (element.parentNode !== container) {\n    if (left === undefined || top === undefined) {\n      var translate = getTranslate(element);\n      left = translate.x - this._containerDiffX;\n      top = translate.y - this._containerDiffY;\n    }\n\n    container.appendChild(element);\n    item._setTranslate(left, top);\n    didReparent = true;\n  }\n\n  this._containerDiffX = 0;\n  this._containerDiffY = 0;\n\n  return didReparent;\n};\n\n/**\n * Reset data and remove releasing class.\n *\n * @private\n * @param {Boolean} [needsReflow]\n */\nItemDragRelease.prototype._reset = function (needsReflow) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var releasingClass = item.getGrid()._settings.itemReleasingClass;\n\n  this._isActive = false;\n  this._isPositioningStarted = false;\n  this._containerDiffX = 0;\n  this._containerDiffY = 0;\n\n  // If the element was just reparented we need to do a forced reflow to remove\n  // the class gracefully.\n  if (releasingClass) {\n    // eslint-disable-next-line\n    if (needsReflow) item._element.clientWidth;\n    removeClass(item._element, releasingClass);\n  }\n};\n\nvar MIN_ANIMATION_DISTANCE = 2;\n\n/**\n * Layout manager for Item instance, handles the positioning of an item.\n *\n * @class\n * @param {Item} item\n */\nfunction ItemLayout(item) {\n  var element = item._element;\n  var elementStyle = element.style;\n\n  this._item = item;\n  this._isActive = false;\n  this._isDestroyed = false;\n  this._isInterrupted = false;\n  this._currentStyles = {};\n  this._targetStyles = {};\n  this._nextLeft = 0;\n  this._nextTop = 0;\n  this._offsetLeft = 0;\n  this._offsetTop = 0;\n  this._skipNextAnimation = false;\n  this._animOptions = {\n    onFinish: this._finish.bind(this),\n    duration: 0,\n    easing: 0,\n  };\n\n  // Set element's initial position styles.\n  elementStyle.left = '0px';\n  elementStyle.top = '0px';\n  item._setTranslate(0, 0);\n\n  this._animation = new Animator(element);\n  this._queue = 'layout-' + item._id;\n\n  // Bind animation handlers and finish method.\n  this._setupAnimation = this._setupAnimation.bind(this);\n  this._startAnimation = this._startAnimation.bind(this);\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Start item layout based on it's current data.\n *\n * @public\n * @param {Boolean} instant\n * @param {Function} [onFinish]\n */\nItemLayout.prototype.start = function (instant, onFinish) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var release = item._dragRelease;\n  var gridSettings = item.getGrid()._settings;\n  var isPositioning = this._isActive;\n  var isJustReleased = release.isJustReleased();\n  var animDuration = isJustReleased\n    ? gridSettings.dragRelease.duration\n    : gridSettings.layoutDuration;\n  var animEasing = isJustReleased ? gridSettings.dragRelease.easing : gridSettings.layoutEasing;\n  var animEnabled = !instant && !this._skipNextAnimation && animDuration > 0;\n\n  // If the item is currently positioning cancel potential queued layout tick\n  // and process current layout callback queue with interrupted flag on.\n  if (isPositioning) {\n    cancelLayoutTick(item._id);\n    item._emitter.burst(this._queue, true, item);\n  }\n\n  // Mark release positioning as started.\n  if (isJustReleased) release._isPositioningStarted = true;\n\n  // Push the callback to the callback queue.\n  if (isFunction(onFinish)) {\n    item._emitter.on(this._queue, onFinish);\n  }\n\n  // Reset animation skipping flag.\n  this._skipNextAnimation = false;\n\n  // If no animations are needed, easy peasy!\n  if (!animEnabled) {\n    this._updateOffsets();\n    item._setTranslate(this._nextLeft, this._nextTop);\n    this._animation.stop();\n    this._finish();\n    return;\n  }\n\n  // Let's make sure an ongoing animation's callback is cancelled before going\n  // further. Without this there's a chance that the animation will finish\n  // before the next tick and mess up our logic.\n  if (this._animation.isAnimating()) {\n    this._animation._animation.onfinish = null;\n  }\n\n  // Kick off animation to be started in the next tick.\n  this._isActive = true;\n  this._animOptions.easing = animEasing;\n  this._animOptions.duration = animDuration;\n  this._isInterrupted = isPositioning;\n  addLayoutTick(item._id, this._setupAnimation, this._startAnimation);\n};\n\n/**\n * Stop item's position animation if it is currently animating.\n *\n * @public\n * @param {Boolean} processCallbackQueue\n * @param {Number} [left]\n * @param {Number} [top]\n */\nItemLayout.prototype.stop = function (processCallbackQueue, left, top) {\n  if (this._isDestroyed || !this._isActive) return;\n\n  var item = this._item;\n\n  // Cancel animation init.\n  cancelLayoutTick(item._id);\n\n  // Stop animation.\n  if (this._animation.isAnimating()) {\n    if (left === undefined || top === undefined) {\n      var translate = getTranslate(item._element);\n      left = translate.x;\n      top = translate.y;\n    }\n    item._setTranslate(left, top);\n    this._animation.stop();\n  }\n\n  // Remove positioning class.\n  removeClass(item._element, item.getGrid()._settings.itemPositioningClass);\n\n  // Reset active state.\n  this._isActive = false;\n\n  // Process callback queue if needed.\n  if (processCallbackQueue) {\n    item._emitter.burst(this._queue, true, item);\n  }\n};\n\n/**\n * Destroy the instance and stop current animation if it is running.\n *\n * @public\n */\nItemLayout.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n\n  var elementStyle = this._item._element.style;\n\n  this.stop(true, 0, 0);\n  this._item._emitter.clear(this._queue);\n  this._animation.destroy();\n\n  elementStyle[transformProp] = '';\n  elementStyle.left = '';\n  elementStyle.top = '';\n\n  this._item = null;\n  this._currentStyles = null;\n  this._targetStyles = null;\n  this._animOptions = null;\n  this._isDestroyed = true;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Calculate and update item's current layout offset data.\n *\n * @private\n */\nItemLayout.prototype._updateOffsets = function () {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var migrate = item._migrate;\n  var release = item._dragRelease;\n\n  this._offsetLeft = release._isActive\n    ? release._containerDiffX\n    : migrate._isActive\n    ? migrate._containerDiffX\n    : 0;\n\n  this._offsetTop = release._isActive\n    ? release._containerDiffY\n    : migrate._isActive\n    ? migrate._containerDiffY\n    : 0;\n\n  this._nextLeft = this._item._left + this._offsetLeft;\n  this._nextTop = this._item._top + this._offsetTop;\n};\n\n/**\n * Finish item layout procedure.\n *\n * @private\n */\nItemLayout.prototype._finish = function () {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var migrate = item._migrate;\n  var release = item._dragRelease;\n\n  // Update internal translate values.\n  item._tX = this._nextLeft;\n  item._tY = this._nextTop;\n\n  // Mark the item as inactive and remove positioning classes.\n  if (this._isActive) {\n    this._isActive = false;\n    removeClass(item._element, item.getGrid()._settings.itemPositioningClass);\n  }\n\n  // Finish up release and migration.\n  if (release._isActive) release.stop();\n  if (migrate._isActive) migrate.stop();\n\n  // Process the callback queue.\n  item._emitter.burst(this._queue, false, item);\n};\n\n/**\n * Prepare item for layout animation.\n *\n * @private\n */\nItemLayout.prototype._setupAnimation = function () {\n  var item = this._item;\n  if (item._tX === undefined || item._tY === undefined) {\n    var translate = getTranslate(item._element);\n    item._tX = translate.x;\n    item._tY = translate.y;\n  }\n};\n\n/**\n * Start layout animation.\n *\n * @private\n */\nItemLayout.prototype._startAnimation = function () {\n  var item = this._item;\n  var settings = item.getGrid()._settings;\n  var isInstant = this._animOptions.duration <= 0;\n\n  // Let's update the offset data and target styles.\n  this._updateOffsets();\n\n  var xDiff = Math.abs(item._left - (item._tX - this._offsetLeft));\n  var yDiff = Math.abs(item._top - (item._tY - this._offsetTop));\n\n  // If there is no need for animation or if the item is already in correct\n  // position (or near it) let's finish the process early.\n  if (isInstant || (xDiff < MIN_ANIMATION_DISTANCE && yDiff < MIN_ANIMATION_DISTANCE)) {\n    if (xDiff || yDiff || this._isInterrupted) {\n      item._setTranslate(this._nextLeft, this._nextTop);\n    }\n    this._animation.stop();\n    this._finish();\n    return;\n  }\n\n  // Set item's positioning class if needed.\n  if (!this._isInterrupted) {\n    addClass(item._element, settings.itemPositioningClass);\n  }\n\n  // Get current/next styles for animation.\n  this._currentStyles[transformProp] = getTranslateString(item._tX, item._tY);\n  this._targetStyles[transformProp] = getTranslateString(this._nextLeft, this._nextTop);\n\n  // Set internal translation values to undefined for the duration of the\n  // animation since they will be changing on each animation frame for the\n  // duration of the animation and tracking them would mean reading the DOM on\n  // each frame, which is pretty darn expensive.\n  item._tX = item._tY = undefined;\n\n  // Start animation.\n  this._animation.start(this._currentStyles, this._targetStyles, this._animOptions);\n};\n\n/**\n * The migrate process handler constructor.\n *\n * @class\n * @param {Item} item\n */\nfunction ItemMigrate(item) {\n  // Private props.\n  this._item = item;\n  this._isActive = false;\n  this._isDestroyed = false;\n  this._container = false;\n  this._containerDiffX = 0;\n  this._containerDiffY = 0;\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Start the migrate process of an item.\n *\n * @public\n * @param {Grid} targetGrid\n * @param {(HTMLElement|Number|Item)} position\n * @param {HTMLElement} [container]\n */\nItemMigrate.prototype.start = function (targetGrid, position, container) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var element = item._element;\n  var isActive = item.isActive();\n  var isVisible = item.isVisible();\n  var grid = item.getGrid();\n  var settings = grid._settings;\n  var targetSettings = targetGrid._settings;\n  var targetElement = targetGrid._element;\n  var targetItems = targetGrid._items;\n  var currentIndex = grid._items.indexOf(item);\n  var targetContainer = container || document.body;\n  var targetIndex;\n  var targetItem;\n  var currentContainer;\n  var offsetDiff;\n  var containerDiff;\n  var translate;\n  var translateX;\n  var translateY;\n  var currentVisClass;\n  var nextVisClass;\n\n  // Get target index.\n  if (typeof position === 'number') {\n    targetIndex = normalizeArrayIndex(targetItems, position, 1);\n  } else {\n    targetItem = targetGrid.getItem(position);\n    if (!targetItem) return;\n    targetIndex = targetItems.indexOf(targetItem);\n  }\n\n  // Get current translateX and translateY values if needed.\n  if (item.isPositioning() || this._isActive || item.isReleasing()) {\n    translate = getTranslate(element);\n    translateX = translate.x;\n    translateY = translate.y;\n  }\n\n  // Abort current positioning.\n  if (item.isPositioning()) {\n    item._layout.stop(true, translateX, translateY);\n  }\n\n  // Abort current migration.\n  if (this._isActive) {\n    translateX -= this._containerDiffX;\n    translateY -= this._containerDiffY;\n    this.stop(true, translateX, translateY);\n  }\n\n  // Abort current release.\n  if (item.isReleasing()) {\n    translateX -= item._dragRelease._containerDiffX;\n    translateY -= item._dragRelease._containerDiffY;\n    item._dragRelease.stop(true, translateX, translateY);\n  }\n\n  // Stop current visibility animation.\n  item._visibility.stop(true);\n\n  // Destroy current drag.\n  if (item._drag) item._drag.destroy();\n\n  // Emit beforeSend event.\n  if (grid._hasListeners(EVENT_BEFORE_SEND)) {\n    grid._emit(EVENT_BEFORE_SEND, {\n      item: item,\n      fromGrid: grid,\n      fromIndex: currentIndex,\n      toGrid: targetGrid,\n      toIndex: targetIndex,\n    });\n  }\n\n  // Emit beforeReceive event.\n  if (targetGrid._hasListeners(EVENT_BEFORE_RECEIVE)) {\n    targetGrid._emit(EVENT_BEFORE_RECEIVE, {\n      item: item,\n      fromGrid: grid,\n      fromIndex: currentIndex,\n      toGrid: targetGrid,\n      toIndex: targetIndex,\n    });\n  }\n\n  // Update item class.\n  if (settings.itemClass !== targetSettings.itemClass) {\n    removeClass(element, settings.itemClass);\n    addClass(element, targetSettings.itemClass);\n  }\n\n  // Update visibility class.\n  currentVisClass = isVisible ? settings.itemVisibleClass : settings.itemHiddenClass;\n  nextVisClass = isVisible ? targetSettings.itemVisibleClass : targetSettings.itemHiddenClass;\n  if (currentVisClass !== nextVisClass) {\n    removeClass(element, currentVisClass);\n    addClass(element, nextVisClass);\n  }\n\n  // Move item instance from current grid to target grid.\n  grid._items.splice(currentIndex, 1);\n  arrayInsert(targetItems, item, targetIndex);\n\n  // Update item's grid id reference.\n  item._gridId = targetGrid._id;\n\n  // If item is active we need to move the item inside the target container for\n  // the duration of the (potential) animation if it's different than the\n  // current container.\n  if (isActive) {\n    currentContainer = element.parentNode;\n    if (targetContainer !== currentContainer) {\n      targetContainer.appendChild(element);\n      offsetDiff = getOffsetDiff(targetContainer, currentContainer, true);\n      if (!translate) {\n        translate = getTranslate(element);\n        translateX = translate.x;\n        translateY = translate.y;\n      }\n      item._setTranslate(translateX + offsetDiff.left, translateY + offsetDiff.top);\n    }\n  }\n  // If item is not active let's just append it to the target grid's element.\n  else {\n    targetElement.appendChild(element);\n  }\n\n  // Update child element's styles to reflect the current visibility state.\n  item._visibility.setStyles(\n    isVisible ? targetSettings.visibleStyles : targetSettings.hiddenStyles\n  );\n\n  // Get offset diff for the migration data, if the item is active.\n  if (isActive) {\n    containerDiff = getOffsetDiff(targetContainer, targetElement, true);\n  }\n\n  // Update item's cached dimensions.\n  item._refreshDimensions();\n\n  // Reset item's sort data.\n  item._sortData = null;\n\n  // Create new drag handler.\n  item._drag = targetSettings.dragEnabled ? new ItemDrag(item) : null;\n\n  // Setup migration data.\n  if (isActive) {\n    this._isActive = true;\n    this._container = targetContainer;\n    this._containerDiffX = containerDiff.left;\n    this._containerDiffY = containerDiff.top;\n  } else {\n    this._isActive = false;\n    this._container = null;\n    this._containerDiffX = 0;\n    this._containerDiffY = 0;\n  }\n\n  // Emit send event.\n  if (grid._hasListeners(EVENT_SEND)) {\n    grid._emit(EVENT_SEND, {\n      item: item,\n      fromGrid: grid,\n      fromIndex: currentIndex,\n      toGrid: targetGrid,\n      toIndex: targetIndex,\n    });\n  }\n\n  // Emit receive event.\n  if (targetGrid._hasListeners(EVENT_RECEIVE)) {\n    targetGrid._emit(EVENT_RECEIVE, {\n      item: item,\n      fromGrid: grid,\n      fromIndex: currentIndex,\n      toGrid: targetGrid,\n      toIndex: targetIndex,\n    });\n  }\n};\n\n/**\n * End the migrate process of an item. This method can be used to abort an\n * ongoing migrate process (animation) or finish the migrate process.\n *\n * @public\n * @param {Boolean} [abort=false]\n *  - Should the migration be aborted?\n * @param {Number} [left]\n *  - The element's current translateX value (optional).\n * @param {Number} [top]\n *  - The element's current translateY value (optional).\n */\nItemMigrate.prototype.stop = function (abort, left, top) {\n  if (this._isDestroyed || !this._isActive) return;\n\n  var item = this._item;\n  var element = item._element;\n  var grid = item.getGrid();\n  var gridElement = grid._element;\n  var translate;\n\n  if (this._container !== gridElement) {\n    if (left === undefined || top === undefined) {\n      if (abort) {\n        translate = getTranslate(element);\n        left = translate.x - this._containerDiffX;\n        top = translate.y - this._containerDiffY;\n      } else {\n        left = item._left;\n        top = item._top;\n      }\n    }\n\n    gridElement.appendChild(element);\n    item._setTranslate(left, top);\n  }\n\n  this._isActive = false;\n  this._container = null;\n  this._containerDiffX = 0;\n  this._containerDiffY = 0;\n};\n\n/**\n * Destroy instance.\n *\n * @public\n */\nItemMigrate.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n  this.stop(true);\n  this._item = null;\n  this._isDestroyed = true;\n};\n\n/**\n * Visibility manager for Item instance, handles visibility of an item.\n *\n * @class\n * @param {Item} item\n */\nfunction ItemVisibility(item) {\n  var isActive = item._isActive;\n  var element = item._element;\n  var childElement = element.children[0];\n  var settings = item.getGrid()._settings;\n\n  if (!childElement) {\n    throw new Error('No valid child element found within item element.');\n  }\n\n  this._item = item;\n  this._isDestroyed = false;\n  this._isHidden = !isActive;\n  this._isHiding = false;\n  this._isShowing = false;\n  this._childElement = childElement;\n  this._currentStyleProps = [];\n  this._animation = new Animator(childElement);\n  this._queue = 'visibility-' + item._id;\n  this._finishShow = this._finishShow.bind(this);\n  this._finishHide = this._finishHide.bind(this);\n\n  element.style.display = isActive ? '' : 'none';\n  addClass(element, isActive ? settings.itemVisibleClass : settings.itemHiddenClass);\n  this.setStyles(isActive ? settings.visibleStyles : settings.hiddenStyles);\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Show item.\n *\n * @public\n * @param {Boolean} instant\n * @param {Function} [onFinish]\n */\nItemVisibility.prototype.show = function (instant, onFinish) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var element = item._element;\n  var callback = isFunction(onFinish) ? onFinish : null;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n\n  // If item is visible call the callback and be done with it.\n  if (!this._isShowing && !this._isHidden) {\n    callback && callback(false, item);\n    return;\n  }\n\n  // If item is showing and does not need to be shown instantly, let's just\n  // push callback to the callback queue and be done with it.\n  if (this._isShowing && !instant) {\n    callback && item._emitter.on(this._queue, callback);\n    return;\n  }\n\n  // If the item is hiding or hidden process the current visibility callback\n  // queue with the interrupted flag active, update classes and set display\n  // to block if necessary.\n  if (!this._isShowing) {\n    item._emitter.burst(this._queue, true, item);\n    removeClass(element, settings.itemHiddenClass);\n    addClass(element, settings.itemVisibleClass);\n    if (!this._isHiding) element.style.display = '';\n  }\n\n  // Push callback to the callback queue.\n  callback && item._emitter.on(this._queue, callback);\n\n  // Update visibility states.\n  this._isShowing = true;\n  this._isHiding = this._isHidden = false;\n\n  // Finally let's start show animation.\n  this._startAnimation(true, instant, this._finishShow);\n};\n\n/**\n * Hide item.\n *\n * @public\n * @param {Boolean} instant\n * @param {Function} [onFinish]\n */\nItemVisibility.prototype.hide = function (instant, onFinish) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var element = item._element;\n  var callback = isFunction(onFinish) ? onFinish : null;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n\n  // If item is already hidden call the callback and be done with it.\n  if (!this._isHiding && this._isHidden) {\n    callback && callback(false, item);\n    return;\n  }\n\n  // If item is hiding and does not need to be hidden instantly, let's just\n  // push callback to the callback queue and be done with it.\n  if (this._isHiding && !instant) {\n    callback && item._emitter.on(this._queue, callback);\n    return;\n  }\n\n  // If the item is showing or visible process the current visibility callback\n  // queue with the interrupted flag active, update classes and set display\n  // to block if necessary.\n  if (!this._isHiding) {\n    item._emitter.burst(this._queue, true, item);\n    addClass(element, settings.itemHiddenClass);\n    removeClass(element, settings.itemVisibleClass);\n  }\n\n  // Push callback to the callback queue.\n  callback && item._emitter.on(this._queue, callback);\n\n  // Update visibility states.\n  this._isHidden = this._isHiding = true;\n  this._isShowing = false;\n\n  // Finally let's start hide animation.\n  this._startAnimation(false, instant, this._finishHide);\n};\n\n/**\n * Stop current hiding/showing process.\n *\n * @public\n * @param {Boolean} processCallbackQueue\n */\nItemVisibility.prototype.stop = function (processCallbackQueue) {\n  if (this._isDestroyed) return;\n  if (!this._isHiding && !this._isShowing) return;\n\n  var item = this._item;\n\n  cancelVisibilityTick(item._id);\n  this._animation.stop();\n  if (processCallbackQueue) {\n    item._emitter.burst(this._queue, true, item);\n  }\n};\n\n/**\n * Reset all existing visibility styles and apply new visibility styles to the\n * visibility element. This method should be used to set styles when there is a\n * chance that the current style properties differ from the new ones (basically\n * on init and on migrations).\n *\n * @public\n * @param {Object} styles\n */\nItemVisibility.prototype.setStyles = function (styles) {\n  var childElement = this._childElement;\n  var currentStyleProps = this._currentStyleProps;\n  this._removeCurrentStyles();\n  for (var prop in styles) {\n    currentStyleProps.push(prop);\n    childElement.style[prop] = styles[prop];\n  }\n};\n\n/**\n * Destroy the instance and stop current animation if it is running.\n *\n * @public\n */\nItemVisibility.prototype.destroy = function () {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var element = item._element;\n  var grid = item.getGrid();\n  var settings = grid._settings;\n\n  this.stop(true);\n  item._emitter.clear(this._queue);\n  this._animation.destroy();\n  this._removeCurrentStyles();\n  removeClass(element, settings.itemVisibleClass);\n  removeClass(element, settings.itemHiddenClass);\n  element.style.display = '';\n\n  // Reset state.\n  this._isHiding = this._isShowing = false;\n  this._isDestroyed = this._isHidden = true;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Start visibility animation.\n *\n * @private\n * @param {Boolean} toVisible\n * @param {Boolean} [instant]\n * @param {Function} [onFinish]\n */\nItemVisibility.prototype._startAnimation = function (toVisible, instant, onFinish) {\n  if (this._isDestroyed) return;\n\n  var item = this._item;\n  var animation = this._animation;\n  var childElement = this._childElement;\n  var settings = item.getGrid()._settings;\n  var targetStyles = toVisible ? settings.visibleStyles : settings.hiddenStyles;\n  var duration = toVisible ? settings.showDuration : settings.hideDuration;\n  var easing = toVisible ? settings.showEasing : settings.hideEasing;\n  var isInstant = instant || duration <= 0;\n  var currentStyles;\n\n  // No target styles? Let's quit early.\n  if (!targetStyles) {\n    onFinish && onFinish();\n    return;\n  }\n\n  // Cancel queued visibility tick.\n  cancelVisibilityTick(item._id);\n\n  // If we need to apply the styles instantly without animation.\n  if (isInstant) {\n    setStyles(childElement, targetStyles);\n    animation.stop();\n    onFinish && onFinish();\n    return;\n  }\n\n  // Let's make sure an ongoing animation's callback is cancelled before going\n  // further. Without this there's a chance that the animation will finish\n  // before the next tick and mess up our logic.\n  if (animation.isAnimating()) {\n    animation._animation.onfinish = null;\n  }\n\n  // Start the animation in the next tick (to avoid layout thrashing).\n  addVisibilityTick(\n    item._id,\n    function () {\n      currentStyles = getCurrentStyles(childElement, targetStyles);\n    },\n    function () {\n      animation.start(currentStyles, targetStyles, {\n        duration: duration,\n        easing: easing,\n        onFinish: onFinish,\n      });\n    }\n  );\n};\n\n/**\n * Finish show procedure.\n *\n * @private\n */\nItemVisibility.prototype._finishShow = function () {\n  if (this._isHidden) return;\n  this._isShowing = false;\n  this._item._emitter.burst(this._queue, false, this._item);\n};\n\n/**\n * Finish hide procedure.\n *\n * @private\n */\nItemVisibility.prototype._finishHide = function () {\n  if (!this._isHidden) return;\n  var item = this._item;\n  this._isHiding = false;\n  item._layout.stop(true, 0, 0);\n  item._element.style.display = 'none';\n  item._emitter.burst(this._queue, false, item);\n};\n\n/**\n * Remove currently applied visibility related inline style properties.\n *\n * @private\n */\nItemVisibility.prototype._removeCurrentStyles = function () {\n  var childElement = this._childElement;\n  var currentStyleProps = this._currentStyleProps;\n\n  for (var i = 0; i < currentStyleProps.length; i++) {\n    childElement.style[currentStyleProps[i]] = '';\n  }\n\n  currentStyleProps.length = 0;\n};\n\nvar id = 0;\n\n/**\n * Returns a unique numeric id (increments a base value on every call).\n * @returns {Number}\n */\nfunction createUid() {\n  return ++id;\n}\n\n/**\n * Creates a new Item instance for a Grid instance.\n *\n * @class\n * @param {Grid} grid\n * @param {HTMLElement} element\n * @param {Boolean} [isActive]\n */\nfunction Item(grid, element, isActive) {\n  var settings = grid._settings;\n\n  // Store item/element pair to a map (for faster item querying by element).\n  if (ITEM_ELEMENT_MAP) {\n    if (ITEM_ELEMENT_MAP.has(element)) {\n      throw new Error('You can only create one Muuri Item per element!');\n    } else {\n      ITEM_ELEMENT_MAP.set(element, this);\n    }\n  }\n\n  this._id = createUid();\n  this._gridId = grid._id;\n  this._element = element;\n  this._isDestroyed = false;\n  this._left = 0;\n  this._top = 0;\n  this._width = 0;\n  this._height = 0;\n  this._marginLeft = 0;\n  this._marginRight = 0;\n  this._marginTop = 0;\n  this._marginBottom = 0;\n  this._tX = undefined;\n  this._tY = undefined;\n  this._sortData = null;\n  this._emitter = new Emitter();\n\n  // If the provided item element is not a direct child of the grid container\n  // element, append it to the grid container. Note, we are indeed reading the\n  // DOM here but it's a property that does not cause reflowing.\n  if (element.parentNode !== grid._element) {\n    grid._element.appendChild(element);\n  }\n\n  // Set item class.\n  addClass(element, settings.itemClass);\n\n  // If isActive is not defined, let's try to auto-detect it. Note, we are\n  // indeed reading the DOM here but it's a property that does not cause\n  // reflowing.\n  if (typeof isActive !== 'boolean') {\n    isActive = getStyle(element, 'display') !== 'none';\n  }\n\n  // Set up active state (defines if the item is considered part of the layout\n  // or not).\n  this._isActive = isActive;\n\n  // Setup visibility handler.\n  this._visibility = new ItemVisibility(this);\n\n  // Set up layout handler.\n  this._layout = new ItemLayout(this);\n\n  // Set up migration handler data.\n  this._migrate = new ItemMigrate(this);\n\n  // Set up drag handler.\n  this._drag = settings.dragEnabled ? new ItemDrag(this) : null;\n\n  // Set up release handler. Note that although this is fully linked to dragging\n  // this still needs to be always instantiated to handle migration scenarios\n  // correctly.\n  this._dragRelease = new ItemDragRelease(this);\n\n  // Set up drag placeholder handler. Note that although this is fully linked to\n  // dragging this still needs to be always instantiated to handle migration\n  // scenarios correctly.\n  this._dragPlaceholder = new ItemDragPlaceholder(this);\n\n  // Note! You must call the following methods before you start using the\n  // instance. They are deliberately not called in the end as it would cause\n  // potentially a massive amount of reflows if multiple items were instantiated\n  // in a loop.\n  // this._refreshDimensions();\n  // this._refreshSortData();\n}\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Get the instance grid reference.\n *\n * @public\n * @returns {Grid}\n */\nItem.prototype.getGrid = function () {\n  return GRID_INSTANCES[this._gridId];\n};\n\n/**\n * Get the instance element.\n *\n * @public\n * @returns {HTMLElement}\n */\nItem.prototype.getElement = function () {\n  return this._element;\n};\n\n/**\n * Get instance element's cached width.\n *\n * @public\n * @returns {Number}\n */\nItem.prototype.getWidth = function () {\n  return this._width;\n};\n\n/**\n * Get instance element's cached height.\n *\n * @public\n * @returns {Number}\n */\nItem.prototype.getHeight = function () {\n  return this._height;\n};\n\n/**\n * Get instance element's cached margins.\n *\n * @public\n * @returns {Object}\n *   - The returned object contains left, right, top and bottom properties\n *     which indicate the item element's cached margins.\n */\nItem.prototype.getMargin = function () {\n  return {\n    left: this._marginLeft,\n    right: this._marginRight,\n    top: this._marginTop,\n    bottom: this._marginBottom,\n  };\n};\n\n/**\n * Get instance element's cached position.\n *\n * @public\n * @returns {Object}\n *   - The returned object contains left and top properties which indicate the\n *     item element's cached position in the grid.\n */\nItem.prototype.getPosition = function () {\n  return {\n    left: this._left,\n    top: this._top,\n  };\n};\n\n/**\n * Is the item active?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isActive = function () {\n  return this._isActive;\n};\n\n/**\n * Is the item visible?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isVisible = function () {\n  return !!this._visibility && !this._visibility._isHidden;\n};\n\n/**\n * Is the item being animated to visible?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isShowing = function () {\n  return !!(this._visibility && this._visibility._isShowing);\n};\n\n/**\n * Is the item being animated to hidden?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isHiding = function () {\n  return !!(this._visibility && this._visibility._isHiding);\n};\n\n/**\n * Is the item positioning?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isPositioning = function () {\n  return !!(this._layout && this._layout._isActive);\n};\n\n/**\n * Is the item being dragged (or queued for dragging)?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isDragging = function () {\n  return !!(this._drag && this._drag._isActive);\n};\n\n/**\n * Is the item being released?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isReleasing = function () {\n  return !!(this._dragRelease && this._dragRelease._isActive);\n};\n\n/**\n * Is the item destroyed?\n *\n * @public\n * @returns {Boolean}\n */\nItem.prototype.isDestroyed = function () {\n  return this._isDestroyed;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Recalculate item's dimensions.\n *\n * @private\n * @param {Boolean} [force=false]\n */\nItem.prototype._refreshDimensions = function (force) {\n  if (this._isDestroyed) return;\n  if (force !== true && this._visibility._isHidden) return;\n\n  var element = this._element;\n  var dragPlaceholder = this._dragPlaceholder;\n  var rect = element.getBoundingClientRect();\n\n  // Calculate width and height.\n  this._width = rect.width;\n  this._height = rect.height;\n\n  // Calculate margins (ignore negative margins).\n  this._marginLeft = Math.max(0, getStyleAsFloat(element, 'margin-left'));\n  this._marginRight = Math.max(0, getStyleAsFloat(element, 'margin-right'));\n  this._marginTop = Math.max(0, getStyleAsFloat(element, 'margin-top'));\n  this._marginBottom = Math.max(0, getStyleAsFloat(element, 'margin-bottom'));\n\n  // Keep drag placeholder's dimensions synced with the item's.\n  if (dragPlaceholder) dragPlaceholder.updateDimensions();\n};\n\n/**\n * Fetch and store item's sort data.\n *\n * @private\n */\nItem.prototype._refreshSortData = function () {\n  if (this._isDestroyed) return;\n\n  var data = (this._sortData = {});\n  var getters = this.getGrid()._settings.sortData;\n  var prop;\n\n  for (prop in getters) {\n    data[prop] = getters[prop](this, this._element);\n  }\n};\n\n/**\n * Add item to layout.\n *\n * @private\n */\nItem.prototype._addToLayout = function (left, top) {\n  if (this._isActive === true) return;\n  this._isActive = true;\n  this._left = left || 0;\n  this._top = top || 0;\n};\n\n/**\n * Remove item from layout.\n *\n * @private\n */\nItem.prototype._removeFromLayout = function () {\n  if (this._isActive === false) return;\n  this._isActive = false;\n  this._left = 0;\n  this._top = 0;\n};\n\n/**\n * Check if the layout procedure can be skipped for the item.\n *\n * @private\n * @param {Number} left\n * @param {Number} top\n * @returns {Boolean}\n */\nItem.prototype._canSkipLayout = function (left, top) {\n  return (\n    this._left === left &&\n    this._top === top &&\n    !this._migrate._isActive &&\n    !this._layout._skipNextAnimation &&\n    !this._dragRelease.isJustReleased()\n  );\n};\n\n/**\n * Set the provided left and top arguments as the item element's translate\n * values in the DOM. This method keeps track of the currently applied\n * translate values and skips the update operation if the provided values are\n * identical to the currently applied values. Returns `false` if there was no\n * need for update and `true` if the translate value was updated.\n *\n * @private\n * @param {Number} left\n * @param {Number} top\n * @returns {Boolean}\n */\nItem.prototype._setTranslate = function (left, top) {\n  if (this._tX === left && this._tY === top) return false;\n  this._tX = left;\n  this._tY = top;\n  this._element.style[transformProp] = getTranslateString(left, top);\n  return true;\n};\n\n/**\n * Destroy item instance.\n *\n * @private\n * @param {Boolean} [removeElement=false]\n */\nItem.prototype._destroy = function (removeElement) {\n  if (this._isDestroyed) return;\n\n  var element = this._element;\n  var grid = this.getGrid();\n  var settings = grid._settings;\n\n  // Destroy handlers.\n  this._dragPlaceholder.destroy();\n  this._dragRelease.destroy();\n  this._migrate.destroy();\n  this._layout.destroy();\n  this._visibility.destroy();\n  if (this._drag) this._drag.destroy();\n\n  // Destroy emitter.\n  this._emitter.destroy();\n\n  // Remove item class.\n  removeClass(element, settings.itemClass);\n\n  // Remove element from DOM.\n  if (removeElement) element.parentNode.removeChild(element);\n\n  // Remove item/element pair from map.\n  if (ITEM_ELEMENT_MAP) ITEM_ELEMENT_MAP.delete(element);\n\n  // Reset state.\n  this._isActive = false;\n  this._isDestroyed = true;\n};\n\nfunction createPackerProcessor(isWorker) {\n  var FILL_GAPS = 1;\n  var HORIZONTAL = 2;\n  var ALIGN_RIGHT = 4;\n  var ALIGN_BOTTOM = 8;\n  var ROUNDING = 16;\n\n  var EPS = 0.001;\n  var MIN_SLOT_SIZE = 0.5;\n\n  // Rounds number first to three decimal precision and then floors the result\n  // to two decimal precision.\n  // Math.floor(Math.round(number * 1000) / 10) / 100\n  function roundNumber(number) {\n    return ((((number * 1000 + 0.5) << 0) / 10) << 0) / 100;\n  }\n\n  /**\n   * @class\n   */\n  function PackerProcessor() {\n    this.currentRects = [];\n    this.nextRects = [];\n    this.rectTarget = {};\n    this.rectStore = [];\n    this.slotSizes = [];\n    this.rectId = 0;\n    this.slotIndex = -1;\n    this.slotData = { left: 0, top: 0, width: 0, height: 0 };\n    this.sortRectsLeftTop = this.sortRectsLeftTop.bind(this);\n    this.sortRectsTopLeft = this.sortRectsTopLeft.bind(this);\n  }\n\n  /**\n   * Takes a layout object as an argument and computes positions (slots) for the\n   * layout items. Also computes the final width and height of the layout. The\n   * provided layout object's slots array is mutated as well as the width and\n   * height properties.\n   *\n   * @param {Object} layout\n   * @param {Number} layout.width\n   *   - The start (current) width of the layout in pixels.\n   * @param {Number} layout.height\n   *   - The start (current) height of the layout in pixels.\n   * @param {(Item[]|Number[])} layout.items\n   *   - List of Muuri.Item instances or a list of item dimensions\n   *     (e.g [ item1Width, item1Height, item2Width, item2Height, ... ]).\n   * @param {(Array|Float32Array)} layout.slots\n   *   - An Array/Float32Array instance which's length should equal to\n   *     the amount of items times two. The position (width and height) of each\n   *     item will be written into this array.\n   * @param {Number} settings\n   *   - The layout's settings as bitmasks.\n   * @returns {Object}\n   */\n  PackerProcessor.prototype.computeLayout = function (layout, settings) {\n    var items = layout.items;\n    var slots = layout.slots;\n    var fillGaps = !!(settings & FILL_GAPS);\n    var horizontal = !!(settings & HORIZONTAL);\n    var alignRight = !!(settings & ALIGN_RIGHT);\n    var alignBottom = !!(settings & ALIGN_BOTTOM);\n    var rounding = !!(settings & ROUNDING);\n    var isPreProcessed = typeof items[0] === 'number';\n    var i, bump, item, slotWidth, slotHeight, slot;\n\n    // No need to go further if items do not exist.\n    if (!items.length) return layout;\n\n    // Compute slots for the items.\n    bump = isPreProcessed ? 2 : 1;\n    for (i = 0; i < items.length; i += bump) {\n      // If items are pre-processed it means that items array contains only\n      // the raw dimensions of the items. Otherwise we assume it is an array\n      // of normal Muuri items.\n      if (isPreProcessed) {\n        slotWidth = items[i];\n        slotHeight = items[i + 1];\n      } else {\n        item = items[i];\n        slotWidth = item._width + item._marginLeft + item._marginRight;\n        slotHeight = item._height + item._marginTop + item._marginBottom;\n      }\n\n      // If rounding is enabled let's round the item's width and height to\n      // make the layout algorithm a bit more stable. This has a performance\n      // cost so don't use this if not necessary.\n      if (rounding) {\n        slotWidth = roundNumber(slotWidth);\n        slotHeight = roundNumber(slotHeight);\n      }\n\n      // Get slot data.\n      slot = this.computeNextSlot(layout, slotWidth, slotHeight, fillGaps, horizontal);\n\n      // Update layout width/height.\n      if (horizontal) {\n        if (slot.left + slot.width > layout.width) {\n          layout.width = slot.left + slot.width;\n        }\n      } else {\n        if (slot.top + slot.height > layout.height) {\n          layout.height = slot.top + slot.height;\n        }\n      }\n\n      // Add item slot data to layout slots.\n      slots[++this.slotIndex] = slot.left;\n      slots[++this.slotIndex] = slot.top;\n\n      // Store the size too (for later usage) if needed.\n      if (alignRight || alignBottom) {\n        this.slotSizes.push(slot.width, slot.height);\n      }\n    }\n\n    // If the alignment is set to right we need to adjust the results.\n    if (alignRight) {\n      for (i = 0; i < slots.length; i += 2) {\n        slots[i] = layout.width - (slots[i] + this.slotSizes[i]);\n      }\n    }\n\n    // If the alignment is set to bottom we need to adjust the results.\n    if (alignBottom) {\n      for (i = 1; i < slots.length; i += 2) {\n        slots[i] = layout.height - (slots[i] + this.slotSizes[i]);\n      }\n    }\n\n    // Reset stuff.\n    this.slotSizes.length = 0;\n    this.currentRects.length = 0;\n    this.nextRects.length = 0;\n    this.rectId = 0;\n    this.slotIndex = -1;\n\n    return layout;\n  };\n\n  /**\n   * Calculate next slot in the layout. Returns a slot object with position and\n   * dimensions data. The returned object is reused between calls.\n   *\n   * @param {Object} layout\n   * @param {Number} slotWidth\n   * @param {Number} slotHeight\n   * @param {Boolean} fillGaps\n   * @param {Boolean} horizontal\n   * @returns {Object}\n   */\n  PackerProcessor.prototype.computeNextSlot = function (\n    layout,\n    slotWidth,\n    slotHeight,\n    fillGaps,\n    horizontal\n  ) {\n    var slot = this.slotData;\n    var currentRects = this.currentRects;\n    var nextRects = this.nextRects;\n    var ignoreCurrentRects = false;\n    var rect;\n    var rectId;\n    var shards;\n    var i;\n    var j;\n\n    // Reset new slots.\n    nextRects.length = 0;\n\n    // Set item slot initial data.\n    slot.left = null;\n    slot.top = null;\n    slot.width = slotWidth;\n    slot.height = slotHeight;\n\n    // Try to find position for the slot from the existing free spaces in the\n    // layout.\n    for (i = 0; i < currentRects.length; i++) {\n      rectId = currentRects[i];\n      if (!rectId) continue;\n      rect = this.getRect(rectId);\n      if (slot.width <= rect.width + EPS && slot.height <= rect.height + EPS) {\n        slot.left = rect.left;\n        slot.top = rect.top;\n        break;\n      }\n    }\n\n    // If no position was found for the slot let's position the slot to\n    // the bottom left (in vertical mode) or top right (in horizontal mode) of\n    // the layout.\n    if (slot.left === null) {\n      if (horizontal) {\n        slot.left = layout.width;\n        slot.top = 0;\n      } else {\n        slot.left = 0;\n        slot.top = layout.height;\n      }\n\n      // If gaps don't need filling let's throw away all the current free spaces\n      // (currentRects).\n      if (!fillGaps) {\n        ignoreCurrentRects = true;\n      }\n    }\n\n    // In vertical mode, if the slot's bottom overlaps the layout's bottom.\n    if (!horizontal && slot.top + slot.height > layout.height + EPS) {\n      // If slot is not aligned to the left edge, create a new free space to the\n      // left of the slot.\n      if (slot.left > MIN_SLOT_SIZE) {\n        nextRects.push(this.addRect(0, layout.height, slot.left, Infinity));\n      }\n\n      // If slot is not aligned to the right edge, create a new free space to\n      // the right of the slot.\n      if (slot.left + slot.width < layout.width - MIN_SLOT_SIZE) {\n        nextRects.push(\n          this.addRect(\n            slot.left + slot.width,\n            layout.height,\n            layout.width - slot.left - slot.width,\n            Infinity\n          )\n        );\n      }\n\n      // Update layout height.\n      layout.height = slot.top + slot.height;\n    }\n\n    // In horizontal mode, if the slot's right overlaps the layout's right edge.\n    if (horizontal && slot.left + slot.width > layout.width + EPS) {\n      // If slot is not aligned to the top, create a new free space above the\n      // slot.\n      if (slot.top > MIN_SLOT_SIZE) {\n        nextRects.push(this.addRect(layout.width, 0, Infinity, slot.top));\n      }\n\n      // If slot is not aligned to the bottom, create a new free space below\n      // the slot.\n      if (slot.top + slot.height < layout.height - MIN_SLOT_SIZE) {\n        nextRects.push(\n          this.addRect(\n            layout.width,\n            slot.top + slot.height,\n            Infinity,\n            layout.height - slot.top - slot.height\n          )\n        );\n      }\n\n      // Update layout width.\n      layout.width = slot.left + slot.width;\n    }\n\n    // Clean up the current free spaces making sure none of them overlap with\n    // the slot. Split all overlapping free spaces into smaller shards that do\n    // not overlap with the slot.\n    if (!ignoreCurrentRects) {\n      if (fillGaps) i = 0;\n      for (; i < currentRects.length; i++) {\n        rectId = currentRects[i];\n        if (!rectId) continue;\n        rect = this.getRect(rectId);\n        shards = this.splitRect(rect, slot);\n        for (j = 0; j < shards.length; j++) {\n          rectId = shards[j];\n          rect = this.getRect(rectId);\n          // Make sure that the free space is within the boundaries of the\n          // layout. This routine is critical to the algorithm as it makes sure\n          // that there are no leftover spaces with infinite height/width.\n          // It's also essential that we don't compare values absolutely to each\n          // other but leave a little headroom (EPSILON) to get rid of false\n          // positives.\n          if (\n            horizontal ? rect.left + EPS < layout.width - EPS : rect.top + EPS < layout.height - EPS\n          ) {\n            nextRects.push(rectId);\n          }\n        }\n      }\n    }\n\n    // Sanitize and sort all the new free spaces that will be used in the next\n    // iteration. This procedure is critical to make the bin-packing algorithm\n    // work. The free spaces have to be in correct order in the beginning of the\n    // next iteration.\n    if (nextRects.length > 1) {\n      this.purgeRects(nextRects).sort(horizontal ? this.sortRectsLeftTop : this.sortRectsTopLeft);\n    }\n\n    // Finally we need to make sure that `this.currentRects` points to\n    // `nextRects` array as that is used in the next iteration's beginning when\n    // we try to find a space for the next slot.\n    this.currentRects = nextRects;\n    this.nextRects = currentRects;\n\n    return slot;\n  };\n\n  /**\n   * Add a new rectangle to the rectangle store. Returns the id of the new\n   * rectangle.\n   *\n   * @param {Number} left\n   * @param {Number} top\n   * @param {Number} width\n   * @param {Number} height\n   * @returns {Number}\n   */\n  PackerProcessor.prototype.addRect = function (left, top, width, height) {\n    var rectId = ++this.rectId;\n    this.rectStore[rectId] = left || 0;\n    this.rectStore[++this.rectId] = top || 0;\n    this.rectStore[++this.rectId] = width || 0;\n    this.rectStore[++this.rectId] = height || 0;\n    return rectId;\n  };\n\n  /**\n   * Get rectangle data from the rectangle store by id. Optionally you can\n   * provide a target object where the rectangle data will be written in. By\n   * default an internal object is reused as a target object.\n   *\n   * @param {Number} id\n   * @param {Object} [target]\n   * @returns {Object}\n   */\n  PackerProcessor.prototype.getRect = function (id, target) {\n    if (!target) target = this.rectTarget;\n    target.left = this.rectStore[id] || 0;\n    target.top = this.rectStore[++id] || 0;\n    target.width = this.rectStore[++id] || 0;\n    target.height = this.rectStore[++id] || 0;\n    return target;\n  };\n\n  /**\n   * Punch a hole into a rectangle and return the shards (1-4).\n   *\n   * @param {Object} rect\n   * @param {Object} hole\n   * @returns {Number[]}\n   */\n  PackerProcessor.prototype.splitRect = (function () {\n    var shards = [];\n    var width = 0;\n    var height = 0;\n    return function (rect, hole) {\n      // Reset old shards.\n      shards.length = 0;\n\n      // If the slot does not overlap with the hole add slot to the return data\n      // as is. Note that in this case we are eager to keep the slot as is if\n      // possible so we use the EPSILON in favour of that logic.\n      if (\n        rect.left + rect.width <= hole.left + EPS ||\n        hole.left + hole.width <= rect.left + EPS ||\n        rect.top + rect.height <= hole.top + EPS ||\n        hole.top + hole.height <= rect.top + EPS\n      ) {\n        shards.push(this.addRect(rect.left, rect.top, rect.width, rect.height));\n        return shards;\n      }\n\n      // Left split.\n      width = hole.left - rect.left;\n      if (width >= MIN_SLOT_SIZE) {\n        shards.push(this.addRect(rect.left, rect.top, width, rect.height));\n      }\n\n      // Right split.\n      width = rect.left + rect.width - (hole.left + hole.width);\n      if (width >= MIN_SLOT_SIZE) {\n        shards.push(this.addRect(hole.left + hole.width, rect.top, width, rect.height));\n      }\n\n      // Top split.\n      height = hole.top - rect.top;\n      if (height >= MIN_SLOT_SIZE) {\n        shards.push(this.addRect(rect.left, rect.top, rect.width, height));\n      }\n\n      // Bottom split.\n      height = rect.top + rect.height - (hole.top + hole.height);\n      if (height >= MIN_SLOT_SIZE) {\n        shards.push(this.addRect(rect.left, hole.top + hole.height, rect.width, height));\n      }\n\n      return shards;\n    };\n  })();\n\n  /**\n   * Check if a rectangle is fully within another rectangle.\n   *\n   * @param {Object} a\n   * @param {Object} b\n   * @returns {Boolean}\n   */\n  PackerProcessor.prototype.isRectAWithinRectB = function (a, b) {\n    return (\n      a.left + EPS >= b.left &&\n      a.top + EPS >= b.top &&\n      a.left + a.width - EPS <= b.left + b.width &&\n      a.top + a.height - EPS <= b.top + b.height\n    );\n  };\n\n  /**\n   * Loops through an array of rectangle ids and resets all that are fully\n   * within another rectangle in the array. Resetting in this case means that\n   * the rectangle id value is replaced with zero.\n   *\n   * @param {Number[]} rectIds\n   * @returns {Number[]}\n   */\n  PackerProcessor.prototype.purgeRects = (function () {\n    var rectA = {};\n    var rectB = {};\n    return function (rectIds) {\n      var i = rectIds.length;\n      var j;\n\n      while (i--) {\n        j = rectIds.length;\n        if (!rectIds[i]) continue;\n        this.getRect(rectIds[i], rectA);\n        while (j--) {\n          if (!rectIds[j] || i === j) continue;\n          this.getRect(rectIds[j], rectB);\n          if (this.isRectAWithinRectB(rectA, rectB)) {\n            rectIds[i] = 0;\n            break;\n          }\n        }\n      }\n\n      return rectIds;\n    };\n  })();\n\n  /**\n   * Sort rectangles with top-left gravity.\n   *\n   * @param {Number} aId\n   * @param {Number} bId\n   * @returns {Number}\n   */\n  PackerProcessor.prototype.sortRectsTopLeft = (function () {\n    var rectA = {};\n    var rectB = {};\n    return function (aId, bId) {\n      this.getRect(aId, rectA);\n      this.getRect(bId, rectB);\n\n      return rectA.top < rectB.top && rectA.top + EPS < rectB.top\n        ? -1\n        : rectA.top > rectB.top && rectA.top - EPS > rectB.top\n        ? 1\n        : rectA.left < rectB.left && rectA.left + EPS < rectB.left\n        ? -1\n        : rectA.left > rectB.left && rectA.left - EPS > rectB.left\n        ? 1\n        : 0;\n    };\n  })();\n\n  /**\n   * Sort rectangles with left-top gravity.\n   *\n   * @param {Number} aId\n   * @param {Number} bId\n   * @returns {Number}\n   */\n  PackerProcessor.prototype.sortRectsLeftTop = (function () {\n    var rectA = {};\n    var rectB = {};\n    return function (aId, bId) {\n      this.getRect(aId, rectA);\n      this.getRect(bId, rectB);\n      return rectA.left < rectB.left && rectA.left + EPS < rectB.left\n        ? -1\n        : rectA.left > rectB.left && rectA.left - EPS < rectB.left\n        ? 1\n        : rectA.top < rectB.top && rectA.top + EPS < rectB.top\n        ? -1\n        : rectA.top > rectB.top && rectA.top - EPS > rectB.top\n        ? 1\n        : 0;\n    };\n  })();\n\n  if (isWorker) {\n    var PACKET_INDEX_WIDTH = 1;\n    var PACKET_INDEX_HEIGHT = 2;\n    var PACKET_INDEX_OPTIONS = 3;\n    var PACKET_HEADER_SLOTS = 4;\n    var processor = new PackerProcessor();\n\n    self.onmessage = function (msg) {\n      var data = new Float32Array(msg.data);\n      var items = data.subarray(PACKET_HEADER_SLOTS, data.length);\n      var slots = new Float32Array(items.length);\n      var settings = data[PACKET_INDEX_OPTIONS];\n      var layout = {\n        items: items,\n        slots: slots,\n        width: data[PACKET_INDEX_WIDTH],\n        height: data[PACKET_INDEX_HEIGHT],\n      };\n\n      // Compute the layout (width / height / slots).\n      processor.computeLayout(layout, settings);\n\n      // Copy layout data to the return data.\n      data[PACKET_INDEX_WIDTH] = layout.width;\n      data[PACKET_INDEX_HEIGHT] = layout.height;\n      data.set(layout.slots, PACKET_HEADER_SLOTS);\n\n      // Send layout back to the main thread.\n      postMessage(data.buffer, [data.buffer]);\n    };\n  }\n\n  return PackerProcessor;\n}\n\nvar PackerProcessor = createPackerProcessor();\n\n//\n// WORKER UTILS\n//\n\nvar blobUrl = null;\nvar activeWorkers = [];\n\nfunction createWorkerProcessors(amount, onmessage) {\n  var workers = [];\n\n  if (amount > 0) {\n    if (!blobUrl) {\n      blobUrl = URL.createObjectURL(\n        new Blob(['(' + createPackerProcessor.toString() + ')(true)'], {\n          type: 'application/javascript',\n        })\n      );\n    }\n\n    for (var i = 0, worker; i < amount; i++) {\n      worker = new Worker(blobUrl);\n      if (onmessage) worker.onmessage = onmessage;\n      workers.push(worker);\n      activeWorkers.push(worker);\n    }\n  }\n\n  return workers;\n}\n\nfunction destroyWorkerProcessors(workers) {\n  var worker;\n  var index;\n\n  for (var i = 0; i < workers.length; i++) {\n    worker = workers[i];\n    worker.onmessage = null;\n    worker.onerror = null;\n    worker.onmessageerror = null;\n    worker.terminate();\n\n    index = activeWorkers.indexOf(worker);\n    if (index > -1) activeWorkers.splice(index, 1);\n  }\n\n  if (blobUrl && !activeWorkers.length) {\n    URL.revokeObjectURL(blobUrl);\n    blobUrl = null;\n  }\n}\n\nfunction isWorkerProcessorsSupported() {\n  return !!(window.Worker && window.URL && window.Blob);\n}\n\nvar FILL_GAPS = 1;\nvar HORIZONTAL = 2;\nvar ALIGN_RIGHT = 4;\nvar ALIGN_BOTTOM = 8;\nvar ROUNDING = 16;\nvar PACKET_INDEX_ID = 0;\nvar PACKET_INDEX_WIDTH = 1;\nvar PACKET_INDEX_HEIGHT = 2;\nvar PACKET_INDEX_OPTIONS = 3;\nvar PACKET_HEADER_SLOTS = 4;\n\n/**\n * @class\n * @param {Number} [numWorkers=0]\n * @param {Object} [options]\n * @param {Boolean} [options.fillGaps=false]\n * @param {Boolean} [options.horizontal=false]\n * @param {Boolean} [options.alignRight=false]\n * @param {Boolean} [options.alignBottom=false]\n * @param {Boolean} [options.rounding=false]\n */\nfunction Packer(numWorkers, options) {\n  this._options = 0;\n  this._processor = null;\n  this._layoutQueue = [];\n  this._layouts = {};\n  this._layoutCallbacks = {};\n  this._layoutWorkers = {};\n  this._layoutWorkerData = {};\n  this._workers = [];\n  this._onWorkerMessage = this._onWorkerMessage.bind(this);\n\n  // Set initial options.\n  this.setOptions(options);\n\n  // Init the worker(s) or the processor if workers can't be used.\n  numWorkers = typeof numWorkers === 'number' ? Math.max(0, numWorkers) : 0;\n  if (numWorkers && isWorkerProcessorsSupported()) {\n    try {\n      this._workers = createWorkerProcessors(numWorkers, this._onWorkerMessage);\n    } catch (e) {\n      this._processor = new PackerProcessor();\n    }\n  } else {\n    this._processor = new PackerProcessor();\n  }\n}\n\nPacker.prototype._sendToWorker = function () {\n  if (!this._layoutQueue.length || !this._workers.length) return;\n\n  var layoutId = this._layoutQueue.shift();\n  var worker = this._workers.pop();\n  var data = this._layoutWorkerData[layoutId];\n\n  delete this._layoutWorkerData[layoutId];\n  this._layoutWorkers[layoutId] = worker;\n  worker.postMessage(data.buffer, [data.buffer]);\n};\n\nPacker.prototype._onWorkerMessage = function (msg) {\n  var data = new Float32Array(msg.data);\n  var layoutId = data[PACKET_INDEX_ID];\n  var layout = this._layouts[layoutId];\n  var callback = this._layoutCallbacks[layoutId];\n  var worker = this._layoutWorkers[layoutId];\n\n  if (layout) delete this._layoutCallbacks[layoutId];\n  if (callback) delete this._layoutCallbacks[layoutId];\n  if (worker) delete this._layoutWorkers[layoutId];\n\n  if (layout && callback) {\n    layout.width = data[PACKET_INDEX_WIDTH];\n    layout.height = data[PACKET_INDEX_HEIGHT];\n    layout.slots = data.subarray(PACKET_HEADER_SLOTS, data.length);\n    this._finalizeLayout(layout);\n    callback(layout);\n  }\n\n  if (worker) {\n    this._workers.push(worker);\n    this._sendToWorker();\n  }\n};\n\nPacker.prototype._finalizeLayout = function (layout) {\n  var grid = layout._grid;\n  var isHorizontal = layout._settings & HORIZONTAL;\n  var isBorderBox = grid._boxSizing === 'border-box';\n\n  delete layout._grid;\n  delete layout._settings;\n\n  layout.styles = {};\n\n  if (isHorizontal) {\n    layout.styles.width =\n      (isBorderBox ? layout.width + grid._borderLeft + grid._borderRight : layout.width) + 'px';\n  } else {\n    layout.styles.height =\n      (isBorderBox ? layout.height + grid._borderTop + grid._borderBottom : layout.height) + 'px';\n  }\n\n  return layout;\n};\n\n/**\n * @public\n * @param {Object} [options]\n * @param {Boolean} [options.fillGaps]\n * @param {Boolean} [options.horizontal]\n * @param {Boolean} [options.alignRight]\n * @param {Boolean} [options.alignBottom]\n * @param {Boolean} [options.rounding]\n */\nPacker.prototype.setOptions = function (options) {\n  if (!options) return;\n\n  var fillGaps;\n  if (typeof options.fillGaps === 'boolean') {\n    fillGaps = options.fillGaps ? FILL_GAPS : 0;\n  } else {\n    fillGaps = this._options & FILL_GAPS;\n  }\n\n  var horizontal;\n  if (typeof options.horizontal === 'boolean') {\n    horizontal = options.horizontal ? HORIZONTAL : 0;\n  } else {\n    horizontal = this._options & HORIZONTAL;\n  }\n\n  var alignRight;\n  if (typeof options.alignRight === 'boolean') {\n    alignRight = options.alignRight ? ALIGN_RIGHT : 0;\n  } else {\n    alignRight = this._options & ALIGN_RIGHT;\n  }\n\n  var alignBottom;\n  if (typeof options.alignBottom === 'boolean') {\n    alignBottom = options.alignBottom ? ALIGN_BOTTOM : 0;\n  } else {\n    alignBottom = this._options & ALIGN_BOTTOM;\n  }\n\n  var rounding;\n  if (typeof options.rounding === 'boolean') {\n    rounding = options.rounding ? ROUNDING : 0;\n  } else {\n    rounding = this._options & ROUNDING;\n  }\n\n  this._options = fillGaps | horizontal | alignRight | alignBottom | rounding;\n};\n\n/**\n * @public\n * @param {Grid} grid\n * @param {Number} layoutId\n * @param {Item[]} items\n * @param {Number} width\n * @param {Number} height\n * @param {Function} callback\n * @returns {?Function}\n */\nPacker.prototype.createLayout = function (grid, layoutId, items, width, height, callback) {\n  if (this._layouts[layoutId]) {\n    throw new Error('A layout with the provided id is currently being processed.');\n  }\n\n  var horizontal = this._options & HORIZONTAL;\n  var layout = {\n    id: layoutId,\n    items: items,\n    slots: null,\n    width: horizontal ? 0 : width,\n    height: !horizontal ? 0 : height,\n    // Temporary data, which will be removed before sending the layout data\n    // outside of Packer's context.\n    _grid: grid,\n    _settings: this._options,\n  };\n\n  // If there are no items let's call the callback immediately.\n  if (!items.length) {\n    layout.slots = [];\n    this._finalizeLayout(layout);\n    callback(layout);\n    return;\n  }\n\n  // Create layout synchronously if needed.\n  if (this._processor) {\n    layout.slots = window.Float32Array\n      ? new Float32Array(items.length * 2)\n      : new Array(items.length * 2);\n    this._processor.computeLayout(layout, layout._settings);\n    this._finalizeLayout(layout);\n    callback(layout);\n    return;\n  }\n\n  // Worker data.\n  var data = new Float32Array(PACKET_HEADER_SLOTS + items.length * 2);\n\n  // Worker data header.\n  data[PACKET_INDEX_ID] = layoutId;\n  data[PACKET_INDEX_WIDTH] = layout.width;\n  data[PACKET_INDEX_HEIGHT] = layout.height;\n  data[PACKET_INDEX_OPTIONS] = layout._settings;\n\n  // Worker data items.\n  var i, j, item;\n  for (i = 0, j = PACKET_HEADER_SLOTS - 1, item; i < items.length; i++) {\n    item = items[i];\n    data[++j] = item._width + item._marginLeft + item._marginRight;\n    data[++j] = item._height + item._marginTop + item._marginBottom;\n  }\n\n  this._layoutQueue.push(layoutId);\n  this._layouts[layoutId] = layout;\n  this._layoutCallbacks[layoutId] = callback;\n  this._layoutWorkerData[layoutId] = data;\n\n  this._sendToWorker();\n\n  return this.cancelLayout.bind(this, layoutId);\n};\n\n/**\n * @public\n * @param {Number} layoutId\n */\nPacker.prototype.cancelLayout = function (layoutId) {\n  var layout = this._layouts[layoutId];\n  if (!layout) return;\n\n  delete this._layouts[layoutId];\n  delete this._layoutCallbacks[layoutId];\n\n  if (this._layoutWorkerData[layoutId]) {\n    delete this._layoutWorkerData[layoutId];\n    var queueIndex = this._layoutQueue.indexOf(layoutId);\n    if (queueIndex > -1) this._layoutQueue.splice(queueIndex, 1);\n  }\n};\n\n/**\n * @public\n */\nPacker.prototype.destroy = function () {\n  // Move all currently used workers back in the workers array.\n  for (var key in this._layoutWorkers) {\n    this._workers.push(this._layoutWorkers[key]);\n  }\n\n  // Destroy all instance's workers.\n  destroyWorkerProcessors(this._workers);\n\n  // Reset data.\n  this._workers.length = 0;\n  this._layoutQueue.length = 0;\n  this._layouts = {};\n  this._layoutCallbacks = {};\n  this._layoutWorkers = {};\n  this._layoutWorkerData = {};\n};\n\nvar debounceId = 0;\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. The returned function accepts one argument which, when\n * being `true`, cancels the debounce function immediately. When the debounce\n * function is canceled it cannot be invoked again.\n *\n * @param {Function} fn\n * @param {Number} durationMs\n * @returns {Function}\n */\nfunction debounce(fn, durationMs) {\n  var id = ++debounceId;\n  var timer = 0;\n  var lastTime = 0;\n  var isCanceled = false;\n  var tick = function (time) {\n    if (isCanceled) return;\n\n    if (lastTime) timer -= time - lastTime;\n    lastTime = time;\n\n    if (timer > 0) {\n      addDebounceTick(id, tick);\n    } else {\n      timer = lastTime = 0;\n      fn();\n    }\n  };\n\n  return function (cancel) {\n    if (isCanceled) return;\n\n    if (durationMs <= 0) {\n      if (cancel !== true) fn();\n      return;\n    }\n\n    if (cancel === true) {\n      isCanceled = true;\n      timer = lastTime = 0;\n      tick = undefined;\n      cancelDebounceTick(id);\n      return;\n    }\n\n    if (timer <= 0) {\n      timer = durationMs;\n      tick(0);\n    } else {\n      timer = durationMs;\n    }\n  };\n}\n\nvar htmlCollectionType = '[object HTMLCollection]';\nvar nodeListType = '[object NodeList]';\n\n/**\n * Check if a value is a node list or a html collection.\n *\n * @param {*} val\n * @returns {Boolean}\n */\nfunction isNodeList(val) {\n  var type = Object.prototype.toString.call(val);\n  return type === htmlCollectionType || type === nodeListType;\n}\n\nvar objectType = 'object';\nvar objectToStringType = '[object Object]';\nvar toString = Object.prototype.toString;\n\n/**\n * Check if a value is a plain object.\n *\n * @param {*} val\n * @returns {Boolean}\n */\nfunction isPlainObject(val) {\n  return typeof val === objectType && toString.call(val) === objectToStringType;\n}\n\nfunction noop() {}\n\n/**\n * Converts a value to an array or clones an array.\n *\n * @param {*} val\n * @returns {Array}\n */\nfunction toArray(val) {\n  return isNodeList(val) ? Array.prototype.slice.call(val) : Array.prototype.concat(val);\n}\n\nvar NUMBER_TYPE = 'number';\nvar STRING_TYPE = 'string';\nvar INSTANT_LAYOUT = 'instant';\nvar layoutId = 0;\n\n/**\n * Creates a new Grid instance.\n *\n * @class\n * @param {(HTMLElement|String)} element\n * @param {Object} [options]\n * @param {(String|HTMLElement[]|NodeList|HTMLCollection)} [options.items=\"*\"]\n * @param {Number} [options.showDuration=300]\n * @param {String} [options.showEasing=\"ease\"]\n * @param {Object} [options.visibleStyles={opacity: \"1\", transform: \"scale(1)\"}]\n * @param {Number} [options.hideDuration=300]\n * @param {String} [options.hideEasing=\"ease\"]\n * @param {Object} [options.hiddenStyles={opacity: \"0\", transform: \"scale(0.5)\"}]\n * @param {(Function|Object)} [options.layout]\n * @param {Boolean} [options.layout.fillGaps=false]\n * @param {Boolean} [options.layout.horizontal=false]\n * @param {Boolean} [options.layout.alignRight=false]\n * @param {Boolean} [options.layout.alignBottom=false]\n * @param {Boolean} [options.layout.rounding=false]\n * @param {(Boolean|Number)} [options.layoutOnResize=150]\n * @param {Boolean} [options.layoutOnInit=true]\n * @param {Number} [options.layoutDuration=300]\n * @param {String} [options.layoutEasing=\"ease\"]\n * @param {?Object} [options.sortData=null]\n * @param {Boolean} [options.dragEnabled=false]\n * @param {?String} [options.dragHandle=null]\n * @param {?HtmlElement} [options.dragContainer=null]\n * @param {?Function} [options.dragStartPredicate]\n * @param {Number} [options.dragStartPredicate.distance=0]\n * @param {Number} [options.dragStartPredicate.delay=0]\n * @param {String} [options.dragAxis=\"xy\"]\n * @param {(Boolean|Function)} [options.dragSort=true]\n * @param {Object} [options.dragSortHeuristics]\n * @param {Number} [options.dragSortHeuristics.sortInterval=100]\n * @param {Number} [options.dragSortHeuristics.minDragDistance=10]\n * @param {Number} [options.dragSortHeuristics.minBounceBackAngle=1]\n * @param {(Function|Object)} [options.dragSortPredicate]\n * @param {Number} [options.dragSortPredicate.threshold=50]\n * @param {String} [options.dragSortPredicate.action=\"move\"]\n * @param {String} [options.dragSortPredicate.migrateAction=\"move\"]\n * @param {Object} [options.dragRelease]\n * @param {Number} [options.dragRelease.duration=300]\n * @param {String} [options.dragRelease.easing=\"ease\"]\n * @param {Boolean} [options.dragRelease.useDragContainer=true]\n * @param {Object} [options.dragCssProps]\n * @param {Object} [options.dragPlaceholder]\n * @param {Boolean} [options.dragPlaceholder.enabled=false]\n * @param {?Function} [options.dragPlaceholder.createElement=null]\n * @param {?Function} [options.dragPlaceholder.onCreate=null]\n * @param {?Function} [options.dragPlaceholder.onRemove=null]\n * @param {Object} [options.dragAutoScroll]\n * @param {(Function|Array)} [options.dragAutoScroll.targets=[]]\n * @param {?Function} [options.dragAutoScroll.handle=null]\n * @param {Number} [options.dragAutoScroll.threshold=50]\n * @param {Number} [options.dragAutoScroll.safeZone=0.2]\n * @param {(Function|Number)} [options.dragAutoScroll.speed]\n * @param {Boolean} [options.dragAutoScroll.sortDuringScroll=true]\n * @param {Boolean} [options.dragAutoScroll.smoothStop=false]\n * @param {?Function} [options.dragAutoScroll.onStart=null]\n * @param {?Function} [options.dragAutoScroll.onStop=null]\n * @param {String} [options.containerClass=\"muuri\"]\n * @param {String} [options.itemClass=\"muuri-item\"]\n * @param {String} [options.itemVisibleClass=\"muuri-item-visible\"]\n * @param {String} [options.itemHiddenClass=\"muuri-item-hidden\"]\n * @param {String} [options.itemPositioningClass=\"muuri-item-positioning\"]\n * @param {String} [options.itemDraggingClass=\"muuri-item-dragging\"]\n * @param {String} [options.itemReleasingClass=\"muuri-item-releasing\"]\n * @param {String} [options.itemPlaceholderClass=\"muuri-item-placeholder\"]\n */\nfunction Grid(element, options) {\n  // Allow passing element as selector string\n  if (typeof element === STRING_TYPE) {\n    element = document.querySelector(element);\n  }\n\n  // Throw an error if the container element is not body element or does not\n  // exist within the body element.\n  var isElementInDom = element.getRootNode\n    ? element.getRootNode({ composed: true }) === document\n    : document.body.contains(element);\n  if (!isElementInDom || element === document.documentElement) {\n    throw new Error('Container element must be an existing DOM element.');\n  }\n\n  // Create instance settings by merging the options with default options.\n  var settings = mergeSettings(Grid.defaultOptions, options);\n  settings.visibleStyles = normalizeStyles(settings.visibleStyles);\n  settings.hiddenStyles = normalizeStyles(settings.hiddenStyles);\n  if (!isFunction(settings.dragSort)) {\n    settings.dragSort = !!settings.dragSort;\n  }\n\n  this._id = createUid();\n  this._element = element;\n  this._settings = settings;\n  this._isDestroyed = false;\n  this._items = [];\n  this._layout = {\n    id: 0,\n    items: [],\n    slots: [],\n  };\n  this._isLayoutFinished = true;\n  this._nextLayoutData = null;\n  this._emitter = new Emitter();\n  this._onLayoutDataReceived = this._onLayoutDataReceived.bind(this);\n\n  // Store grid instance to the grid instances collection.\n  GRID_INSTANCES[this._id] = this;\n\n  // Add container element's class name.\n  addClass(element, settings.containerClass);\n\n  // If layoutOnResize option is a valid number sanitize it and bind the resize\n  // handler.\n  bindLayoutOnResize(this, settings.layoutOnResize);\n\n  // Add initial items.\n  this.add(getInitialGridElements(element, settings.items), { layout: false });\n\n  // Layout on init if necessary.\n  if (settings.layoutOnInit) {\n    this.layout(true);\n  }\n}\n\n/**\n * Public properties\n * *****************\n */\n\n/**\n * @public\n * @static\n * @see Item\n */\nGrid.Item = Item;\n\n/**\n * @public\n * @static\n * @see ItemLayout\n */\nGrid.ItemLayout = ItemLayout;\n\n/**\n * @public\n * @static\n * @see ItemVisibility\n */\nGrid.ItemVisibility = ItemVisibility;\n\n/**\n * @public\n * @static\n * @see ItemMigrate\n */\nGrid.ItemMigrate = ItemMigrate;\n\n/**\n * @public\n * @static\n * @see ItemDrag\n */\nGrid.ItemDrag = ItemDrag;\n\n/**\n * @public\n * @static\n * @see ItemDragRelease\n */\nGrid.ItemDragRelease = ItemDragRelease;\n\n/**\n * @public\n * @static\n * @see ItemDragPlaceholder\n */\nGrid.ItemDragPlaceholder = ItemDragPlaceholder;\n\n/**\n * @public\n * @static\n * @see Emitter\n */\nGrid.Emitter = Emitter;\n\n/**\n * @public\n * @static\n * @see Animator\n */\nGrid.Animator = Animator;\n\n/**\n * @public\n * @static\n * @see Dragger\n */\nGrid.Dragger = Dragger;\n\n/**\n * @public\n * @static\n * @see Packer\n */\nGrid.Packer = Packer;\n\n/**\n * @public\n * @static\n * @see AutoScroller\n */\nGrid.AutoScroller = AutoScroller;\n\n/**\n * The default Packer instance used by default for all layouts.\n *\n * @public\n * @static\n * @type {Packer}\n */\nGrid.defaultPacker = new Packer(2);\n\n/**\n * Default options for Grid instance.\n *\n * @public\n * @static\n * @type {Object}\n */\nGrid.defaultOptions = {\n  // Initial item elements\n  items: '*',\n\n  // Default show animation\n  showDuration: 300,\n  showEasing: 'ease',\n\n  // Default hide animation\n  hideDuration: 300,\n  hideEasing: 'ease',\n\n  // Item's visible/hidden state styles\n  visibleStyles: {\n    opacity: '1',\n    transform: 'scale(1)',\n  },\n  hiddenStyles: {\n    opacity: '0',\n    transform: 'scale(0.5)',\n  },\n\n  // Layout\n  layout: {\n    fillGaps: false,\n    horizontal: false,\n    alignRight: false,\n    alignBottom: false,\n    rounding: false,\n  },\n  layoutOnResize: 150,\n  layoutOnInit: true,\n  layoutDuration: 300,\n  layoutEasing: 'ease',\n\n  // Sorting\n  sortData: null,\n\n  // Drag & Drop\n  dragEnabled: false,\n  dragContainer: null,\n  dragHandle: null,\n  dragStartPredicate: {\n    distance: 0,\n    delay: 0,\n  },\n  dragAxis: 'xy',\n  dragSort: true,\n  dragSortHeuristics: {\n    sortInterval: 100,\n    minDragDistance: 10,\n    minBounceBackAngle: 1,\n  },\n  dragSortPredicate: {\n    threshold: 50,\n    action: ACTION_MOVE,\n    migrateAction: ACTION_MOVE,\n  },\n  dragRelease: {\n    duration: 300,\n    easing: 'ease',\n    useDragContainer: true,\n  },\n  dragCssProps: {\n    touchAction: 'none',\n    userSelect: 'none',\n    userDrag: 'none',\n    tapHighlightColor: 'rgba(0, 0, 0, 0)',\n    touchCallout: 'none',\n    contentZooming: 'none',\n  },\n  dragPlaceholder: {\n    enabled: false,\n    createElement: null,\n    onCreate: null,\n    onRemove: null,\n  },\n  dragAutoScroll: {\n    targets: [],\n    handle: null,\n    threshold: 50,\n    safeZone: 0.2,\n    speed: AutoScroller.smoothSpeed(1000, 2000, 2500),\n    sortDuringScroll: true,\n    smoothStop: false,\n    onStart: null,\n    onStop: null,\n  },\n\n  // Classnames\n  containerClass: 'muuri',\n  itemClass: 'muuri-item',\n  itemVisibleClass: 'muuri-item-shown',\n  itemHiddenClass: 'muuri-item-hidden',\n  itemPositioningClass: 'muuri-item-positioning',\n  itemDraggingClass: 'muuri-item-dragging',\n  itemReleasingClass: 'muuri-item-releasing',\n  itemPlaceholderClass: 'muuri-item-placeholder',\n};\n\n/**\n * Public prototype methods\n * ************************\n */\n\n/**\n * Bind an event listener.\n *\n * @public\n * @param {String} event\n * @param {Function} listener\n * @returns {Grid}\n */\nGrid.prototype.on = function (event, listener) {\n  this._emitter.on(event, listener);\n  return this;\n};\n\n/**\n * Unbind an event listener.\n *\n * @public\n * @param {String} event\n * @param {Function} listener\n * @returns {Grid}\n */\nGrid.prototype.off = function (event, listener) {\n  this._emitter.off(event, listener);\n  return this;\n};\n\n/**\n * Get the container element.\n *\n * @public\n * @returns {HTMLElement}\n */\nGrid.prototype.getElement = function () {\n  return this._element;\n};\n\n/**\n * Get instance's item by element or by index. Target can also be an Item\n * instance in which case the function returns the item if it exists within\n * related Grid instance. If nothing is found with the provided target, null\n * is returned.\n *\n * @private\n * @param {(HtmlElement|Number|Item)} [target]\n * @returns {?Item}\n */\nGrid.prototype.getItem = function (target) {\n  // If no target is specified or the instance is destroyed, return null.\n  if (this._isDestroyed || (!target && target !== 0)) {\n    return null;\n  }\n\n  // If target is number return the item in that index. If the number is lower\n  // than zero look for the item starting from the end of the items array. For\n  // example -1 for the last item, -2 for the second last item, etc.\n  if (typeof target === NUMBER_TYPE) {\n    return this._items[target > -1 ? target : this._items.length + target] || null;\n  }\n\n  // If the target is an instance of Item return it if it is attached to this\n  // Grid instance, otherwise return null.\n  if (target instanceof Item) {\n    return target._gridId === this._id ? target : null;\n  }\n\n  // In other cases let's assume that the target is an element, so let's try\n  // to find an item that matches the element and return it. If item is not\n  // found return null.\n  if (ITEM_ELEMENT_MAP) {\n    var item = ITEM_ELEMENT_MAP.get(target);\n    return item && item._gridId === this._id ? item : null;\n  } else {\n    for (var i = 0; i < this._items.length; i++) {\n      if (this._items[i]._element === target) {\n        return this._items[i];\n      }\n    }\n  }\n\n  return null;\n};\n\n/**\n * Get all items. Optionally you can provide specific targets (elements,\n * indices and item instances). All items that are not found are omitted from\n * the returned array.\n *\n * @public\n * @param {(HtmlElement|Number|Item|Array)} [targets]\n * @returns {Item[]}\n */\nGrid.prototype.getItems = function (targets) {\n  // Return all items immediately if no targets were provided or if the\n  // instance is destroyed.\n  if (this._isDestroyed || targets === undefined) {\n    return this._items.slice(0);\n  }\n\n  var items = [];\n  var i, item;\n\n  if (Array.isArray(targets) || isNodeList(targets)) {\n    for (i = 0; i < targets.length; i++) {\n      item = this.getItem(targets[i]);\n      if (item) items.push(item);\n    }\n  } else {\n    item = this.getItem(targets);\n    if (item) items.push(item);\n  }\n\n  return items;\n};\n\n/**\n * Update the cached dimensions of the instance's items. By default all the\n * items are refreshed, but you can also provide an array of target items as the\n * first argument if you want to refresh specific items. Note that all hidden\n * items are not refreshed by default since their \"display\" property is \"none\"\n * and their dimensions are therefore not readable from the DOM. However, if you\n * do want to force update hidden item dimensions too you can provide `true`\n * as the second argument, which makes the elements temporarily visible while\n * their dimensions are being read.\n *\n * @public\n * @param {Item[]} [items]\n * @param {Boolean} [force=false]\n * @returns {Grid}\n */\nGrid.prototype.refreshItems = function (items, force) {\n  if (this._isDestroyed) return this;\n\n  var targets = items || this._items;\n  var i, item, style, hiddenItemStyles;\n\n  if (force === true) {\n    hiddenItemStyles = [];\n    for (i = 0; i < targets.length; i++) {\n      item = targets[i];\n      if (!item.isVisible() && !item.isHiding()) {\n        style = item.getElement().style;\n        style.visibility = 'hidden';\n        style.display = '';\n        hiddenItemStyles.push(style);\n      }\n    }\n  }\n\n  for (i = 0; i < targets.length; i++) {\n    targets[i]._refreshDimensions(force);\n  }\n\n  if (force === true) {\n    for (i = 0; i < hiddenItemStyles.length; i++) {\n      style = hiddenItemStyles[i];\n      style.visibility = '';\n      style.display = 'none';\n    }\n    hiddenItemStyles.length = 0;\n  }\n\n  return this;\n};\n\n/**\n * Update the sort data of the instance's items. By default all the items are\n * refreshed, but you can also provide an array of target items if you want to\n * refresh specific items.\n *\n * @public\n * @param {Item[]} [items]\n * @returns {Grid}\n */\nGrid.prototype.refreshSortData = function (items) {\n  if (this._isDestroyed) return this;\n\n  var targets = items || this._items;\n  for (var i = 0; i < targets.length; i++) {\n    targets[i]._refreshSortData();\n  }\n\n  return this;\n};\n\n/**\n * Synchronize the item elements to match the order of the items in the DOM.\n * This comes handy if you need to keep the DOM structure matched with the\n * order of the items. Note that if an item's element is not currently a child\n * of the container element (if it is dragged for example) it is ignored and\n * left untouched.\n *\n * @public\n * @returns {Grid}\n */\nGrid.prototype.synchronize = function () {\n  if (this._isDestroyed) return this;\n\n  var items = this._items;\n  if (!items.length) return this;\n\n  var fragment;\n  var element;\n\n  for (var i = 0; i < items.length; i++) {\n    element = items[i]._element;\n    if (element.parentNode === this._element) {\n      fragment = fragment || document.createDocumentFragment();\n      fragment.appendChild(element);\n    }\n  }\n\n  if (!fragment) return this;\n\n  this._element.appendChild(fragment);\n  this._emit(EVENT_SYNCHRONIZE);\n\n  return this;\n};\n\n/**\n * Calculate and apply item positions.\n *\n * @public\n * @param {Boolean} [instant=false]\n * @param {Function} [onFinish]\n * @returns {Grid}\n */\nGrid.prototype.layout = function (instant, onFinish) {\n  if (this._isDestroyed) return this;\n\n  // Cancel unfinished layout algorithm if possible.\n  var unfinishedLayout = this._nextLayoutData;\n  if (unfinishedLayout && isFunction(unfinishedLayout.cancel)) {\n    unfinishedLayout.cancel();\n  }\n\n  // Compute layout id (let's stay in Float32 range).\n  layoutId = (layoutId % MAX_SAFE_FLOAT32_INTEGER) + 1;\n  var nextLayoutId = layoutId;\n\n  // Store data for next layout.\n  this._nextLayoutData = {\n    id: nextLayoutId,\n    instant: instant,\n    onFinish: onFinish,\n    cancel: null,\n  };\n\n  // Collect layout items (all active grid items).\n  var items = this._items;\n  var layoutItems = [];\n  for (var i = 0; i < items.length; i++) {\n    if (items[i]._isActive) layoutItems.push(items[i]);\n  }\n\n  // Compute new layout.\n  this._refreshDimensions();\n  var gridWidth = this._width - this._borderLeft - this._borderRight;\n  var gridHeight = this._height - this._borderTop - this._borderBottom;\n  var layoutSettings = this._settings.layout;\n  var cancelLayout;\n  if (isFunction(layoutSettings)) {\n    cancelLayout = layoutSettings(\n      this,\n      nextLayoutId,\n      layoutItems,\n      gridWidth,\n      gridHeight,\n      this._onLayoutDataReceived\n    );\n  } else {\n    Grid.defaultPacker.setOptions(layoutSettings);\n    cancelLayout = Grid.defaultPacker.createLayout(\n      this,\n      nextLayoutId,\n      layoutItems,\n      gridWidth,\n      gridHeight,\n      this._onLayoutDataReceived\n    );\n  }\n\n  // Store layout cancel method if available.\n  if (\n    isFunction(cancelLayout) &&\n    this._nextLayoutData &&\n    this._nextLayoutData.id === nextLayoutId\n  ) {\n    this._nextLayoutData.cancel = cancelLayout;\n  }\n\n  return this;\n};\n\n/**\n * Add new items by providing the elements you wish to add to the instance and\n * optionally provide the index where you want the items to be inserted into.\n * All elements that are not already children of the container element will be\n * automatically appended to the container element. If an element has it's CSS\n * display property set to \"none\" it will be marked as inactive during the\n * initiation process. As long as the item is inactive it will not be part of\n * the layout, but it will retain it's index. You can activate items at any\n * point with grid.show() method. This method will automatically call\n * grid.layout() if one or more of the added elements are visible. If only\n * hidden items are added no layout will be called. All the new visible items\n * are positioned without animation during their first layout.\n *\n * @public\n * @param {(HTMLElement|HTMLElement[])} elements\n * @param {Object} [options]\n * @param {Number} [options.index=-1]\n * @param {Boolean} [options.active]\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Item[]}\n */\nGrid.prototype.add = function (elements, options) {\n  if (this._isDestroyed || !elements) return [];\n\n  var newItems = toArray(elements);\n  if (!newItems.length) return newItems;\n\n  var opts = options || {};\n  var layout = opts.layout ? opts.layout : opts.layout === undefined;\n  var items = this._items;\n  var needsLayout = false;\n  var fragment;\n  var element;\n  var item;\n  var i;\n\n  // Collect all the elements that are not child of the grid element into a\n  // document fragment.\n  for (i = 0; i < newItems.length; i++) {\n    element = newItems[i];\n    if (element.parentNode !== this._element) {\n      fragment = fragment || document.createDocumentFragment();\n      fragment.appendChild(element);\n    }\n  }\n\n  // If we have a fragment, let's append it to the grid element. We could just\n  // not do this and the `new Item()` instantiation would handle this for us,\n  // but this way we can add the elements into the DOM a bit faster.\n  if (fragment) {\n    this._element.appendChild(fragment);\n  }\n\n  // Map provided elements into new grid items.\n  for (i = 0; i < newItems.length; i++) {\n    element = newItems[i];\n    item = newItems[i] = new Item(this, element, opts.active);\n\n    // If the item to be added is active, we need to do a layout. Also, we\n    // need to mark the item with the skipNextAnimation flag to make it\n    // position instantly (without animation) during the next layout. Without\n    // the hack the item would animate to it's new position from the northwest\n    // corner of the grid, which feels a bit buggy (imho).\n    if (item._isActive) {\n      needsLayout = true;\n      item._layout._skipNextAnimation = true;\n    }\n  }\n\n  // Set up the items' initial dimensions and sort data. This needs to be done\n  // in a separate loop to avoid layout thrashing.\n  for (i = 0; i < newItems.length; i++) {\n    item = newItems[i];\n    item._refreshDimensions();\n    item._refreshSortData();\n  }\n\n  // Add the new items to the items collection to correct index.\n  arrayInsert(items, newItems, opts.index);\n\n  // Emit add event.\n  if (this._hasListeners(EVENT_ADD)) {\n    this._emit(EVENT_ADD, newItems.slice(0));\n  }\n\n  // If layout is needed.\n  if (needsLayout && layout) {\n    this.layout(layout === INSTANT_LAYOUT, isFunction(layout) ? layout : undefined);\n  }\n\n  return newItems;\n};\n\n/**\n * Remove items from the instance.\n *\n * @public\n * @param {Item[]} items\n * @param {Object} [options]\n * @param {Boolean} [options.removeElements=false]\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Item[]}\n */\nGrid.prototype.remove = function (items, options) {\n  if (this._isDestroyed || !items.length) return [];\n\n  var opts = options || {};\n  var layout = opts.layout ? opts.layout : opts.layout === undefined;\n  var needsLayout = false;\n  var allItems = this.getItems();\n  var targetItems = [];\n  var indices = [];\n  var index;\n  var item;\n  var i;\n\n  // Remove the individual items.\n  for (i = 0; i < items.length; i++) {\n    item = items[i];\n    if (item._isDestroyed) continue;\n\n    index = this._items.indexOf(item);\n    if (index === -1) continue;\n\n    if (item._isActive) needsLayout = true;\n\n    targetItems.push(item);\n    indices.push(allItems.indexOf(item));\n    item._destroy(opts.removeElements);\n    this._items.splice(index, 1);\n  }\n\n  // Emit remove event.\n  if (this._hasListeners(EVENT_REMOVE)) {\n    this._emit(EVENT_REMOVE, targetItems.slice(0), indices);\n  }\n\n  // If layout is needed.\n  if (needsLayout && layout) {\n    this.layout(layout === INSTANT_LAYOUT, isFunction(layout) ? layout : undefined);\n  }\n\n  return targetItems;\n};\n\n/**\n * Show specific instance items.\n *\n * @public\n * @param {Item[]} items\n * @param {Object} [options]\n * @param {Boolean} [options.instant=false]\n * @param {Boolean} [options.syncWithLayout=true]\n * @param {Function} [options.onFinish]\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Grid}\n */\nGrid.prototype.show = function (items, options) {\n  if (!this._isDestroyed && items.length) {\n    this._setItemsVisibility(items, true, options);\n  }\n  return this;\n};\n\n/**\n * Hide specific instance items.\n *\n * @public\n * @param {Item[]} items\n * @param {Object} [options]\n * @param {Boolean} [options.instant=false]\n * @param {Boolean} [options.syncWithLayout=true]\n * @param {Function} [options.onFinish]\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Grid}\n */\nGrid.prototype.hide = function (items, options) {\n  if (!this._isDestroyed && items.length) {\n    this._setItemsVisibility(items, false, options);\n  }\n  return this;\n};\n\n/**\n * Filter items. Expects at least one argument, a predicate, which should be\n * either a function or a string. The predicate callback is executed for every\n * item in the instance. If the return value of the predicate is truthy the\n * item in question will be shown and otherwise hidden. The predicate callback\n * receives the item instance as it's argument. If the predicate is a string\n * it is considered to be a selector and it is checked against every item\n * element in the instance with the native element.matches() method. All the\n * matching items will be shown and others hidden.\n *\n * @public\n * @param {(Function|String)} predicate\n * @param {Object} [options]\n * @param {Boolean} [options.instant=false]\n * @param {Boolean} [options.syncWithLayout=true]\n * @param {FilterCallback} [options.onFinish]\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Grid}\n */\nGrid.prototype.filter = function (predicate, options) {\n  if (this._isDestroyed || !this._items.length) return this;\n\n  var itemsToShow = [];\n  var itemsToHide = [];\n  var isPredicateString = typeof predicate === STRING_TYPE;\n  var isPredicateFn = isFunction(predicate);\n  var opts = options || {};\n  var isInstant = opts.instant === true;\n  var syncWithLayout = opts.syncWithLayout;\n  var layout = opts.layout ? opts.layout : opts.layout === undefined;\n  var onFinish = isFunction(opts.onFinish) ? opts.onFinish : null;\n  var tryFinishCounter = -1;\n  var tryFinish = noop;\n  var item;\n  var i;\n\n  // If we have onFinish callback, let's create proper tryFinish callback.\n  if (onFinish) {\n    tryFinish = function () {\n      ++tryFinishCounter && onFinish(itemsToShow.slice(0), itemsToHide.slice(0));\n    };\n  }\n\n  // Check which items need to be shown and which hidden.\n  if (isPredicateFn || isPredicateString) {\n    for (i = 0; i < this._items.length; i++) {\n      item = this._items[i];\n      if (isPredicateFn ? predicate(item) : elementMatches(item._element, predicate)) {\n        itemsToShow.push(item);\n      } else {\n        itemsToHide.push(item);\n      }\n    }\n  }\n\n  // Show items that need to be shown.\n  if (itemsToShow.length) {\n    this.show(itemsToShow, {\n      instant: isInstant,\n      syncWithLayout: syncWithLayout,\n      onFinish: tryFinish,\n      layout: false,\n    });\n  } else {\n    tryFinish();\n  }\n\n  // Hide items that need to be hidden.\n  if (itemsToHide.length) {\n    this.hide(itemsToHide, {\n      instant: isInstant,\n      syncWithLayout: syncWithLayout,\n      onFinish: tryFinish,\n      layout: false,\n    });\n  } else {\n    tryFinish();\n  }\n\n  // If there are any items to filter.\n  if (itemsToShow.length || itemsToHide.length) {\n    // Emit filter event.\n    if (this._hasListeners(EVENT_FILTER)) {\n      this._emit(EVENT_FILTER, itemsToShow.slice(0), itemsToHide.slice(0));\n    }\n\n    // If layout is needed.\n    if (layout) {\n      this.layout(layout === INSTANT_LAYOUT, isFunction(layout) ? layout : undefined);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Sort items. There are three ways to sort the items. The first is simply by\n * providing a function as the comparer which works identically to native\n * array sort. Alternatively you can sort by the sort data you have provided\n * in the instance's options. Just provide the sort data key(s) as a string\n * (separated by space) and the items will be sorted based on the provided\n * sort data keys. Lastly you have the opportunity to provide a presorted\n * array of items which will be used to sync the internal items array in the\n * same order.\n *\n * @public\n * @param {(Function|String|Item[])} comparer\n * @param {Object} [options]\n * @param {Boolean} [options.descending=false]\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Grid}\n */\nGrid.prototype.sort = (function () {\n  var sortComparer;\n  var isDescending;\n  var origItems;\n  var indexMap;\n\n  function defaultComparer(a, b) {\n    var result = 0;\n    var criteriaName;\n    var criteriaOrder;\n    var valA;\n    var valB;\n\n    // Loop through the list of sort criteria.\n    for (var i = 0; i < sortComparer.length; i++) {\n      // Get the criteria name, which should match an item's sort data key.\n      criteriaName = sortComparer[i][0];\n      criteriaOrder = sortComparer[i][1];\n\n      // Get items' cached sort values for the criteria. If the item has no sort\n      // data let's update the items sort data (this is a lazy load mechanism).\n      valA = (a._sortData ? a : a._refreshSortData())._sortData[criteriaName];\n      valB = (b._sortData ? b : b._refreshSortData())._sortData[criteriaName];\n\n      // Sort the items in descending order if defined so explicitly. Otherwise\n      // sort items in ascending order.\n      if (criteriaOrder === 'desc' || (!criteriaOrder && isDescending)) {\n        result = valB < valA ? -1 : valB > valA ? 1 : 0;\n      } else {\n        result = valA < valB ? -1 : valA > valB ? 1 : 0;\n      }\n\n      // If we have -1 or 1 as the return value, let's return it immediately.\n      if (result) return result;\n    }\n\n    // If values are equal let's compare the item indices to make sure we\n    // have a stable sort. Note that this is not necessary in evergreen browsers\n    // because Array.sort() is nowadays stable. However, in order to guarantee\n    // same results in older browsers we need this.\n    if (!result) {\n      if (!indexMap) indexMap = createIndexMap(origItems);\n      result = isDescending ? compareIndexMap(indexMap, b, a) : compareIndexMap(indexMap, a, b);\n    }\n    return result;\n  }\n\n  function customComparer(a, b) {\n    var result = isDescending ? -sortComparer(a, b) : sortComparer(a, b);\n    if (!result) {\n      if (!indexMap) indexMap = createIndexMap(origItems);\n      result = isDescending ? compareIndexMap(indexMap, b, a) : compareIndexMap(indexMap, a, b);\n    }\n    return result;\n  }\n\n  return function (comparer, options) {\n    if (this._isDestroyed || this._items.length < 2) return this;\n\n    var items = this._items;\n    var opts = options || {};\n    var layout = opts.layout ? opts.layout : opts.layout === undefined;\n\n    // Setup parent scope data.\n    isDescending = !!opts.descending;\n    origItems = items.slice(0);\n    indexMap = null;\n\n    // If function is provided do a native array sort.\n    if (isFunction(comparer)) {\n      sortComparer = comparer;\n      items.sort(customComparer);\n    }\n    // Otherwise if we got a string, let's sort by the sort data as provided in\n    // the instance's options.\n    else if (typeof comparer === STRING_TYPE) {\n      sortComparer = comparer\n        .trim()\n        .split(' ')\n        .filter(function (val) {\n          return val;\n        })\n        .map(function (val) {\n          return val.split(':');\n        });\n      items.sort(defaultComparer);\n    }\n    // Otherwise if we got an array, let's assume it's a presorted array of the\n    // items and order the items based on it. Here we blindly trust that the\n    // presorted array consists of the same item instances as the current\n    // `gird._items` array.\n    else if (Array.isArray(comparer)) {\n      items.length = 0;\n      items.push.apply(items, comparer);\n    }\n    // Otherwise let's throw an error.\n    else {\n      sortComparer = isDescending = origItems = indexMap = null;\n      throw new Error('Invalid comparer argument provided.');\n    }\n\n    // Emit sort event.\n    if (this._hasListeners(EVENT_SORT)) {\n      this._emit(EVENT_SORT, items.slice(0), origItems);\n    }\n\n    // If layout is needed.\n    if (layout) {\n      this.layout(layout === INSTANT_LAYOUT, isFunction(layout) ? layout : undefined);\n    }\n\n    // Reset data (to avoid mem leaks).\n    sortComparer = isDescending = origItems = indexMap = null;\n\n    return this;\n  };\n})();\n\n/**\n * Move item to another index or in place of another item.\n *\n * @public\n * @param {(HtmlElement|Number|Item)} item\n * @param {(HtmlElement|Number|Item)} position\n * @param {Object} [options]\n * @param {String} [options.action=\"move\"]\n *   - Accepts either \"move\" or \"swap\".\n *   - \"move\" moves the item in place of the other item.\n *   - \"swap\" swaps the position of the items.\n * @param {(Boolean|Function|String)} [options.layout=true]\n * @returns {Grid}\n */\nGrid.prototype.move = function (item, position, options) {\n  if (this._isDestroyed || this._items.length < 2) return this;\n\n  var items = this._items;\n  var opts = options || {};\n  var layout = opts.layout ? opts.layout : opts.layout === undefined;\n  var isSwap = opts.action === ACTION_SWAP;\n  var action = isSwap ? ACTION_SWAP : ACTION_MOVE;\n  var fromItem = this.getItem(item);\n  var toItem = this.getItem(position);\n  var fromIndex;\n  var toIndex;\n\n  // Make sure the items exist and are not the same.\n  if (fromItem && toItem && fromItem !== toItem) {\n    // Get the indices of the items.\n    fromIndex = items.indexOf(fromItem);\n    toIndex = items.indexOf(toItem);\n\n    // Do the move/swap.\n    if (isSwap) {\n      arraySwap(items, fromIndex, toIndex);\n    } else {\n      arrayMove(items, fromIndex, toIndex);\n    }\n\n    // Emit move event.\n    if (this._hasListeners(EVENT_MOVE)) {\n      this._emit(EVENT_MOVE, {\n        item: fromItem,\n        fromIndex: fromIndex,\n        toIndex: toIndex,\n        action: action,\n      });\n    }\n\n    // If layout is needed.\n    if (layout) {\n      this.layout(layout === INSTANT_LAYOUT, isFunction(layout) ? layout : undefined);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Send item to another Grid instance.\n *\n * @public\n * @param {(HtmlElement|Number|Item)} item\n * @param {Grid} targetGrid\n * @param {(HtmlElement|Number|Item)} position\n * @param {Object} [options]\n * @param {HTMLElement} [options.appendTo=document.body]\n * @param {(Boolean|Function|String)} [options.layoutSender=true]\n * @param {(Boolean|Function|String)} [options.layoutReceiver=true]\n * @returns {Grid}\n */\nGrid.prototype.send = function (item, targetGrid, position, options) {\n  if (this._isDestroyed || targetGrid._isDestroyed || this === targetGrid) return this;\n\n  // Make sure we have a valid target item.\n  item = this.getItem(item);\n  if (!item) return this;\n\n  var opts = options || {};\n  var container = opts.appendTo || document.body;\n  var layoutSender = opts.layoutSender ? opts.layoutSender : opts.layoutSender === undefined;\n  var layoutReceiver = opts.layoutReceiver\n    ? opts.layoutReceiver\n    : opts.layoutReceiver === undefined;\n\n  // Start the migration process.\n  item._migrate.start(targetGrid, position, container);\n\n  // If migration was started successfully and the item is active, let's layout\n  // the grids.\n  if (item._migrate._isActive && item._isActive) {\n    if (layoutSender) {\n      this.layout(\n        layoutSender === INSTANT_LAYOUT,\n        isFunction(layoutSender) ? layoutSender : undefined\n      );\n    }\n    if (layoutReceiver) {\n      targetGrid.layout(\n        layoutReceiver === INSTANT_LAYOUT,\n        isFunction(layoutReceiver) ? layoutReceiver : undefined\n      );\n    }\n  }\n\n  return this;\n};\n\n/**\n * Destroy the instance.\n *\n * @public\n * @param {Boolean} [removeElements=false]\n * @returns {Grid}\n */\nGrid.prototype.destroy = function (removeElements) {\n  if (this._isDestroyed) return this;\n\n  var container = this._element;\n  var items = this._items.slice(0);\n  var layoutStyles = (this._layout && this._layout.styles) || {};\n  var i, prop;\n\n  // Unbind window resize event listener.\n  unbindLayoutOnResize(this);\n\n  // Destroy items.\n  for (i = 0; i < items.length; i++) items[i]._destroy(removeElements);\n  this._items.length = 0;\n\n  // Restore container.\n  removeClass(container, this._settings.containerClass);\n  for (prop in layoutStyles) container.style[prop] = '';\n\n  // Emit destroy event and unbind all events.\n  this._emit(EVENT_DESTROY);\n  this._emitter.destroy();\n\n  // Remove reference from the grid instances collection.\n  delete GRID_INSTANCES[this._id];\n\n  // Flag instance as destroyed.\n  this._isDestroyed = true;\n\n  return this;\n};\n\n/**\n * Private prototype methods\n * *************************\n */\n\n/**\n * Emit a grid event.\n *\n * @private\n * @param {String} event\n * @param {...*} [arg]\n */\nGrid.prototype._emit = function () {\n  if (this._isDestroyed) return;\n  this._emitter.emit.apply(this._emitter, arguments);\n};\n\n/**\n * Check if there are any events listeners for an event.\n *\n * @private\n * @param {String} event\n * @returns {Boolean}\n */\nGrid.prototype._hasListeners = function (event) {\n  if (this._isDestroyed) return false;\n  return this._emitter.countListeners(event) > 0;\n};\n\n/**\n * Update container's width, height and offsets.\n *\n * @private\n */\nGrid.prototype._updateBoundingRect = function () {\n  var element = this._element;\n  var rect = element.getBoundingClientRect();\n  this._width = rect.width;\n  this._height = rect.height;\n  this._left = rect.left;\n  this._top = rect.top;\n  this._right = rect.right;\n  this._bottom = rect.bottom;\n};\n\n/**\n * Update container's border sizes.\n *\n * @private\n * @param {Boolean} left\n * @param {Boolean} right\n * @param {Boolean} top\n * @param {Boolean} bottom\n */\nGrid.prototype._updateBorders = function (left, right, top, bottom) {\n  var element = this._element;\n  if (left) this._borderLeft = getStyleAsFloat(element, 'border-left-width');\n  if (right) this._borderRight = getStyleAsFloat(element, 'border-right-width');\n  if (top) this._borderTop = getStyleAsFloat(element, 'border-top-width');\n  if (bottom) this._borderBottom = getStyleAsFloat(element, 'border-bottom-width');\n};\n\n/**\n * Refresh all of container's internal dimensions and offsets.\n *\n * @private\n */\nGrid.prototype._refreshDimensions = function () {\n  this._updateBoundingRect();\n  this._updateBorders(1, 1, 1, 1);\n  this._boxSizing = getStyle(this._element, 'box-sizing');\n};\n\n/**\n * Calculate and apply item positions.\n *\n * @private\n * @param {Object} layout\n */\nGrid.prototype._onLayoutDataReceived = (function () {\n  var itemsToLayout = [];\n  return function (layout) {\n    if (this._isDestroyed || !this._nextLayoutData || this._nextLayoutData.id !== layout.id) return;\n\n    var grid = this;\n    var instant = this._nextLayoutData.instant;\n    var onFinish = this._nextLayoutData.onFinish;\n    var numItems = layout.items.length;\n    var counter = numItems;\n    var item;\n    var left;\n    var top;\n    var i;\n\n    // Reset next layout data.\n    this._nextLayoutData = null;\n\n    if (!this._isLayoutFinished && this._hasListeners(EVENT_LAYOUT_ABORT)) {\n      this._emit(EVENT_LAYOUT_ABORT, this._layout.items.slice(0));\n    }\n\n    // Update the layout reference.\n    this._layout = layout;\n\n    // Update the item positions and collect all items that need to be laid\n    // out. It is critical that we update the item position _before_ the\n    // layoutStart event as the new data might be needed in the callback.\n    itemsToLayout.length = 0;\n    for (i = 0; i < numItems; i++) {\n      item = layout.items[i];\n\n      // Make sure we have a matching item.\n      if (!item) {\n        --counter;\n        continue;\n      }\n\n      // Get the item's new left and top values.\n      left = layout.slots[i * 2];\n      top = layout.slots[i * 2 + 1];\n\n      // Let's skip the layout process if we can. Possibly avoids a lot of DOM\n      // operations which saves us some CPU cycles.\n      if (item._canSkipLayout(left, top)) {\n        --counter;\n        continue;\n      }\n\n      // Update the item's position.\n      item._left = left;\n      item._top = top;\n\n      // Only active non-dragged items need to be moved.\n      if (item.isActive() && !item.isDragging()) {\n        itemsToLayout.push(item);\n      }\n    }\n\n    // Set layout styles to the grid element.\n    if (layout.styles) {\n      setStyles(this._element, layout.styles);\n    }\n\n    // layoutStart event is intentionally emitted after the container element's\n    // dimensions are set, because otherwise there would be no hook for reacting\n    // to container dimension changes.\n    if (this._hasListeners(EVENT_LAYOUT_START)) {\n      this._emit(EVENT_LAYOUT_START, layout.items.slice(0), instant === true);\n    }\n\n    function tryFinish() {\n      if (--counter > 0) return;\n\n      var hasLayoutChanged = grid._layout.id !== layout.id;\n      var callback = isFunction(instant) ? instant : onFinish;\n\n      if (!hasLayoutChanged) {\n        grid._isLayoutFinished = true;\n      }\n\n      if (isFunction(callback)) {\n        callback(layout.items.slice(0), hasLayoutChanged);\n      }\n\n      if (!hasLayoutChanged && grid._hasListeners(EVENT_LAYOUT_END)) {\n        grid._emit(EVENT_LAYOUT_END, layout.items.slice(0));\n      }\n    }\n\n    if (!itemsToLayout.length) {\n      tryFinish();\n      return this;\n    }\n\n    this._isLayoutFinished = false;\n\n    for (i = 0; i < itemsToLayout.length; i++) {\n      if (this._layout.id !== layout.id) break;\n      itemsToLayout[i]._layout.start(instant === true, tryFinish);\n    }\n\n    if (this._layout.id === layout.id) {\n      itemsToLayout.length = 0;\n    }\n\n    return this;\n  };\n})();\n\n/**\n * Show or hide Grid instance's items.\n *\n * @private\n * @param {Item[]} items\n * @param {Boolean} toVisible\n * @param {Object} [options]\n * @param {Boolean} [options.instant=false]\n * @param {Boolean} [options.syncWithLayout=true]\n * @param {Function} [options.onFinish]\n * @param {(Boolean|Function|String)} [options.layout=true]\n */\nGrid.prototype._setItemsVisibility = function (items, toVisible, options) {\n  var grid = this;\n  var targetItems = items.slice(0);\n  var opts = options || {};\n  var isInstant = opts.instant === true;\n  var callback = opts.onFinish;\n  var layout = opts.layout ? opts.layout : opts.layout === undefined;\n  var counter = targetItems.length;\n  var startEvent = toVisible ? EVENT_SHOW_START : EVENT_HIDE_START;\n  var endEvent = toVisible ? EVENT_SHOW_END : EVENT_HIDE_END;\n  var method = toVisible ? 'show' : 'hide';\n  var needsLayout = false;\n  var completedItems = [];\n  var hiddenItems = [];\n  var item;\n  var i;\n\n  // If there are no items call the callback, but don't emit any events.\n  if (!counter) {\n    if (isFunction(callback)) callback(targetItems);\n    return;\n  }\n\n  // Prepare the items.\n  for (i = 0; i < targetItems.length; i++) {\n    item = targetItems[i];\n\n    // If inactive item is shown or active item is hidden we need to do\n    // layout.\n    if ((toVisible && !item._isActive) || (!toVisible && item._isActive)) {\n      needsLayout = true;\n    }\n\n    // If inactive item is shown we also need to do a little hack to make the\n    // item not animate it's next positioning (layout).\n    item._layout._skipNextAnimation = !!(toVisible && !item._isActive);\n\n    // If a hidden item is being shown we need to refresh the item's\n    // dimensions.\n    if (toVisible && item._visibility._isHidden) {\n      hiddenItems.push(item);\n    }\n\n    // Add item to layout or remove it from layout.\n    if (toVisible) {\n      item._addToLayout();\n    } else {\n      item._removeFromLayout();\n    }\n  }\n\n  // Force refresh the dimensions of all hidden items.\n  if (hiddenItems.length) {\n    this.refreshItems(hiddenItems, true);\n    hiddenItems.length = 0;\n  }\n\n  // Show the items in sync with the next layout.\n  function triggerVisibilityChange() {\n    if (needsLayout && opts.syncWithLayout !== false) {\n      grid.off(EVENT_LAYOUT_START, triggerVisibilityChange);\n    }\n\n    if (grid._hasListeners(startEvent)) {\n      grid._emit(startEvent, targetItems.slice(0));\n    }\n\n    for (i = 0; i < targetItems.length; i++) {\n      // Make sure the item is still in the original grid. There is a chance\n      // that the item starts migrating before tiggerVisibilityChange is called.\n      if (targetItems[i]._gridId !== grid._id) {\n        if (--counter < 1) {\n          if (isFunction(callback)) callback(completedItems.slice(0));\n          if (grid._hasListeners(endEvent)) grid._emit(endEvent, completedItems.slice(0));\n        }\n        continue;\n      }\n\n      targetItems[i]._visibility[method](isInstant, function (interrupted, item) {\n        // If the current item's animation was not interrupted add it to the\n        // completedItems array.\n        if (!interrupted) completedItems.push(item);\n\n        // If all items have finished their animations call the callback\n        // and emit showEnd/hideEnd event.\n        if (--counter < 1) {\n          if (isFunction(callback)) callback(completedItems.slice(0));\n          if (grid._hasListeners(endEvent)) grid._emit(endEvent, completedItems.slice(0));\n        }\n      });\n    }\n  }\n\n  // Trigger the visibility change, either async with layout or instantly.\n  if (needsLayout && opts.syncWithLayout !== false) {\n    this.on(EVENT_LAYOUT_START, triggerVisibilityChange);\n  } else {\n    triggerVisibilityChange();\n  }\n\n  // Trigger layout if needed.\n  if (needsLayout && layout) {\n    this.layout(layout === INSTANT_LAYOUT, isFunction(layout) ? layout : undefined);\n  }\n};\n\n/**\n * Private helpers\n * ***************\n */\n\n/**\n * Merge default settings with user settings. The returned object is a new\n * object with merged values. The merging is a deep merge meaning that all\n * objects and arrays within the provided settings objects will be also merged\n * so that modifying the values of the settings object will have no effect on\n * the returned object.\n *\n * @param {Object} defaultSettings\n * @param {Object} [userSettings]\n * @returns {Object} Returns a new object.\n */\nfunction mergeSettings(defaultSettings, userSettings) {\n  // Create a fresh copy of default settings.\n  var settings = mergeObjects({}, defaultSettings);\n\n  // Merge user settings to default settings.\n  if (userSettings) {\n    settings = mergeObjects(settings, userSettings);\n  }\n\n  // Handle visible/hidden styles manually so that the whole object is\n  // overridden instead of the props.\n\n  if (userSettings && userSettings.visibleStyles) {\n    settings.visibleStyles = userSettings.visibleStyles;\n  } else if (defaultSettings && defaultSettings.visibleStyles) {\n    settings.visibleStyles = defaultSettings.visibleStyles;\n  }\n\n  if (userSettings && userSettings.hiddenStyles) {\n    settings.hiddenStyles = userSettings.hiddenStyles;\n  } else if (defaultSettings && defaultSettings.hiddenStyles) {\n    settings.hiddenStyles = defaultSettings.hiddenStyles;\n  }\n\n  return settings;\n}\n\n/**\n * Merge two objects recursively (deep merge). The source object's properties\n * are merged to the target object.\n *\n * @param {Object} target\n *   - The target object.\n * @param {Object} source\n *   - The source object.\n * @returns {Object} Returns the target object.\n */\nfunction mergeObjects(target, source) {\n  var sourceKeys = Object.keys(source);\n  var length = sourceKeys.length;\n  var isSourceObject;\n  var propName;\n  var i;\n\n  for (i = 0; i < length; i++) {\n    propName = sourceKeys[i];\n    isSourceObject = isPlainObject(source[propName]);\n\n    // If target and source values are both objects, merge the objects and\n    // assign the merged value to the target property.\n    if (isPlainObject(target[propName]) && isSourceObject) {\n      target[propName] = mergeObjects(mergeObjects({}, target[propName]), source[propName]);\n      continue;\n    }\n\n    // If source's value is object and target's is not let's clone the object as\n    // the target's value.\n    if (isSourceObject) {\n      target[propName] = mergeObjects({}, source[propName]);\n      continue;\n    }\n\n    // If source's value is an array let's clone the array as the target's\n    // value.\n    if (Array.isArray(source[propName])) {\n      target[propName] = source[propName].slice(0);\n      continue;\n    }\n\n    // In all other cases let's just directly assign the source's value as the\n    // target's value.\n    target[propName] = source[propName];\n  }\n\n  return target;\n}\n\n/**\n * Collect and return initial items for grid.\n *\n * @param {HTMLElement} gridElement\n * @param {?(HTMLElement[]|NodeList|HtmlCollection|String)} elements\n * @returns {(HTMLElement[]|NodeList|HtmlCollection)}\n */\nfunction getInitialGridElements(gridElement, elements) {\n  // If we have a wildcard selector let's return all the children.\n  if (elements === '*') {\n    return gridElement.children;\n  }\n\n  // If we have some more specific selector, let's filter the elements.\n  if (typeof elements === STRING_TYPE) {\n    var result = [];\n    var children = gridElement.children;\n    for (var i = 0; i < children.length; i++) {\n      if (elementMatches(children[i], elements)) {\n        result.push(children[i]);\n      }\n    }\n    return result;\n  }\n\n  // If we have an array of elements or a node list.\n  if (Array.isArray(elements) || isNodeList(elements)) {\n    return elements;\n  }\n\n  // Otherwise just return an empty array.\n  return [];\n}\n\n/**\n * Bind grid's resize handler to window.\n *\n * @param {Grid} grid\n * @param {(Number|Boolean)} delay\n */\nfunction bindLayoutOnResize(grid, delay) {\n  if (typeof delay !== NUMBER_TYPE) {\n    delay = delay === true ? 0 : -1;\n  }\n\n  if (delay >= 0) {\n    grid._resizeHandler = debounce(function () {\n      grid.refreshItems().layout();\n    }, delay);\n\n    window.addEventListener('resize', grid._resizeHandler);\n  }\n}\n\n/**\n * Unbind grid's resize handler from window.\n *\n * @param {Grid} grid\n */\nfunction unbindLayoutOnResize(grid) {\n  if (grid._resizeHandler) {\n    grid._resizeHandler(true);\n    window.removeEventListener('resize', grid._resizeHandler);\n    grid._resizeHandler = null;\n  }\n}\n\n/**\n * Normalize style declaration object, returns a normalized (new) styles object\n * (prefixed properties and invalid properties removed).\n *\n * @param {Object} styles\n * @returns {Object}\n */\nfunction normalizeStyles(styles) {\n  var normalized = {};\n  var docElemStyle = document.documentElement.style;\n  var prop, prefixedProp;\n\n  // Normalize visible styles (prefix and remove invalid).\n  for (prop in styles) {\n    if (!styles[prop]) continue;\n    prefixedProp = getPrefixedPropName(docElemStyle, prop);\n    if (!prefixedProp) continue;\n    normalized[prefixedProp] = styles[prop];\n  }\n\n  return normalized;\n}\n\n/**\n * Create index map from items.\n *\n * @param {Item[]} items\n * @returns {Object}\n */\nfunction createIndexMap(items) {\n  var result = {};\n  for (var i = 0; i < items.length; i++) {\n    result[items[i]._id] = i;\n  }\n  return result;\n}\n\n/**\n * Sort comparer function for items' index map.\n *\n * @param {Object} indexMap\n * @param {Item} itemA\n * @param {Item} itemB\n * @returns {Number}\n */\nfunction compareIndexMap(indexMap, itemA, itemB) {\n  var indexA = indexMap[itemA._id];\n  var indexB = indexMap[itemB._id];\n  return indexA - indexB;\n}\n\nexport default Grid;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"widget\",style:(_vm.style)},[_c('div',{staticClass:\"widget-content\"},[_c('v-card',{staticClass:\"c4-card mx-auto rounded-lg elevation-3 flex-column d-flex\"},[(_vm.widget.error != null)?[_c('widget-error',{attrs:{\"widget\":_vm.widget}})]:(_vm.widget.custom_card)?[(_vm.loading)?_c('v-boilerplate',{staticClass:\"pt-12\",attrs:{\"loading\":_vm.loading,\"type\":\"avatar, article\"}}):_vm._e(),_c('v-card-text',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.loading),expression:\"!loading\"}],staticClass:\"pb-0 vue-friendly-iframe-cnt\"},[_c('vue-friendly-iframe',{attrs:{\"src\":_vm.src},on:{\"load\":_vm.onLoad}})],1)]:[_c('v-card-title',{staticClass:\"flex-column pt-10 pb-8\"},[_c('v-avatar',{staticClass:\"c4-avatar mx-auto mb-3\",attrs:{\"color\":\"accent\",\"size\":\"80\"}},[_c('v-icon',{attrs:{\"dark\":\"\",\"large\":\"\"}},[_vm._v(_vm._s(_vm.widget.icon))])],1),_c('div',{staticClass:\"c4-card--widget-title grey--text text--darken-1 mx-auto body-1\"},[_vm._v(_vm._s(_vm.widget.title)+\" \")])],1),_c('v-card-text',{staticClass:\"pb-2\"},[_c('div',{staticClass:\"subtitle-2 mb-1 text-truncate\"},[_vm._v(_vm._s(_vm.widget.subtitle))]),_c('div',{staticClass:\"body-2 font-weight-light desc\",domProps:{\"innerHTML\":_vm._s(_vm.desc)}})])],_c('v-card-actions',{attrs:{\"ripple\":\"\"}},[(_vm.widget.error == null)?_c('v-btn',{attrs:{\"color\":\"primary\",\"text\":\"\"},on:{\"click\":_vm.open}},[_vm._v(\"Open App\")]):_c('v-btn',{attrs:{\"color\":\"primary\",\"text\":\"\"},on:{\"click\":_vm.fixMissingWidget}},[_vm._v(\"Fix App\")]),_c('v-spacer'),_c('v-menu',{attrs:{\"bottom\":\"\",\"offset-y\":\"\",\"open-on-hover\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"icon\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-dots-vertical\")])],1)]}}])},[_c('v-list',{staticClass:\"c4-menu-list\"},[_c('v-list-item',{on:{\"click\":_vm.onHelpClick}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('v-icon',[_vm._v(\"mdi-help-circle\")])],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"Help\")])],1)],1),_c('v-list-item',{attrs:{\"disabled\":\"\"}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('v-icon',[_vm._v(\"mdi-share-variant\")])],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"Share\")])],1)],1),_c('v-list-item',{on:{\"click\":_vm.onRemove}},[_c('v-list-item-icon',{staticClass:\"mr-4\"},[_c('v-icon',[_vm._v(\"mdi-delete\")])],1),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(\"Remove\")])],1)],1)],1)],1)],1),_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"handle text--disabled\",attrs:{\"small\":\"\",\"icon\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-drag\")])],1)]}}])},[_c('span',[_vm._v(\"Drag & sort apps\")])])],2)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"height\":\"inherit\"}},[[_c('v-card-title',{staticClass:\"flex-column pt-10 pb-8\"},[_c('v-avatar',{staticClass:\"error darken-1 c4-avatar mx-auto mb-3 blob\",attrs:{\"size\":\"80\"}},[_c('v-icon',{attrs:{\"dark\":\"\",\"x-large\":\"\"}},[_vm._v(\"mdi-alert-circle-outline\")])],1),_c('div',{staticClass:\"c4-card--widget-title grey--text text--darken-1 mx-auto body-1 error--text\"},[_vm._v(_vm._s(_vm.widget.title)+\" \")])],1),_c('v-card-text',{staticClass:\"pb-2\"},[_c('div',{staticClass:\"subtitle-2 mb-1 text-truncate error--text\"},[_vm._v(_vm._s(_vm.widget.subtitle))]),_c('div',{staticClass:\"body-2 error--text mb-3\",domProps:{\"innerHTML\":_vm._s(_vm.widget.error)}}),_c('p',{staticClass:\"body-2 error--text\"},[_vm._v(\"Something went wrong. Try to fix the error by clicking the fix button below.\")])])]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div style=\"height: inherit;\">\n    <template>\n      <v-card-title class=\"flex-column pt-10 pb-8\">\n        <v-avatar\n          size=\"80\"\n          class=\"error darken-1 c4-avatar mx-auto mb-3 blob\"\n        >\n          <v-icon\n            dark\n            x-large\n          >mdi-alert-circle-outline</v-icon>\n        </v-avatar>\n        <div class=\"c4-card--widget-title grey--text text--darken-1 mx-auto body-1 error--text\">{{widget.title}} </div>\n\n      </v-card-title>\n      <v-card-text class=\"pb-2\">\n        <div class=\"subtitle-2 mb-1 text-truncate error--text\">{{widget.subtitle}}</div>\n        <div\n          class=\"body-2 error--text mb-3\"\n          v-html=\"widget.error\"\n        ></div>\n        <p class=\"body-2 error--text\">Something went wrong. Try to fix the error by clicking the fix button below.</p>\n      </v-card-text>\n    </template>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    widget: {\n      required: true\n    }\n  },\n  mounted () {\n  },\n  data () {\n    return {\n      loading: true\n    }\n  },\n  components: {\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.v-card__text {\n  width: inherit;\n}\n.blob {\n  box-shadow: 0 0 0 0 rgba(255, 0, 0, 1);\n  animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n  0% {\n    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7);\n  }\n\n  70% {\n    box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);\n  }\n\n  100% {\n    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WidgetError.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WidgetError.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./WidgetError.vue?vue&type=template&id=60e42f00&scoped=true&\"\nimport script from \"./WidgetError.vue?vue&type=script&lang=js&\"\nexport * from \"./WidgetError.vue?vue&type=script&lang=js&\"\nimport style0 from \"./WidgetError.vue?vue&type=style&index=0&id=60e42f00&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60e42f00\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div\n    class=\"widget\"\n    :style=\"style\"\n  >\n    <div class=\"widget-content\">\n      <!-- Safe zone, enter your custom markup -->\n      <v-card class=\"c4-card mx-auto rounded-lg elevation-3 flex-column d-flex\">\n\n        <template v-if=\"widget.error != null\">\n          <widget-error :widget=\"widget\"></widget-error>\n        </template>\n        <template v-else-if=\"widget.custom_card\">\n          <v-boilerplate\n            class=\"pt-12\"\n            v-if=\"loading\"\n            :loading=\"loading\"\n            type=\"avatar, article\"\n          ></v-boilerplate>\n          <v-card-text\n            class=\"pb-0 vue-friendly-iframe-cnt\"\n            v-show=\"!loading\"\n          >\n            <vue-friendly-iframe\n              :src=\"src\"\n              @load=\"onLoad\"\n            >\n            </vue-friendly-iframe>\n          </v-card-text>\n        </template>\n        <template v-else>\n          <v-card-title class=\"flex-column pt-10 pb-8\">\n            <v-avatar\n              color=\"accent\"\n              size=\"80\"\n              class=\"c4-avatar mx-auto mb-3\"\n            >\n              <v-icon\n                dark\n                large\n              >{{widget.icon}}</v-icon>\n            </v-avatar>\n            <div class=\"c4-card--widget-title grey--text text--darken-1 mx-auto body-1\">{{widget.title}} </div>\n\n          </v-card-title>\n          <v-card-text class=\"pb-2\">\n            <div class=\"subtitle-2 mb-1 text-truncate\">{{widget.subtitle}}</div>\n            <div\n              class=\"body-2 font-weight-light desc\"\n              v-html=\"desc\"\n            ></div>\n          </v-card-text>\n        </template>\n        <v-card-actions ripple>\n          <v-btn\n            v-if=\"widget.error == null\"\n            color=\"primary\"\n            text\n            @click=\"open\"\n          >Open App</v-btn>\n          <v-btn\n            v-else\n            color=\"primary\"\n            text\n            @click=\"fixMissingWidget\"\n          >Fix App</v-btn>\n          <v-spacer></v-spacer>\n          <v-menu\n            bottom\n            offset-y\n            open-on-hover\n          >\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-btn\n                icon\n                v-bind=\"attrs\"\n                v-on=\"on\"\n              >\n                <v-icon>mdi-dots-vertical</v-icon>\n              </v-btn>\n            </template>\n            <v-list class=\"c4-menu-list\">\n              <v-list-item @click=\"onHelpClick\">\n                <v-list-item-icon class=\"mr-4\">\n                  <v-icon>mdi-help-circle</v-icon>\n                </v-list-item-icon>\n                <v-list-item-content>\n                  <v-list-item-title>Help</v-list-item-title>\n                </v-list-item-content>\n              </v-list-item>\n              <v-list-item disabled>\n                <v-list-item-icon class=\"mr-4\">\n                  <v-icon>mdi-share-variant</v-icon>\n                </v-list-item-icon>\n                <v-list-item-content>\n                  <v-list-item-title>Share</v-list-item-title>\n                </v-list-item-content>\n              </v-list-item>\n              <v-list-item @click=\"onRemove\">\n                <v-list-item-icon class=\"mr-4\">\n                  <v-icon>mdi-delete</v-icon>\n                </v-list-item-icon>\n                <v-list-item-content>\n                  <v-list-item-title>Remove</v-list-item-title>\n                </v-list-item-content>\n              </v-list-item>\n            </v-list>\n          </v-menu>\n        </v-card-actions>\n        <v-tooltip bottom>\n          <template v-slot:activator=\"{ on, attrs }\">\n            <v-btn\n              v-bind=\"attrs\"\n              v-on=\"on\"\n              class=\"handle text--disabled\"\n              small\n              icon\n            >\n              <v-icon>mdi-drag</v-icon>\n            </v-btn>\n          </template>\n          <span>Drag &amp; sort apps</span>\n        </v-tooltip>\n      </v-card>\n      <!-- Safe zone ends -->\n    </div>\n\n  </div>\n</template>\n\n<script>\n// git import _ from 'lodash'\nimport { mapActions } from 'vuex'\n// import { config } from '@/main'\nimport { replacePort } from '@/plugins/fixme.js'\nimport WidgetError from '@/components/sub/WidgetError'\nconst baseWidth = 320\nconst baseHeight = 360\nconst margin = 15\nexport default {\n  inject: ['theme'],\n  async mounted () {\n    window.addEventListener('message', this.onMessage, false)\n  },\n  beforeDestroy () {\n    window.removeEventListener('message', this.onMessage)\n  },\n  data () {\n    return {\n      loading: true,\n      show: true\n    }\n  },\n  methods: {\n    onLoad () {\n      window.setTimeout(() => {\n        this.loading = false\n      }, 500)\n    },\n    onMessage (e) {\n      try {\n        const iframeEl = this.$el.querySelector('iframe').contentWindow\n        if (e.source === iframeEl) {\n          if (e.data.event === 'WidgetOpen') {\n            this.open({\n              payload: e.data.payload || ''\n            })\n          }\n        }\n      } catch (err) {}\n    },\n    async fixMissingWidget () {\n      await this.$store.dispatch('widgets/fixWidget', this.widget)\n    },\n\n    ...mapActions('widgets', {\n      removeFromBoard: 'removeFromBoard'\n    }),\n    onRemove () {\n      this.removeFromBoard(this.widget.rsc_id)\n    },\n    onHelpClick () {\n      const endpoint = replacePort(this.widget.endpoint[0])\n      const params = { widgetId: this.widget.rsc_id, endpoint }\n      this.$router.push({ name: 'help', params })\n    },\n    open (dto = {}) {\n      if (this.widget.target === 'blank') {\n        window.open(this.widget.enter_url || this.widget.endpoint.enter_url, '_blank')\n      } else {\n        const endpoint = replacePort(this.widget.endpoint[0])\n        const params = { widgetId: this.widget.rsc_id, endpoint, payload: dto.payload }\n        this.$router.push({ name: 'enter', params })\n      }\n    }\n  },\n  components: {\n    WidgetError,\n    VBoilerplate: {\n      functional: true,\n      render (h, { data, props, children }) {\n        return h('v-skeleton-loader', {\n          ...data,\n          props: {\n            boilerplate: true,\n            elevation: 0,\n            ...props\n          }\n        }, children)\n      }\n    }\n  },\n  props: {\n    widget: {\n      type: Object,\n      default: () => {\n        return {\n        }\n      },\n      required: false\n    },\n    showHandle: {\n      type: Boolean,\n      default: true\n    }\n  },\n  watch: {\n    async style (newValue, oldValue) {\n      try {\n        const one = Object.values(newValue).join()\n        const two = Object.values(oldValue).join()\n        if (one !== two) {\n          await this.$nextTick()\n          this.$emit('refresh')\n        }\n      } catch (err) {}\n    }\n  },\n  computed: {\n    src () {\n      try {\n        const dark = new URLSearchParams(this.$vuetify.theme.themes.dark).toString().split('&').join('xyz')\n        const light = new URLSearchParams(this.$vuetify.theme.themes.light).toString().split('&').join('xyz')\n        const endpoint = replacePort(this.widget.endpoint[0])\n        return `${endpoint}/_info/card/${this.widget.rsc_id}?dark=${this.dark}&themeDark=${dark}&themeLight=${light}`\n      } catch (err) {}\n      return 'about:blank'\n    },\n    dark () {\n      return this.$store.getters.dark\n    },\n    desc () {\n      try {\n        return this.widget.description_html.body || this.widget.description_html\n      } catch (err) {\n\n      }\n      return ''\n    },\n    h () {\n      const h = Number((this.widget.res || 11).toString().split('')[1])\n      let temp = h * baseHeight\n      if (h === 2) {\n        temp += margin * 2\n      }\n      return (temp).toString() + 'px'\n    },\n    w () {\n      const w = Number((this.widget.res || 11).toString().split('')[0])\n      let temp = w * baseWidth\n      if (w === 2) {\n        temp += margin * 2\n      }\n      return (temp).toString() + 'px'\n    },\n    style () {\n      return {\n        height: this.h,\n        width: this.w\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.desc {\n  max-height: 86px;\n  overflow-y: auto;\n}\n::v-deep .v-skeleton-loader {\n  height: 100%;\n}\n::v-deep .v-skeleton-loader__avatar {\n  width: 80px;\n  height: 80px;\n  margin-left: auto;\n  margin-right: auto;\n}\n::v-deep .v-skeleton-loader__heading {\n  margin-left: auto !important;\n  margin-right: auto !important;\n}\n.widget {\n  position: absolute;\n  margin: 15px;\n  z-index: 1;\n  color: #fff;\n  will-change: transform;\n  .v-card {\n    height: inherit;\n    .v-card__text {\n      width: inherit;\n      //display: flex !important;\n    }\n  }\n  .handle {\n    opacity: 0.75;\n    position: absolute;\n    left: 5px;\n    top: 5px;\n    /*     right: 5px;\n    bottom: 5px; */\n  }\n}\n.c4-card .v-card__actions .v-btn--icon {\n  padding: 0 0;\n}\n.widget.muuri-item-dragging {\n  z-index: 3;\n}\n.widget.muuri-item-releasing {\n  z-index: 2;\n}\n.widget.muuri-item-hidden {\n  z-index: 0;\n}\n.widget-content {\n  height: 100%;\n}\n.vue-friendly-iframe-cnt {\n  display: flex !important;\n}\n::v-deep .vue-friendly-iframe {\n  overflow: hidden;\n  iframe {\n    overflow: hidden;\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Widget.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Widget.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Widget.vue?vue&type=template&id=01f3d673&scoped=true&\"\nimport script from \"./Widget.vue?vue&type=script&lang=js&\"\nexport * from \"./Widget.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Widget.vue?vue&type=style&index=0&id=01f3d673&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"01f3d673\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"12\",\"align\":\"center\"}},[_c('v-icon',{staticClass:\"blob\",staticStyle:{\"font-size\":\"5rem\"},attrs:{\"x-large\":\"\",\"color\":\"grey\"}},[_vm._v(\" mdi-shape-square-plus \")])],1),_c('v-col',{attrs:{\"cols\":\"12\",\"align\":\"center\"}},[_c('h2',{staticClass:\"text-h4 mb-4\"},[_vm._v(\" Add your first app \")]),_c('p',{staticClass:\"text-h5\",staticStyle:{\"max-width\":\"480px\"}},[_vm._v(\" You can organize apps into boards and quickly access them in the future. \")]),_c('p',{staticClass:\"body-1\",staticStyle:{\"max-width\":\"480px\"}},[_vm._v(\" Click on the Add apps to  button to add apps to this board. \")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container fluid>\n    <v-row\n      align=\"center\"\n      justify=\"center\"\n    >\n      <v-col\n        cols=\"12\"\n        align=\"center\"\n      >\n        <v-icon\n          class=\"blob\"\n          style=\"font-size:5rem\"\n          x-large\n          color=\"grey\"\n        >\n          mdi-shape-square-plus\n        </v-icon>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        align=\"center\"\n      >\n        <h2 class=\"text-h4 mb-4\">\n          Add your first app\n        </h2>\n        <p class=\"text-h5\" style=\"max-width: 480px;\">\n          You can organize apps into boards and quickly access them in the future.\n        </p>\n        <p class=\"body-1\" style=\"max-width: 480px;\">\n          Click on the Add apps to  button to add apps to this board.\n        </p>\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n\n<script>\nexport default {\n\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.blob {\n  animation: pulse 5s infinite;\n}\n\n@keyframes pulse {\n  0% {\n    transform: scale(0.7);\n  }\n\n  62% {\n     transform: scale(1.0);\n  }\n\n  100% {\n     transform: scale(0.7);\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Empty.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Empty.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Empty.vue?vue&type=template&id=3a49a231&scoped=true&\"\nimport script from \"./Empty.vue?vue&type=script&lang=js&\"\nexport * from \"./Empty.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Empty.vue?vue&type=style&index=0&id=3a49a231&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a49a231\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"grid\">\n<!--     <pre>{{widgetsHack}}</pre> -->\n    <template v-if=\"widgets === []\">\n      <empty />\n    </template>\n    <template v-else-if=\"show\">\n      <widget\n        :class=\"{show2}\"\n        v-for=\"widget in widgets\"\n        :key=\"widget.rsc_id\"\n        xxxshow-handle=\"showHandle\"\n        :data-id=\"widget.rsc_id\"\n        :widget=\"widget\"\n        @refresh=\"refreshItems\"\n      ></widget>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport Muuri from 'muuri'\nimport Widget from '@/components/Widget'\nimport Empty from '@/components/sub/Empty'\nexport default {\n  components: {\n    Widget,\n    Empty\n  },\n  mounted () {\n    if (this.widgets != null) {\n      this.showGrid()\n    }\n  },\n  computed: {\n    ...mapGetters('widgets', [\n      'widgets'\n    ]),\n    /*     showHandle () {\n      return this.internalWidgets.length > 1\n    }, */\n    widgetsHack () {\n      return this.internalWidgets.map(val => val.rsc_id).join('_')\n    },\n    internalWidgets () {\n      return this.widgets || []\n    }\n  },\n  watch: {\n    // we watch for widget rsc ids in widgets array to REBUILD grid\n    async widgetsHack (newValue, oldValue) {\n      this.showGrid()\n    }\n  },\n\n  methods: {\n    showGrid () {\n      window.clearTimeout(this.ti3)\n      this.show2 = false\n      this.setupGrid()\n      this.ti3 = window.setTimeout(() => {\n        this.show2 = true\n      }, 100)\n    },\n    refreshItems () {\n      if (this.grid != null) { this.grid.refreshItems().layout() }\n    },\n    async setupGrid () {\n      window.clearTimeout(this.ti)\n      window.clearTimeout(this.ti2)\n      this.show = false\n      this.ti = window.setTimeout(() => {\n        this.show = true\n      }, 33)\n      this.ti2 = window.setTimeout(async () => {\n        if (this.grid != null) {\n          this.grid.destroy()\n          this.grid.off('dragInit')\n          this.grid.off('dragReleaseEnd')\n        }\n        await this.$nextTick()\n        this.grid = new Muuri('.grid', {\n          dragEnabled: true,\n          dragSortInterval: 100,\n          items: '.widget',\n          dragHandle: '.handle',\n          dragContainer: document.querySelector('#board'),\n          layout: {\n            fillGaps: true\n          }\n        })\n        let oldIndex\n        this.grid.on('dragInit', (item, event) => {\n          oldIndex = this.grid.getItems().indexOf(item)\n        })\n        this.grid.on('dragReleaseEnd', async (item) => {\n          this.grid.synchronize()\n          const newSort = this.grid.getItems().map(val => {\n            return val._element.dataset.id\n          })\n          const newIndex = this.grid.getItems().indexOf(item)\n          if (newIndex !== oldIndex) {\n            this.sortBoard({\n              oldIndex,\n              newIndex,\n              newSort\n            })\n            await this.$nextTick()\n          }\n        })\n      }, 100)\n    },\n    ...mapActions('widgets', {\n      sortBoard: 'sortBoard'\n    })\n  },\n\n  data () {\n    return {\n      grid: null,\n      show: false,\n      show2: false\n    }\n  }\n\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.grid {\n  position: relative;\n  max-width: 100%;\n  box-sizing: content-box;\n}\n.widget {\n  transition: opacity 0.25s ease-in-out;\n  opacity: 0;\n  &.show2{\n    opacity:1\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Muuri.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Muuri.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Muuri.vue?vue&type=template&id=5d87b705&scoped=true&\"\nimport script from \"./Muuri.vue?vue&type=script&lang=js&\"\nexport * from \"./Muuri.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Muuri.vue?vue&type=style&index=0&id=5d87b705&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5d87b705\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-dialog',{attrs:{\"width\":\"1150px\",\"max\":\"\",\"scrollable\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":\"primary\",\"dark\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-plus-circle\")]),_vm._v(\" Add apps to \"+_vm._s(_vm.board)+\" \")],1)]}}]),model:{value:(_vm.dialogOpen),callback:function ($$v) {_vm.dialogOpen=$$v},expression:\"dialogOpen\"}},[_c('v-card',[_c('v-card-title',[_c('v-row',{attrs:{\"no-gutters\":\"\"}},[_c('h2',{staticClass:\"text-h4\"},[_vm._v(\"Add apps to \"+_vm._s(_vm.board)+\"\")]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.dialogOpen = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1)],1),_c('v-divider',{}),_c('v-row',{staticClass:\"pl-7 pr-3 py-2\",attrs:{\"no-gutters\":\"\",\"align\":\"center\",\"justify\":\"start\"}},[_c('v-col',{attrs:{\"cols\":\"auto\"}},[_c('tag-leiste',{attrs:{\"selected\":_vm.selectedTags},on:{\"change\":_vm.onTagSelection}})],1),_c('v-col',{staticClass:\"pl-5\"},[_c('search',{attrs:{\"search-active\":true},on:{\"close-input\":_vm.onUserSearch}})],1)],1),(_vm.dialogOpen)?_c('v-card-text',{staticClass:\"pt-3 widgetsearch-card-text\"},[_c('v-row',_vm._l((_vm.widgets),function(widget,$index){return _c('small-widget',{key:$index,attrs:{\"widget\":widget},on:{\"change\":_vm.onChange}})}),1),_c('infinite-loading',{ref:\"il\",on:{\"infinite\":_vm.searchWidgets}})],1):_vm._e(),_c('v-card-actions',{staticClass:\"pt-4 pb-4 px-7\"},[_c('v-chip',{staticClass:\"ma-2\",attrs:{\"color\":\"grey\",\"xxxlabel\":\"\",\"text-color\":\"white\"}},[_c('v-avatar',{staticClass:\"grey darken-2\",attrs:{\"left\":\"\"}},[_vm._v(\" \"+_vm._s(_vm.total)+\" \")]),_vm._v(\" \"+_vm._s(_vm.total !== 1 ? 'Widgets':'Widget')+\" found \")],1),_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary\",\"text\":\"\"},on:{\"click\":function($event){_vm.deltaWidgets = [];\n          _vm.dialogOpen = false}}},[_vm._v(\" Cancel \")]),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){_vm.dialogOpen = false}}},[_vm._v(\" Save \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-row',{attrs:{\"no-gutters\":\"\",\"align\":\"center\"}},[_c('v-chip',{staticClass:\"mr-3\",attrs:{\"label\":\"\",\"color\":_vm.selected.length === 0 ? 'primary': ''},on:{\"click\":_vm.reset}},[_vm._v(\" All \")]),_c('v-chip-group',{attrs:{\"active-class\":\"primary\",\"column\":\"\",\"multiple\":\"\"},model:{value:(_vm.innerSelected1),callback:function ($$v) {_vm.innerSelected1=$$v},expression:\"innerSelected1\"}},_vm._l((_vm.defaultTags),function(tag){return _c('v-chip',{key:tag.value,attrs:{\"label\":\"\"}},[_vm._v(\" \"+_vm._s(tag.value)+\" \")])}),1),_c('v-divider',{staticClass:\"ml-1 mr-3\",staticStyle:{\"margin-top\":\"8px\",\"margin-bottom\":\"8px\"},attrs:{\"inset\":\"\",\"vertical\":\"\"}}),_c('v-menu',{attrs:{\"max-width\":\"480px\",\"offset-y\":\"\",\"close-on-content-click\":false},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-chip',_vm._g(_vm._b({staticClass:\"more-chip\",class:{'primary': _vm.innerSelected2Le > 0},attrs:{\"label\":\"\",\"ripple\":\"\"}},'v-chip',attrs,false),on),[_vm._v(\"  \")])]}}]),model:{value:(_vm.open),callback:function ($$v) {_vm.open=$$v},expression:\"open\"}},[_c('v-sheet',{attrs:{\"elevation\":\"5\"}},[_c('v-sheet',{staticClass:\"px-3 pt-3 pb-0 white\",attrs:{\"light\":\"\"}},[_c('v-row',{attrs:{\"no-gutters\":\"\",\"align\":\"center\"}},[_c('h4',[_vm._v(\" Additional Tags \")]),_c('v-spacer'),_c('v-btn',{staticClass:\"ml-2\",attrs:{\"icon\":\"\"},on:{\"click\":function($event){_vm.open = false}}},[_c('v-icon',[_vm._v(\"mdi-close\")])],1)],1)],1),_c('div',{staticClass:\"pa-4\"},[_c('v-chip-group',{attrs:{\"multiple\":\"\",\"column\":\"\",\"active-class\":\"primary\"},model:{value:(_vm.innerSelected2),callback:function ($$v) {_vm.innerSelected2=$$v},expression:\"innerSelected2\"}},_vm._l((_vm.observedTags),function(tag){return _c('v-chip',{key:tag.value,attrs:{\"label\":\"\"}},[_vm._v(\" \"+_vm._s(tag.value)+\" \")])}),1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\n  <v-row\n    no-gutters\n    align=\"center\"\n  >\n    <v-chip\n      class=\"mr-3\"\n      label\n      :color=\"selected.length === 0 ? 'primary': ''\"\n      @click=\"reset\"\n    >\n      All\n    </v-chip>\n    <v-chip-group\n      active-class=\"primary\"\n      column\n      multiple\n      v-model=\"innerSelected1\"\n    >\n      <v-chip\n        label\n        v-for=\"tag in defaultTags\"\n        :key=\"tag.value\"\n      >\n        {{ tag.value }}\n        <!--         <v-avatar\n          style=\"opacity: .5\"\n          rounded\n          v-if=\"tag.count > 1\"\n          right\n          light\n        >\n          ({{tag.count}})\n        </v-avatar> -->\n      </v-chip>\n    </v-chip-group>\n    <v-divider\n      inset\n      vertical\n      class=\"ml-1 mr-3\"\n      style=\"margin-top: 8px; margin-bottom: 8px;\"\n    ></v-divider>\n    <v-menu\n      max-width=\"480px\"\n      offset-y\n      v-model=\"open\"\n      :close-on-content-click=\"false\"\n    >\n      <template v-slot:activator=\"{ on, attrs }\">\n        <v-chip\n          label\n          class=\"more-chip\"\n          ripple\n          :class=\"{'primary': innerSelected2Le > 0}\"\n          v-bind=\"attrs\"\n          v-on=\"on\"\n        >\n          \n        </v-chip>\n      </template>\n      <v-sheet elevation=\"5\">\n        <v-sheet\n          class=\"px-3 pt-3 pb-0 white\"\n          light\n        >\n          <v-row\n            no-gutters\n            align=\"center\"\n          >\n            <h4>\n              Additional Tags\n            </h4>\n            <v-spacer></v-spacer>\n            <v-btn\n              @click=\"open = false\"\n              class=\"ml-2\"\n              icon\n            >\n              <v-icon>mdi-close</v-icon>\n            </v-btn>\n\n          </v-row>\n        </v-sheet>\n\n        <div class=\"pa-4\">\n          <v-chip-group\n            multiple\n            column\n            active-class=\"primary\"\n            v-model=\"innerSelected2\"\n          >\n            <v-chip\n              label\n              v-for=\"tag in observedTags\"\n              :key=\"tag.value\"\n            >\n              {{ tag.value }}\n              <!--         <v-avatar\n                style=\"opacity: .5\"\n                rounded\n                v-if=\"tag.count > 1\"\n                right\n                light\n              >\n                ({{tag.count}})\n              </v-avatar> -->\n            </v-chip>\n          </v-chip-group>\n        </div>\n      </v-sheet>\n    </v-menu>\n  </v-row>\n\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nexport default {\n  props: {\n    selected: {\n      type: Array,\n      required: true,\n      default: () => []\n    }\n  },\n  components: {\n\n  },\n  methods: {\n    reset () {\n      this.$emit('change', [])\n    }\n  },\n  computed: {\n    innerSelected2Le () {\n      return this.innerSelected2.length\n    },\n    innerSelected2: {\n      get () {\n        const t = this.observedTags\n        console.log(t)\n        const t2 = this.selected.filter(val => !val.default).map(val => t.indexOf(val))\n        return t2\n      },\n      set (newValue) {\n        const is = this.observedTags\n        // index to object // return-object for chip-group not working\n        const tmp2 = newValue.map(val => {\n          return is[val]\n        })\n        const tmp = this.selected.filter(val => val.default)\n        this.$emit('change', tmp.concat(tmp2))\n      }\n    },\n    innerSelected1: {\n      get () {\n        const t = this.defaultTags\n        const t2 = this.selected.filter(val => val.default).map(val => t.indexOf(val))\n        return t2\n      },\n      set (newValue) {\n        const is = this.defaultTags\n        const tmp = newValue.map(val => {\n          return is[val]\n        })\n        const tmp2 = this.selected.filter(val => !val.default)\n        this.$emit('change', tmp.concat(tmp2))\n      }\n    },\n    ...mapState('widgets', [\n      'tags'\n    ]),\n    defaultTags () {\n      return this.tags.filter(val => val.default)\n    },\n    observedTags () {\n      return this.tags.filter(val => !val.default)\n    }\n\n  },\n  data () {\n    return {\n      open: false\n    }\n  }\n\n}\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .v-divider {\n  border-width: 1px !important;\n}\n::v-deep .more-chip {\n  min-width: 60px;\n  .v-chip__content {\n    margin: -10px auto 0 auto;\n    font-size: 20px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagLeiste.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagLeiste.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TagLeiste.vue?vue&type=template&id=5ad97d15&scoped=true&\"\nimport script from \"./TagLeiste.vue?vue&type=script&lang=js&\"\nexport * from \"./TagLeiste.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TagLeiste.vue?vue&type=style&index=0&id=5ad97d15&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5ad97d15\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-text-field',{ref:\"searchRef\",staticClass:\"search mr-2\",attrs:{\"hide-details\":\"\",\"clearable\":\"\",\"outlined\":\"\",\"label\":\"Search\",\"prepend-inner-icon\":\"mdi-feature-search\",\"append-icon\":\"mdi-send\"},on:{\"keyup\":[function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submit($event)},function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }return _vm.esc($event)}],\"click:append\":_vm.submit,\"click:clear\":_vm.clear},model:{value:(_vm.text),callback:function ($$v) {_vm.text=$$v},expression:\"text\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-text-field\n    v-model=\"text\"\n    ref=\"searchRef\"\n    class=\"search mr-2\"\n    hide-details\n    clearable\n    outlined\n    label=\"Search\"\n    prepend-inner-icon=\"mdi-feature-search\"\n    append-icon=\"mdi-send\"\n    v-on:keyup.enter=\"submit\"\n    v-on:keyup.esc=\"esc\"\n    @click:append=\"submit\"\n    @click:clear=\"clear\"\n  >\n  </v-text-field>\n</template>\n\n<script>\nexport default {\n  name: 'search',\n  props: {\n    searchActive: {\n      type: Boolean\n    }\n  },\n\n  data () {\n    return {\n      text: ''\n    }\n  },\n  created () {\n    this.$nextTick(function () {\n      this.$refs.searchRef.focus()\n    })\n  },\n  methods: {\n    submit () {\n      this.$emit('close-input', { type: (this.text.length) ? 'submit' : 'clear', text: this.text })\n    },\n    clear () {\n      this.$emit('close-input', { type: 'clear' })\n    },\n    esc () {\n      this.$emit('close-input', { type: 'esc' })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n\n.v-input__icon--append{\n\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchField.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchField.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchField.vue?vue&type=template&id=619e3a78&scoped=true&\"\nimport script from \"./SearchField.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchField.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchField.vue?vue&type=style&index=0&id=619e3a78&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"619e3a78\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{staticClass:\"pa-3 mx-4 mb-8\",class:{disabled: _vm.oldAdded, 'new-added': _vm.newAdded},attrs:{\"height\":\"225\",\"width\":\"320\"},on:{\"click\":_vm.onClick}},[_c('v-card-title',{staticClass:\"px-0 pb-0 pt-1\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"start\",\"no-gutters\":\"\"}},[_c('v-avatar',{staticClass:\"c4-avatar mr-2\",attrs:{\"color\":_vm.oldAdded ? 'grey':'accent',\"size\":\"32\"}},[_c('v-icon',{staticStyle:{\"font-size\":\"22px\"},attrs:{\"dark\":\"\"}},[_vm._v(_vm._s(_vm.widget.icon))])],1),_c('v-col',[_c('div',{staticClass:\"c4-card--widget-title grey--text text--darken-1 body-2\"},[_vm._v(_vm._s(_vm.widget.title))])]),_vm._l((_vm.tags),function(tag,i){return _c('v-chip',{key:i,staticClass:\"px-1\",attrs:{\"x-small\":\"\",\"color\":_vm.oldAdded ? 'grey':'primary',\"label\":\"\",\"text-color\":\"white\"}},[_vm._v(\" \"+_vm._s(tag.toUpperCase())+\" \")])})],2)],1),_c('v-card-text',{staticClass:\"pt-9 px-0\"},[_c('div',{staticClass:\"subtitle-2 mb-12 text-truncate\"},[_vm._v(_vm._s(_vm.widget.subtitle))]),_c('div',{staticClass:\"body-2 font-weight-light\",domProps:{\"innerHTML\":_vm._s(_vm.widgetDesc)}})]),_c('v-card-actions',{staticClass:\"pa-0\"},[(_vm.addedToCurrentBoard)?[_c('v-row',{attrs:{\"no-gutters\":\"\",\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{staticClass:\"pa-0 mb-5 grey--text\"},[_vm._v(_vm._s(_vm.oldAdded ? 'Added' : 'Removed'))]),_c('v-checkbox',{staticClass:\"pa-0 ma-0\",attrs:{\"color\":\"grey\",\"value\":_vm.oldAdded},on:{\"click\":function($event){$event.preventDefault();return (function (){})($event)}}})],1)]:[_c('v-spacer'),_c('v-checkbox',{staticClass:\"pa-0 ma-0\",attrs:{\"value\":_vm.newAdded},on:{\"click\":function($event){$event.preventDefault();return (function (){})($event)}}})]],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card\n    :class=\"{disabled: oldAdded, 'new-added': newAdded}\"\n    class=\"pa-3 mx-4 mb-8\"\n    height=\"225\"\n    width=\"320\"\n    @click=\"onClick\"\n  >\n    <v-card-title class=\"px-0 pb-0 pt-1\">\n      <v-row\n        align=\"center\"\n        justify=\"start\"\n        no-gutters\n      >\n        <v-avatar\n          :color=\"oldAdded ? 'grey':'accent'\"\n          size=\"32\"\n          class=\"c4-avatar mr-2\"\n        >\n          <v-icon\n            style=\"font-size: 22px;\"\n            dark\n          >{{widget.icon}}</v-icon>\n        </v-avatar>\n        <v-col>\n          <div class=\"c4-card--widget-title grey--text text--darken-1 body-2\">{{widget.title}}</div>\n        </v-col>\n        <v-chip\n          x-small\n          v-for=\"(tag, i) in tags\"\n          :key=\"i\"\n          class=\"px-1\"\n          :color=\"oldAdded ? 'grey':'primary'\"\n          label\n          text-color=\"white\"\n        >\n          {{tag.toUpperCase()}}\n        </v-chip>\n      </v-row>\n    </v-card-title>\n    <v-card-text class=\"pt-9 px-0\">\n      <div class=\"subtitle-2 mb-12 text-truncate\">{{widget.subtitle}}</div>\n      <div\n        class=\"body-2 font-weight-light\"\n        v-html=\"widgetDesc\"\n      ></div>\n    </v-card-text>\n\n    <v-card-actions class=\"pa-0\">\n      <template v-if=\"addedToCurrentBoard\">\n        <v-row\n          no-gutters\n          align=\"center\"\n          justify=\"center\"\n        >\n          <v-col class=\"pa-0 mb-5 grey--text\">{{oldAdded ? 'Added' : 'Removed'}}</v-col>\n          <v-checkbox\n            class=\"pa-0 ma-0\"\n            color=\"grey\"\n            :value=\"oldAdded\"\n            @click.prevent=\"()=>{}\"\n          ></v-checkbox>\n        </v-row>\n      </template>\n      <template v-else>\n        <v-spacer></v-spacer>\n        <v-checkbox\n          class=\"pa-0 ma-0\"\n          @click.prevent=\"()=>{}\"\n          :value=\"newAdded\"\n        ></v-checkbox>\n      </template>\n    </v-card-actions>\n\n  </v-card>\n</template>\n\n<script>\nimport _ from 'lodash'\n// mapActions, mapGetters\nimport { mapState } from 'vuex'\n\nexport default {\n  methods: {\n    async onClick () {\n      if (this.addedToCurrentBoard) {\n        this.oldAdded = !this.oldAdded\n        await this.$nextTick()\n        this.$emit('change', {\n          widget: _.cloneDeep(this.widget),\n          added: this.oldAdded,\n          isNew: false\n        })\n      } else {\n        this.newAdded = !this.newAdded\n        this.onNewAddedChange()\n      }\n    },\n    async onNewAddedChange ($event) {\n      await this.$nextTick()\n      this.$emit('change', {\n        widget: _.cloneDeep(this.widget),\n        added: this.newAdded,\n        isNew: true\n      })\n    }\n  },\n  data () {\n    return {\n      newAdded: false,\n      oldAdded: false\n    }\n  },\n  computed: {\n    tags () {\n      return this.widget.tag.filter(val => {\n        return val === 'new'\n      })\n    },\n    ...mapState('widgets', [\n      'board', 'widgets'\n    ]),\n    addedToCurrentBoard: {\n      get () {\n        const added = this.widgets.find(val => {\n          // console.log(val.rsc_id, this.widget.rsc_id)\n          return val.rsc_id === this.widget.rsc_id\n        })\n        return added != null\n      },\n      set (newValue) {\n        console.log('newCheck', newValue)\n      }\n    },\n    widgetDesc () {\n      /*       if ((this.widget.description || []).length > 135) {\n        return this.widget.description.substring(0, 135) + ''\n      } */\n      return this.widget.description_html.body || this.widget.description\n    }\n  },\n  mounted () {\n    this.oldAdded = this.addedToCurrentBoard\n  },\n  props: {\n    widget: {\n      type: Object,\n      required: true,\n      default: () => {\n        return {\n          rsc_id: -1\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .v-card__text {\n  height: calc(100% - 60px);\n}\n.v-card {\n  border: 2px solid transparent;\n  &.disabled {\n    background: #f0f0f0;\n  }\n  &.new-added {\n    border: 2px solid var(--v-primary-base);\n  }\n}\n.theme--dark .v-card {\n  &.disabled {\n    background: #333;\n  }\n  &.new-added {\n    border: 2px solid var(--v-primary-base);\n  }\n}\n::v-deep .v-chip.v-size--x-small {\n  letter-spacing: -0.005rem;\n}\n.theme--light.v-card > .v-card__text {\n  color: rgba(0, 0, 0, 0.87);\n}\n.c4-card--widget-title {\n  width: 99%;\n  -webkit-hyphens: auto;\n  hyphens: auto;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallWidget.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallWidget.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SmallWidget.vue?vue&type=template&id=1c5dcfc5&scoped=true&\"\nimport script from \"./SmallWidget.vue?vue&type=script&lang=js&\"\nexport * from \"./SmallWidget.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SmallWidget.vue?vue&type=style&index=0&id=1c5dcfc5&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1c5dcfc5\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <v-dialog\n      v-model=\"dialogOpen\"\n      width=\"1150px\"\n      max\n      scrollable\n    >\n      <template v-slot:activator=\"{ on, attrs }\">\n        <v-btn\n          color=\"primary\"\n          dark\n          v-bind=\"attrs\"\n          v-on=\"on\"\n        >\n          <v-icon left>mdi-plus-circle</v-icon>\n          Add apps to {{board}}\n        </v-btn>\n      </template>\n\n      <v-card>\n        <v-card-title>\n          <!-- start -->\n          <v-row no-gutters>\n            <h2 class=\"text-h4\">Add apps to {{board}}</h2>\n            <v-spacer></v-spacer>\n            <v-btn\n              icon\n              @click=\"dialogOpen = false\"\n            >\n              <v-icon>mdi-close</v-icon>\n            </v-btn>\n          </v-row>\n          <!-- end -->\n        </v-card-title>\n        <v-divider class=\"\"></v-divider>\n        <v-row\n          no-gutters\n          align=\"center\" justify=\"start\"\n          class=\"pl-7 pr-3 py-2\"\n        >\n          <v-col cols=\"auto\">\n          <tag-leiste\n            :selected=\"selectedTags\"\n            @change=\"onTagSelection\"\n          ></tag-leiste>\n          </v-col>\n          <v-col  class=\"pl-5\">\n            <search\n              :search-active=\"true\"\n              @close-input=\"onUserSearch\"\n            ></search>\n          </v-col>\n\n        </v-row>\n\n        <v-card-text\n          class=\"pt-3 widgetsearch-card-text\"\n          v-if=\"dialogOpen\"\n        >\n          <v-row>\n            <small-widget\n              v-for=\"(widget, $index) in widgets\"\n              :key=\"$index\"\n              :widget=\"widget\"\n              @change=\"onChange\"\n            ></small-widget>\n          </v-row>\n          <infinite-loading\n            ref=\"il\"\n            @infinite=\"searchWidgets\"\n          />\n        </v-card-text>\n\n        <v-card-actions class=\"pt-4 pb-4 px-7\">\n          <v-chip\n            class=\"ma-2\"\n            color=\"grey\"\n            xxxlabel\n            text-color=\"white\"\n          >\n            <v-avatar\n              left\n              class=\"grey darken-2\"\n            >\n              {{total}}\n            </v-avatar>\n            {{total !== 1 ? 'Widgets':'Widget'}} found\n          </v-chip>\n          <v-spacer></v-spacer>\n          <v-btn\n            color=\"primary\"\n            text\n            @click=\"deltaWidgets = [];\n            dialogOpen = false\"\n          >\n            Cancel\n          </v-btn>\n          <v-btn\n            color=\"primary\"\n            @click=\"dialogOpen = false\"\n          >\n            Save\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\nimport api from '@/store/api.js'\nimport TagLeiste from '@/components/sub/TagLeiste'\nimport SearchField from '@/components/sub/SearchField'\nimport SmallWidget from '@/components/sub/SmallWidget'\nimport InfiniteLoading from 'vue-infinite-loading'\nimport { mapState, mapActions } from 'vuex'\nimport _ from 'lodash'\n\nconst defParams = {\n  search: '',\n  page: 0,\n  tags: [],\n  per_page: 6\n}\nexport default {\n  components: {\n    TagLeiste,\n    search: SearchField,\n    InfiniteLoading,\n    SmallWidget\n\n  },\n  computed: {\n    ...mapState('widgets', [\n      'board', 'tags'\n    ])\n  },\n  data () {\n    const params = _.cloneDeep(defParams)\n    return {\n      deltaWidgets: [],\n      selectedTags: [],\n      dialogOpen: false,\n      total: 0,\n      params,\n      widgets: []\n    }\n  },\n  methods: {\n    onTagSelection ($event) {\n      this.selectedTags = $event\n      this.onUserSearch()\n    },\n    async onUserSearch (val) {\n      const search = val ? val.text : this.params.search\n      console.log(search)\n      this.params = Object.assign(_.cloneDeep(defParams), { search, tags: this.selectedTags })\n      this.widgets = []\n      this.deltaWidgets = []\n      await this.$nextTick()\n      this.$refs.il.stateChanger.reset()\n    },\n    async searchWidgets ($state = {\n      loaded: () => {},\n      complete: () => {}\n    }) {\n      try {\n        const ret = await api.searchWidgets(this.params)\n        this.total = ret.total_count\n        if (ret.data.length) {\n          this.params.page += 1\n          this.widgets.push(...ret.data)\n          $state.loaded()\n        } else {\n          $state.complete()\n        }\n      } catch (err) {\n        console.log(err)\n        $state.error()\n      }\n    },\n    onChange (payload) {\n      const w = payload.widget\n      const added = payload.added\n      if (payload.isNew === false) {\n        // already in the board\n        // we listen to changes  - if user wants to remove or add\n        // added may be true|false\n        this.deltaWidgets = this.deltaWidgets.filter(val => val.rsc_id === w.rsc_id)\n        if (added === false) {\n          this.deltaWidgets.push(w)\n        }\n      } else {\n        if (added === true) {\n          this.deltaWidgets.push(w)\n        } else {\n          this.deltaWidgets = this.deltaWidgets.filter(val => val.rsc_id === w.rsc_id)\n        }\n      }\n    },\n    async updateBoard () {\n      if (this.deltaWidgets.length) {\n        await this.$store.dispatch('widgets/updateBoard', this.deltaWidgets)\n        this.deltaWidgets = []\n      }\n    },\n    onDialogOpen () {\n      // this.searchWidgets()\n    },\n\n    ...mapActions('widgets', {\n      fetchTags: 'fetchTags'\n    })\n  },\n  mounted () {\n    // this.searchWidgets()\n  },\n  watch: {\n    dialogOpen (newValue, oldValue) {\n      if (newValue === false) {\n        this.updateBoard()\n      } else {\n        if (this.tags.length === 0) {\n          this.fetchTags()\n        }\n      }\n    }\n  }\n\n}\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .widgetsearch-card-text.v-card__text {\n  height: 520px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.15);\n  border-top: 1px solid rgba(0, 0, 0, 0.15);\n}\n.theme--light ::v-deep .widgetsearch-card-text.v-card__text {\n  background-color: #fcfcfd;\n}\n.theme--dark ::v-deep .widgetsearch-card-text.v-card__text {\n  background-color: lighten(#333, 3);\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WidgetSearch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WidgetSearch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./WidgetSearch.vue?vue&type=template&id=71cfad90&scoped=true&\"\nimport script from \"./WidgetSearch.vue?vue&type=script&lang=js&\"\nexport * from \"./WidgetSearch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./WidgetSearch.vue?vue&type=style&index=0&id=71cfad90&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"71cfad90\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <v-container\n    id=\"board\"\n    fluid\n    class=\"pa-0\"\n  >\n    <v-row\n      no-gutters\n      align=\"center\"\n    >\n      <h1 class=\"text-h2 mb-4 ml-3\">{{board}}</h1>\n      <v-spacer></v-spacer>\n      <widget-search></widget-search>\n    </v-row>\n    <v-row\n      no-gutters\n      align=\"center\"\n    >\n <!--    <avatar /> -->\n    </v-row>\n    <Muuri></Muuri>\n  </v-container>\n</template>\n\n<script>\n\nimport { mapState, mapActions } from 'vuex'\nimport Muuri from '@/components/Muuri.vue'\nimport WidgetSearch from '@/components/WidgetSearch.vue'\n/* import Avatar from '@/components/sub/Avatar.vue' */\nimport store from '@/store'\n// import api from '@/store/api'\nexport default {\n  async beforeRouteEnter (to, from, next) {\n    await store.dispatch('widgets/initApp')\n    next(vm => {})\n  },\n  name: 'Home',\n  computed: {\n    ...mapState('widgets', [\n      'board'\n    ])\n  },\n  async beforeRouteLeave (to, from, next) {\n    // this.clearWidgets()\n    next()\n  },\n  methods: {\n    ...mapActions('widgets', {\n      clearWidgets: 'clearWidgets'\n    })\n  },\n  data () {\n    return {\n    }\n  },\n  components: {\n    Muuri,\n    WidgetSearch\n    // Avatar\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  max-width: 1074px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=e493482e&scoped=true&\"\nimport script from \"./Home.vue?vue&type=script&lang=js&\"\nexport * from \"./Home.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=e493482e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e493482e\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Widget.vue?vue&type=style&index=0&id=01f3d673&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TagLeiste.vue?vue&type=style&index=0&id=5ad97d15&lang=scss&scoped=true&\""],"sourceRoot":""}